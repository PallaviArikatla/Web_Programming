self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarCard~CalendarPeek~CalendarReadingPaneStore~RelatedContentInsightsOpx.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[126],{1493:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return m})),n.d(t,"k",(function(){return p}));var r=n(1950),i=n(1884);function c(e){return Object(i.b)().meetingIdToInsightsMap.get(e)}function a(e){var t=c(e);return t?t.files.filter((function(e){return!e.isMeetingAttachment})):[]}function u(e){var t=c(e);return t?t.emails.filter((function(e){return!e.isMeetingAttachment})):[]}function o(e){return a(e).length+u(e).length}function l(e){var t=c(e);return t?t.files.filter((function(e){return e.isMeetingAttachment})):[]}function s(e){var t=c(e);return t?t.emails.filter((function(e){return e.isMeetingAttachment})):[]}function d(e){var t=c(e);return t&&0!==t.files.length?t.files:[]}function f(e){var t=c(e);return t&&0!==t.emails.length?t.emails:[]}function g(e){return a(e).filter((function(e){return 1===e.relevanceRelationship})).length}function h(e){return u(e).filter((function(e){return 1===e.relevanceRelationship})).length}function b(e){return Object(r.a)(e)&&d(e).length>0}function m(e){return Object(r.a)(e)&&d(e).length+f(e).length>0}function p(e){return Object(r.a)(e)&&d(e).length>0}},1697:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1493);function i(e){var t=Object(r.g)(e);return t?t.traceId:null}},1832:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(233);function i(e){switch(e){case 1:return"ReadingPane";case 2:return"ItemPeek";case 3:return"PrefetchOnCalendarSelected";case 4:return"AgendaView";case 5:return"Reminder";case 6:return"Deeplink";case 7:return"PrefetchOnAgendaView";case 8:return"TimePanelEventDetails";case 9:return"TabbedDetailsForm";case 10:return"UpNext";case 11:return"CalendarCard";default:return Object(r.a)(e)}}},1873:function(e,t,n){"use strict";var r=n(69),i=n(1832),c=n(1883),a=(n(1884),n(1950)),u=n(1493),o=n(1697),l=n(1),s=n(47);function d(e){var t=Object(u.g)(e);return t?t.dataFetchSource:null}var f=n(2612);var g=n(269),h=Object(s.a)((function(e){var t=e.eventId,n=e.source,r=Object(o.a)(t),c=l.useRef(r),a=l.useRef(new g.a("RelatedContentFilesAndEmailsRenderingLatency",{isCore:!0,isCosmosDatapoint:!0}));l.useEffect((function(){return O.importAndExecute(a.current,t),function(){a.current&&a.current.invalidate()}}),[]);var s=function(){(function(e,t,n){if(!e)return!1;var r=Object(o.a)(t);if(!r)return!1;var c=Object(u.i)(t).length,a=Object(u.h)(t).length;return e.addCustomData({filesCount:c,emailsCount:a,dataFetchSource:d(t),isOrganizer:Object(f.a)(t),traceId:r,explicitFilesCount:Object(u.e)(t),explicitEmailsCount:Object(u.d)(t),fileAttachmentsCount:Object(u.f)(t).length,entrySource:Object(i.a)(n)}),e.end(),v.importAndExecute(t,n),!0})(a.current,t,n)&&(a.current=null)};return l.useEffect((function(){r&&(c.current&&r!=c.current?(a.current&&a.current.invalidate(),a.current=new g.a("RelatedContentFilesAndEmailsRenderingLatency",{isCore:!0,isCosmosDatapoint:!0}),s()):s(),c.current=r)}),[r]),null}));n.d(t,"t",(function(){return m})),n.d(t,"y",(function(){return p})),n.d(t,"x",(function(){return j})),n.d(t,"w",(function(){return v})),n.d(t,"v",(function(){return O})),n.d(t,"u",(function(){return x})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return i.a})),n.d(t,"a",(function(){return c.a})),n.d(t,"r",(function(){return a.b})),n.d(t,"q",(function(){return a.a})),n.d(t,"s",(function(){return a.c})),n.d(t,"l",(function(){return u.i})),n.d(t,"k",(function(){return u.h})),n.d(t,"m",(function(){return u.j})),n.d(t,"i",(function(){return u.f})),n.d(t,"h",(function(){return u.c})),n.d(t,"g",(function(){return u.b})),n.d(t,"f",(function(){return u.a})),n.d(t,"o",(function(){return u.l})),n.d(t,"p",(function(){return u.m})),n.d(t,"n",(function(){return u.k})),n.d(t,"j",(function(){return o.a})),n.d(t,"d",(function(){return h}));var b=new r.c((function(){return Promise.all([n.e(1),n.e(29),n.e(168),n.e(244),n.e(775)]).then(n.bind(null,15990))})),m=new r.a(b,(function(e){return e.fetchMeetingInsights})),p=new r.a(b,(function(e){return e.openFileInsight})),j=new r.a(b,(function(e){return e.openEmailInsight})),v=new r.a(b,(function(e){return e.logInsightsRenderAndLayout})),O=new r.a(b,(function(e){return e.logInsightsCacheHitMissRate})),x=(new r.a(b,(function(e){return e.logFileInsightClicked})),new r.a(b,(function(e){return e.logEmailInsightClicked})),new r.a(b,(function(e){return e.logInsightSummaryClicked}))),S=Object(r.d)(b,(function(e){return e.InsightDocList})),I=Object(r.d)(b,(function(e){return e.InsightDocSummary}))},1883:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(725),i=40,c=new r.a(i);t.b=c},1884:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(1883),i=n(3),c={meetingIdToInsightsMap:new(n(18).ObservableMap)({}),pendingServiceQueue:[]};r.b.initialize(c.meetingIdToInsightsMap);var a=Object(i.createStore)("meetingInsightsStore",c);t.a=a()},1950:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return s}));var r=n(179),i=n(1192),c=n(1229),a=n(98),u=n(29);function o(){return Object(u.a)().SessionSettings.IsSubstrateSearchServiceAvailable&&!Object(a.s)()}function l(e){if(!o())return!1;var t=Object(c.k)(e);if(!t)return!1;var n=!!t.IsMeeting,a=t.ParentFolderId.Id,u=Object(r.o)(a);return u?n&&!u.IsGroupMailboxCalendar&&!Object(i.C)(t):n}function s(e){return 1==e&&o()}},2461:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,i=n(9),c=n(98),a=n(233);function u(e,t,n){if(void 0===n&&(n=Object(i.Pb)()),Object(i.Ib)(e,n))return-1===Object(i.p)(t,n)?r.EarlierToday:1===Object(i.p)(e,n)?r.LaterToday:-1===Object(i.p)(e,n)&&1===Object(i.p)(t,n)?r.Now:(Object(a.a)(e),-2);if(Object(i.Lb)(e,n,Object(c.n)().WeekStartDay)){var u=Object(i.Wb)(e),o=Object(i.Wb)(Object(i.Qb)(e.tz,n)),l=Object(i.u)(u,o);return l<-1?r.SameWeekBeforeYesterday:-1===l?r.Yesterday:1===l?r.Tomorrow:l>1?r.SameWeekAfterTomorrow:(Object(a.a)(l),-1)}var s=Object(i.ac)(e,Object(c.n)().WeekStartDay),d=Object(i.ac)(Object(i.Qb)(e.tz,n),Object(c.n)().WeekStartDay),f=Object(i.z)(s,d);return f<-1?r.BeforeLastWeek:-1===f?r.LastWeek:1===f?r.NextWeek:f>1?r.AfterNextWeek:(Object(a.a)(f),-1)}!function(e){e[e.BeforeLastWeek=0]="BeforeLastWeek",e[e.LastWeek=1]="LastWeek",e[e.SameWeekBeforeYesterday=2]="SameWeekBeforeYesterday",e[e.Yesterday=3]="Yesterday",e[e.Now=4]="Now",e[e.Tomorrow=5]="Tomorrow",e[e.SameWeekAfterTomorrow=6]="SameWeekAfterTomorrow",e[e.NextWeek=7]="NextWeek",e[e.AfterNextWeek=8]="AfterNextWeek",e[e.EarlierToday=9]="EarlierToday",e[e.LaterToday=11]="LaterToday"}(r||(r={}))},2612:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var r=n(1229),i=n(1493),c=n(2461);function a(e){var t=Object(r.k)(e);return!!t&&t.IsOrganizer}function u(e){var t=Object(r.k)(e);return t?Object(c.a)(t.Start,t.End):-1}function o(e,t){for(var n=Object(i.i)(e),r=0;r<n.length;r++)if(n[r].referenceId===t)return r;return-1}function l(e,t){for(var n=Object(i.h)(e),r=0;r<n.length;r++)if(n[r].referenceId===t)return r;return-1}},3898:function(e,t,n){"use strict";var r=n(69),i=n(5228),c=n(319),a=n(47),u=n(11),o=n(1666),l=n(1),s=n(6119),d={base:n(6120),desktop:n(6121)},f=Object(a.a)((function(e){var t=Object(o.a)(d).getClass;return l.createElement(l.Fragment,null,!e.hideHeader&&l.createElement("div",{className:t("headerRow")},l.createElement("div",{className:t("insightsIconContainer")},l.createElement(c.a,{iconName:"Insights",className:t("insightsIcon"),style:{color:e.color}})),l.createElement("div",{className:t("relatedContentHeaderText"),style:{color:e.color}},Object(u.b)(s.a))),l.createElement("p",{className:t("relatedContentHeaderSubText")},Object(u.b)(s.b)))})),g=n(649),h=n(181),b=n(57),m=n(312),p=n(156),j=n(228),v=n(1873),O={base:n(6120),desktop:n(6121)},x=n(486),S=Object(a.a)((function(e){var t=e.meetingId,n=e.insightsEntrySource,r=e.colorScheme,i=e.readingPaneEntrySource,c=e.className,a=e.hideInsightsHeader,d=Object(o.a)(O).getClass,S=l.useRef(),I=Object(v.j)(t);l.useEffect((function(){var e=k()+w()>0;Object(p.d)()&&e&&S.current&&Object(p.b)().onMeetingInsightsContainerHeightUpdated(S.current.getBoundingClientRect().height)}),[I]);var k=function(){return Object(v.l)(t).length},w=function(){return Object(v.k)(t).length},y=k(),C=w(),R=y>0||C>0,T=Object(m.k)(Object(j.i)().neutralLighterAlt,r,r.calDarkAlt),A=l.useRef(),L=l.useCallback((function(e){var t;switch(e.keyCode){case b.a.escape:null===(t=A.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault()}}),[]),N=y+C<=1?l.Fragment:g.a;return l.createElement(l.Fragment,null,l.createElement(v.d,{eventId:t,source:n}),l.createElement("div",{className:R?x(d("insightsContainer"),c):"",ref:function(e){S.current=e},role:"region","aria-label":Object(u.b)(s.b)},R&&l.createElement(f,{color:T,hideHeader:a}),l.createElement("div",{className:d("insightsContent"),ref:A,tabIndex:-1,onKeyDown:Object(p.d)()&&L},l.createElement(N,{isCircularNavigation:Object(p.d)(),handleTabKey:h.b.all},y>0&&l.createElement(_,{color:T,colorScheme:r,insightsEntrySource:n,meetingId:t,readingPaneEntrySource:i}),C>0&&l.createElement(E,{adjustTopMargin:y>0,color:T,colorScheme:r,insightsEntrySource:n,meetingId:t,readingPaneEntrySource:i})))))}));function I(e){var t=Object(v.l)(e),n=Object(v.k)(e);return t.length+n.length>0}n.d(t,"h",(function(){return w})),n.d(t,"g",(function(){return y})),n.d(t,"i",(function(){return C})),n.d(t,"c",(function(){return E})),n.d(t,"d",(function(){return _})),n.d(t,"a",(function(){return R})),n.d(t,"f",(function(){return i.a})),n.d(t,"b",(function(){return S})),n.d(t,"e",(function(){return I}));var k=new r.c((function(){return Promise.all([n.e(1),n.e(11),n.e(15),n.e(29),n.e(168),n.e(655)]).then(n.bind(null,16353))})),w=new r.a(k,(function(e){return e.setHasScrolledInDetailsForm})),y=new r.a(k,(function(e){return e.resetRelatedContentViewState})),C=new r.a(k,(function(e){return e.tryFetchRelatedContentInsights})),E=Object(r.d)(k,(function(e){return e.RelatedEmailsWell})),_=Object(r.d)(k,(function(e){return e.RelatedFilesWell})),R=Object(r.d)(k,(function(e){return e.MeetingInsightsButton}))},5228:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("relatedContentStore",{hasScrolledInDetailsForm:!1});i()},6119:function(e){e.exports=JSON.parse('{"a":"KAa","b":"LAa"}')},6120:function(e,t,n){var r=n(7975),i=n(130);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)i.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)},6121:function(e,t,n){var r=n(7976),i=n(130);"string"==typeof r&&(r=[[e.i,r]]);for(var c=0;c<r.length;c++)i.loadStyles(r[c][1],!1);r.locals&&(e.exports=r.locals)},7975:function(e,t,n){(t=e.exports=n(129)(!1)).push([e.i,'html[dir] ._1SF9qXLy2s3Ji75K89nUPa{border-radius:2px;margin:20px 0 24px 0}html[dir=ltr] ._1SF9qXLy2s3Ji75K89nUPa,html[dir=rtl] ._1SF9qXLy2s3Ji75K89nUPa{padding:19px 0 28px 0}html[dir=ltr] ._2g7s6JwY6AIPAVo9vNiv8k{padding-left:60px}html[dir=rtl] ._2g7s6JwY6AIPAVo9vNiv8k{padding-right:60px}._3VrzUzj4kEp7cooLu3qn30{color:"[theme:themeDarkAlt, default:#005A9E]"}._2UH1ZBkEL0WgTbJveQ-nPH{color:"[theme:neutralSecondary, default:#666666]"}._2UkQUnUHv-expqoTNGcOWN{font-size:21px;font-weight:100;color:"[theme:themeDarkAlt, default:#005A9E]";font-weight:600}._3ahRzlDxJG-uPxz7wjRx1b{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir=ltr] ._3ahRzlDxJG-uPxz7wjRx1b{margin:0 0 16px 60px}html[dir=rtl] ._3ahRzlDxJG-uPxz7wjRx1b{margin:0 60px 16px 0}._3L97dFeEsl0O_hhSuv5TNx{position:relative;line-height:42px}._3L97dFeEsl0O_hhSuv5TNx,.B1phlXIYmhScUSDRrMYQm{display:-webkit-box;display:-ms-flexbox;display:flex}.B1phlXIYmhScUSDRrMYQm{width:60px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-ms-flex-negative:0;flex-shrink:0}._3F0_t8g3aT4pK8ZYCv5F_v{font-size:28px;font-weight:100}html[dir=ltr] ._3F0_t8g3aT4pK8ZYCv5F_v{margin-left:2px}html[dir=rtl] ._3F0_t8g3aT4pK8ZYCv5F_v{margin-right:2px}',""]),t.locals={insightsContainer:"_1SF9qXLy2s3Ji75K89nUPa",insightsContent:"_2g7s6JwY6AIPAVo9vNiv8k",firstLineHeaderText:"_3VrzUzj4kEp7cooLu3qn30",secondLineHeaderText:"_2UH1ZBkEL0WgTbJveQ-nPH",relatedContentHeaderText:"_2UkQUnUHv-expqoTNGcOWN",relatedContentHeaderSubText:"_3ahRzlDxJG-uPxz7wjRx1b",headerRow:"_3L97dFeEsl0O_hhSuv5TNx",insightsIconContainer:"B1phlXIYmhScUSDRrMYQm",insightsIcon:"_3F0_t8g3aT4pK8ZYCv5F_v"}},7976:function(e,t,n){(t=e.exports=n(129)(!1)).push([e.i,"html[dir] .BzMImhgQV2EOmRRKpgJ8M{padding:0}html[dir=ltr] ._2SkVtzLLeg3BNxqJg3sYio{padding-left:20px}html[dir=rtl] ._2SkVtzLLeg3BNxqJg3sYio{padding-right:20px}html[dir=ltr] ._3VJyREcZCIhpjIV_xJpAjy{margin-left:20px}html[dir=rtl] ._3VJyREcZCIhpjIV_xJpAjy{margin-right:20px}",""]),t.locals={insightsContainer:"BzMImhgQV2EOmRRKpgJ8M",insightsContent:"_2SkVtzLLeg3BNxqJg3sYio",relatedContentHeaderSubText:"_3VJyREcZCIhpjIV_xJpAjy"}}}]);
//# sourceMappingURL=owa.MailBoot~CalendarCard~CalendarPeek~CalendarReadingPaneStore~RelatedContentInsightsOpx.js.map
self.scriptsLoaded['owa.MailBoot~CalendarCard~CalendarPeek~CalendarReadingPaneStore~RelatedContentInsightsOpx.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarCard~CalendarPeek~CalendarReadingPaneStore~RelatedContentInsightsOpx.js'] = (new Date()).getTime();