self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RelatedContentInitialization.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[825,797],{1493:function(t,e,n){"use strict";n.d(e,"g",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"h",(function(){return a})),n.d(e,"j",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return b})),n.d(e,"l",(function(){return m})),n.d(e,"m",(function(){return v})),n.d(e,"k",(function(){return p}));var r=n(1950),i=n(1884);function u(t){return Object(i.b)().meetingIdToInsightsMap.get(t)}function c(t){var e=u(t);return e?e.files.filter((function(t){return!t.isMeetingAttachment})):[]}function a(t){var e=u(t);return e?e.emails.filter((function(t){return!t.isMeetingAttachment})):[]}function o(t){return c(t).length+a(t).length}function s(t){var e=u(t);return e?e.files.filter((function(t){return t.isMeetingAttachment})):[]}function f(t){var e=u(t);return e?e.emails.filter((function(t){return t.isMeetingAttachment})):[]}function d(t){var e=u(t);return e&&0!==e.files.length?e.files:[]}function l(t){var e=u(t);return e&&0!==e.emails.length?e.emails:[]}function h(t){return c(t).filter((function(t){return 1===t.relevanceRelationship})).length}function b(t){return a(t).filter((function(t){return 1===t.relevanceRelationship})).length}function m(t){return Object(r.a)(t)&&d(t).length>0}function v(t){return Object(r.a)(t)&&d(t).length+l(t).length>0}function p(t){return Object(r.a)(t)&&d(t).length>0}},1697:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1493);function i(t){var e=Object(r.g)(t);return e?e.traceId:null}},1832:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(233);function i(t){switch(t){case 1:return"ReadingPane";case 2:return"ItemPeek";case 3:return"PrefetchOnCalendarSelected";case 4:return"AgendaView";case 5:return"Reminder";case 6:return"Deeplink";case 7:return"PrefetchOnAgendaView";case 8:return"TimePanelEventDetails";case 9:return"TabbedDetailsForm";case 10:return"UpNext";case 11:return"CalendarCard";default:return Object(r.a)(t)}}},1873:function(t,e,n){"use strict";var r=n(69),i=n(1832),u=n(1883),c=(n(1884),n(1950)),a=n(1493),o=n(1697),s=n(1),f=n(47);function d(t){var e=Object(a.g)(t);return e?e.dataFetchSource:null}var l=n(2612);var h=n(269),b=Object(f.a)((function(t){var e=t.eventId,n=t.source,r=Object(o.a)(e),u=s.useRef(r),c=s.useRef(new h.a("RelatedContentFilesAndEmailsRenderingLatency",{isCore:!0,isCosmosDatapoint:!0}));s.useEffect((function(){return j.importAndExecute(c.current,e),function(){c.current&&c.current.invalidate()}}),[]);var f=function(){(function(t,e,n){if(!t)return!1;var r=Object(o.a)(e);if(!r)return!1;var u=Object(a.i)(e).length,c=Object(a.h)(e).length;return t.addCustomData({filesCount:u,emailsCount:c,dataFetchSource:d(e),isOrganizer:Object(l.a)(e),traceId:r,explicitFilesCount:Object(a.e)(e),explicitEmailsCount:Object(a.d)(e),fileAttachmentsCount:Object(a.f)(e).length,entrySource:Object(i.a)(n)}),t.end(),O.importAndExecute(e,n),!0})(c.current,e,n)&&(c.current=null)};return s.useEffect((function(){r&&(u.current&&r!=u.current?(c.current&&c.current.invalidate(),c.current=new h.a("RelatedContentFilesAndEmailsRenderingLatency",{isCore:!0,isCosmosDatapoint:!0}),f()):f(),u.current=r)}),[r]),null}));n.d(e,"t",(function(){return v})),n.d(e,"y",(function(){return p})),n.d(e,"x",(function(){return g})),n.d(e,"w",(function(){return O})),n.d(e,"v",(function(){return j})),n.d(e,"u",(function(){return k})),n.d(e,"b",(function(){return y})),n.d(e,"c",(function(){return I})),n.d(e,"e",(function(){return i.a})),n.d(e,"a",(function(){return u.a})),n.d(e,"r",(function(){return c.b})),n.d(e,"q",(function(){return c.a})),n.d(e,"s",(function(){return c.c})),n.d(e,"l",(function(){return a.i})),n.d(e,"k",(function(){return a.h})),n.d(e,"m",(function(){return a.j})),n.d(e,"i",(function(){return a.f})),n.d(e,"h",(function(){return a.c})),n.d(e,"g",(function(){return a.b})),n.d(e,"f",(function(){return a.a})),n.d(e,"o",(function(){return a.l})),n.d(e,"p",(function(){return a.m})),n.d(e,"n",(function(){return a.k})),n.d(e,"j",(function(){return o.a})),n.d(e,"d",(function(){return b}));var m=new r.c((function(){return Promise.all([n.e(1),n.e(29),n.e(168),n.e(244),n.e(775)]).then(n.bind(null,15990))})),v=new r.a(m,(function(t){return t.fetchMeetingInsights})),p=new r.a(m,(function(t){return t.openFileInsight})),g=new r.a(m,(function(t){return t.openEmailInsight})),O=new r.a(m,(function(t){return t.logInsightsRenderAndLayout})),j=new r.a(m,(function(t){return t.logInsightsCacheHitMissRate})),k=(new r.a(m,(function(t){return t.logFileInsightClicked})),new r.a(m,(function(t){return t.logEmailInsightClicked})),new r.a(m,(function(t){return t.logInsightSummaryClicked}))),y=Object(r.d)(m,(function(t){return t.InsightDocList})),I=Object(r.d)(m,(function(t){return t.InsightDocSummary}))},1883:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(725),i=40,u=new r.a(i);e.b=u},1884:function(t,e,n){"use strict";n.d(e,"b",(function(){return c}));var r=n(1883),i=n(3),u={meetingIdToInsightsMap:new(n(18).ObservableMap)({}),pendingServiceQueue:[]};r.b.initialize(u.meetingIdToInsightsMap);var c=Object(i.createStore)("meetingInsightsStore",u);e.a=c()},1950:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return f}));var r=n(179),i=n(1192),u=n(1229),c=n(98),a=n(29);function o(){return Object(a.a)().SessionSettings.IsSubstrateSearchServiceAvailable&&!Object(c.s)()}function s(t){if(!o())return!1;var e=Object(u.k)(t);if(!e)return!1;var n=!!e.IsMeeting,c=e.ParentFolderId.Id,a=Object(r.o)(c);return a?n&&!a.IsGroupMailboxCalendar&&!Object(i.C)(e):n}function f(t){return 1==t&&o()}},2461:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r,i=n(9),u=n(98),c=n(233);function a(t,e,n){if(void 0===n&&(n=Object(i.Pb)()),Object(i.Ib)(t,n))return-1===Object(i.p)(e,n)?r.EarlierToday:1===Object(i.p)(t,n)?r.LaterToday:-1===Object(i.p)(t,n)&&1===Object(i.p)(e,n)?r.Now:(Object(c.a)(t),-2);if(Object(i.Lb)(t,n,Object(u.n)().WeekStartDay)){var a=Object(i.Wb)(t),o=Object(i.Wb)(Object(i.Qb)(t.tz,n)),s=Object(i.u)(a,o);return s<-1?r.SameWeekBeforeYesterday:-1===s?r.Yesterday:1===s?r.Tomorrow:s>1?r.SameWeekAfterTomorrow:(Object(c.a)(s),-1)}var f=Object(i.ac)(t,Object(u.n)().WeekStartDay),d=Object(i.ac)(Object(i.Qb)(t.tz,n),Object(u.n)().WeekStartDay),l=Object(i.z)(f,d);return l<-1?r.BeforeLastWeek:-1===l?r.LastWeek:1===l?r.NextWeek:l>1?r.AfterNextWeek:(Object(c.a)(l),-1)}!function(t){t[t.BeforeLastWeek=0]="BeforeLastWeek",t[t.LastWeek=1]="LastWeek",t[t.SameWeekBeforeYesterday=2]="SameWeekBeforeYesterday",t[t.Yesterday=3]="Yesterday",t[t.Now=4]="Now",t[t.Tomorrow=5]="Tomorrow",t[t.SameWeekAfterTomorrow=6]="SameWeekAfterTomorrow",t[t.NextWeek=7]="NextWeek",t[t.AfterNextWeek=8]="AfterNextWeek",t[t.EarlierToday=9]="EarlierToday",t[t.LaterToday=11]="LaterToday"}(r||(r={}))},2612:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s}));var r=n(1229),i=n(1493),u=n(2461);function c(t){var e=Object(r.k)(t);return!!e&&e.IsOrganizer}function a(t){var e=Object(r.k)(t);return e?Object(u.a)(e.Start,e.End):-1}function o(t,e){for(var n=Object(i.i)(t),r=0;r<n.length;r++)if(n[r].referenceId===e)return r;return-1}function s(t,e){for(var n=Object(i.h)(t),r=0;r<n.length;r++)if(n[r].referenceId===e)return r;return-1}},433:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout((function(){t.tryRunTask()}),this.taskDelay)},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.tryRunTask=function(){var t=this;if(this.canRunMoreTasks()){var e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((function(){t.onTaskComplete()})).catch((function(){t.onTaskComplete()})),this.scheduleTask()}},t}();n.d(e,"a",(function(){return r}))},5015:function(t,e,n){"use strict";n.r(e);var r=n(3),i=Object(r.action)("initializeEventRelatedContent"),u=Object(r.action)("prefetchInsights",(function(t,e){return{events:t,dataFetchSource:e}})),c=n(6688),a=n(9),o=n(521),s=n(1873),f=new(n(433).a)(3,(function(t){var e=t.event.ItemId.Id,n=t.dataFetchSource;return s.t.importAndExecute(e,n).catch((function(){}))}),500);Object(r.orchestrator)(u,(function(t){if(Object(s.r)())for(var e=t.events,n=t.dataFetchSource,r=Object(o.d)(Object(a.Wb)(Object(a.kc)()),3),i=Object(c.a)(e,[r]).eventsOverlapping,u=Math.min(i.length,s.a),d=0;d<u;d++){var l=i[d];Object(s.q)(l.ItemId.Id)&&!Object(s.j)(l.ItemId.Id)&&f.add({event:l,dataFetchSource:n})}}));var d=n(0),l=n(133),h=n(311),b=n(52);Object(r.orchestrator)(i,(function(t){return Object(d.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(d.__generator)(this,(function(e){switch(e.label){case 0:if(!Object(s.r)())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Object(h.e)("ows/api/beta/events/relatedContent/warmup",{},"",!0)];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),b.g.warn("[initializeEventRelatedContent failed] : "+t),[3,4];case 4:return window.setTimeout(i,l.a.MillisecondsInOneDay),[2]}}))}))}));n.d(e,"initializeEventRelatedContent",(function(){return i})),n.d(e,"prefetchInsights",(function(){return u}))},725:function(t,e,n){"use strict";var r=n(0),i=n(275),u=n(52),c=function(){function t(t){this.maxSize=t,this.references=[],this.mruList=[]}return t.prototype.initialize=function(t,e){var n,i;if(this.store){var c=new Error("MruCache cannot be initialized twice.");c.diagnosticInfo=this.firstCs,u.d(c)}else{this.store=t,this.deleteCallback=e;try{for(var a=Object(r.__values)(t.keys()),o=a.next();!o.done;o=a.next()){var s=o.value;this.mruList.push(s)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.firstCs=(new Error).stack}},t.prototype.add=function(t,e){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(t,e),n.mruList.indexOf(t)>=0?n.touch(t):(n.mruList.push(t),n.purgeIfNecessary())}))()},t.prototype.get=function(t){return this.store.get(t)},t.prototype.getAndTouch=function(t){var e=this.store.get(t);return e&&this.touch(t),e},t.prototype.has=function(t){return this.store.has(t)},t.prototype.remove=function(t){var e=this;Object(i.action)("MruCache_remove")((function(){if(e.store.has(t)&&!e.isReferenced(t))return e.removeItemAtIndex(e.mruList.indexOf(t))}))()},t.prototype.registerReference=function(t){this.references.push(t)},t.prototype.clear=function(){var t=this;Object(i.action)("MruCache_clear")((function(){t.purgeTillSize(0)}))()},t.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},t.prototype.touch=function(t){var e=this.mruList.indexOf(t);if(e<0)throw new Error("Item with key '"+t+"' does not exist in the cache.");this.mruList.splice(e,1),this.mruList.push(t)},t.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},t.prototype.purgeTillSize=function(t){for(var e=0;this.mruList.length>t&&e<this.mruList.length;){var n=this.mruList[e];this.isReferenced(n)?e++:this.removeItemAtIndex(e)}},t.prototype.removeItemAtIndex=function(t){if(t<0||t>=this.mruList.length)throw new Error("Invalid index to remove: "+t);var e=this.mruList[t];this.mruList.splice(t,1),this.deleteCallback?this.deleteCallback(e):this.store.delete(e)},t.prototype.isReferenced=function(t){for(var e=0;e<this.references.length;e++){var n=this.references[e]();if(Array.isArray(n)){if(-1!=n.indexOf(t))return!0}else if(n==t)return!0}return!1},t}();n.d(e,"a",(function(){return c}))}}]);
//# sourceMappingURL=owa.RelatedContentInitialization.js.map
self.scriptsLoaded['owa.RelatedContentInitialization.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RelatedContentInitialization.js'] = (new Date()).getTime();