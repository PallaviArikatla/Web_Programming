self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[622],{1232:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(3),o=r(18),u=Object(n.createStore)("groupsStore",{groups:new o.ObservableMap})},1248:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1232);function o(t){var e=Object(n.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1254:function(t,e,r){"use strict";var n;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(n||(n={})),e.a=n},1257:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(3),o=r(1304),u=Object(n.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1262:function(t,e,r){"use strict";var n=r(3),o=r(18),u=(Object(n.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})(),r(1377),r(1304),r(1232)),i=r(1257),a=r(1248);function c(t){var e=Object(u.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var s=r(1321),f=r(1404),p=function(){return Object(f.a)().smtpAddress},b=r(1280),d=Object(n.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,r,n){if(2==e){var o=Object(a.a)(t);Object(s.a)(o,"Site")[0].Url=r,Object(s.a)(o,"Files")[0].Url=n}})),l=r(1416);function g(t){return t=t.toLocaleLowerCase(),Object(b.a)().groupSiteStatus.has(t)?Object(b.a)().groupSiteStatus.get(t):0}var O=function(t){var e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null},v=(r(1254),r(1410),r(1399),r(1417),r(1411),r(1668)),S=r(1669),j=r(1682),m=r(1650),D=r(1651),A=r(11);function y(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(A.b)(m.a);if(3===e)return Object(A.b)(D.a)}return""}function h(t){var e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(A.b)(j.b);if(3===e)return Object(A.b)(j.c)}return""}function I(t){var e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(A.c)(Object(A.b)(S.a),e.toString()):Object(A.c)(Object(A.b)(v.a),e.toString()):Object(A.b)(j.a)}r.d(e,"j",(function(){return u.a})),r.d(e,"l",(function(){return i.a})),r.d(e,"d",(function(){return a.a})),r.d(e,"m",(function(){return c})),r.d(e,"f",(function(){return s.a})),r.d(e,"g",(function(){return s.b})),r.d(e,"c",(function(){return p})),r.d(e,"i",(function(){return b.a})),r.d(e,"o",(function(){return d})),r.d(e,"n",(function(){return l.b})),r.d(e,"h",(function(){return g})),r.d(e,"e",(function(){return O})),r.d(e,"a",(function(){return y})),r.d(e,"b",(function(){return h})),r.d(e,"k",(function(){return I}))},1280:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(3),o=r(18),u=Object(n.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1304:function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(n||(n={}))},1321:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return u}));var n=r(1248),o=function(t,e){var r="string"==typeof t?Object(n.a)(t):t;if(!r||!r.GroupResources)return null;var o=r.GroupResources.filter((function(t){return t.Name===e}));return!o||o.length<1?null:o},u=function(t,e){var r=o(t,e);return r&&0!=r.length?r[0].Url:null}},1332:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(0);function o(t){return Object(n.__assign)({__type:"IndexedPageView:#Exchange"},t)}},1377:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(84),o=r(1257),u=r(98);function i(){return(Object(n.i)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(u.s)()}},1399:function(t,e,r){"use strict";var n=r(3),o=r(1457),u=Object(n.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1404:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(3),o=Object(n.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},1410:function(t,e,r){"use strict";var n=r(3),o=r(1456),u=Object(n.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=u},1411:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1254),o=r(1457);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},1416:function(t,e,r){"use strict";r.d(e,"b",(function(){return u}));var n=r(3),o=r(1280),u=Object(n.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=u},1417:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(1254),o=r(1456);function u(t){t=t.toLowerCase();var e=o.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},1456:function(t,e,r){"use strict";var n=r(3),o=r(18);e.a=Object(n.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},1457:function(t,e,r){"use strict";var n=r(3),o=r(18);e.a=Object(n.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},1494:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(0);function o(t){return Object(n.__assign)({__type:"UnifiedGroupIdentity:#Exchange"},t)}},1562:function(t,e,r){"use strict";var n,o,u,i,a,c,s,f,p,b,d,l,g,O,v;var S;r(11);function j(t,e){e,S=t}function m(){return S}r.d(e,"o",(function(){return n})),r.d(e,"n",(function(){return o})),r.d(e,"c",(function(){return u})),r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return a})),r.d(e,"g",(function(){return c})),r.d(e,"d",(function(){return s})),r.d(e,"f",(function(){return f})),r.d(e,"l",(function(){return p})),r.d(e,"m",(function(){return b})),r.d(e,"q",(function(){return d})),r.d(e,"r",(function(){return l})),r.d(e,"h",(function(){return g})),r.d(e,"j",(function(){return O})),r.d(e,"e",(function(){return v})),r.d(e,"p",(function(){})),r.d(e,"k",(function(){return j})),r.d(e,"i",(function(){return m}))},1584:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(0);function o(t){return Object(n.__assign)({__type:"BodyContentType:#Exchange"},t)}},1650:function(t){t.exports=JSON.parse('{"a":"Lba"}')},1651:function(t){t.exports=JSON.parse('{"a":"Kba"}')},1668:function(t){t.exports=JSON.parse('{"a":"sba"}')},1669:function(t){t.exports=JSON.parse('{"a":"Pba"}')},1682:function(t){t.exports=JSON.parse('{"b":"Mba","c":"Nba","a":"Oba"}')},2328:function(t,e,r){"use strict";function n(t,e,r){var n,o,u,i,a,c=t.groups.get(e.toLowerCase());if(c||(r.unreadMessageCount=null,r.groupDetailsError=r.groupDetailsError||!1),!r.groupDetailsError||c&&c.basicInformation||(r.basicInformation={SmtpAddress:e,DisplayName:e}),r.groupDetails){var s=r.groupDetails;c&&c.basicInformation&&!c.groupDetailsError||(r.basicInformation={SmtpAddress:s.SmtpAddress,DisplayName:s.DisplayName,AccessType:s.AccessType,LegacyDN:s.LegacyDN,MailboxGuid:s.MailboxGuid}),r.groupDetails.UserGroupRelationship={SubscriptionType:(null===(n=s.UserGroupRelationship)||void 0===n?void 0:n.SubscriptionType)||0,IsSubscribed:(null===(o=s.UserGroupRelationship)||void 0===o?void 0:o.IsSubscribed)||!1,ShouldIgnoreReply:(null===(u=s.UserGroupRelationship)||void 0===u?void 0:u.ShouldIgnoreReply)||!1,IsMember:(null===(i=s.UserGroupRelationship)||void 0===i?void 0:i.IsMember)||!1,IsOwner:(null===(a=s.UserGroupRelationship)||void 0===a?void 0:a.IsOwner)||!1}}return r}var o=r(275),u=r(1404),i=Object(o.action)("addOrUpdateGroup")((function(t,e,r,o,i){var a;e=e.toLowerCase();var c=void 0!==o&&""!==o;if(c&&(o=o.toLowerCase(),e=r.groupDetails.SmtpAddress),r=n(t,c?o:e,r),t.groups.has(e)||c&&t.groups.has(o)){var s=t.groups.has(e)?t.groups.get(e):t.groups.get(o);r.basicInformation&&(s.basicInformation=r.basicInformation),r.groupDetails&&((null===(a=s.groupDetails)||void 0===a?void 0:a.MailboxSettings)&&!r.groupDetails.MailboxSettings&&(r.groupDetails.MailboxSettings=s.groupDetails.MailboxSettings),s.groupDetails=r.groupDetails),r.members&&(s.members=r.members),null!=r.groupDetailsError&&(s.groupDetailsError=r.groupDetailsError),c&&e!==o&&(void 0!==i&&i(e,o),t.groups.set(e,s),t.groups.delete(o),Object(u.a)().smtpAddress=e)}else t.groups.set(e,r)}));e.a=i},3114:function(t,e,r){"use strict";var n=r(275),o=r(1562),u=r(1733),i=r(1262),a=r(2328),c=r(1416),s=r(1321);var f=function(t,e){var r=Object(s.b)(e,"Site");r?!function(t){return-1==t.indexOf("_layouts/groupstatus.aspx")}(r)?Object(c.a)(t,1):Object(c.a)(t,2):Object(c.a)(t,0)},p=r(3),b=Object(p.action)("beforeGetGroupDetailsStartAction",(function(t){return{groupSmtpAddress:t}}));Object(p.orchestrator)(b,(function(t){3==Object(i.h)(t.groupSmtpAddress)&&Object(i.n)(t.groupSmtpAddress,1)}));var d=b,l=r(1404),g=Object(p.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(function(t,e){Object(l.a)().groupId=t,Object(l.a)().tenantId=e})),O=function(t,e){Object(a.a)(Object(i.j)(),t,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(i.n)(t,0),e&&e()},v=Object(n.action)("getGroupDetailsAction")((function(t,e,r,n){d(t),(o.g||u.f)(t,e).then((function(e){return function(t,e,r,n){if(t&&t.Body&&Object(u.i)(t.Body)){var o=t.Body.GroupDetails;o?(Object(a.a)(Object(i.j)(),o.SmtpAddress,{basicInformation:null,groupDetails:o,members:null,groupDetailsError:!1}),g(o.ExternalDirectoryObjectId,o.ExternalDirectoryOrganizationId),f(e,o),r&&r()):O(e,n)}else O(e,n)}(e,t,r,n)})).catch((function(e){O(t,n)}))}));e.a=v},6644:function(t,e,r){"use strict";r.r(e);var n=r(0),o=r(6878),u=r(4847),i=r(3),a=Object(i.action)("loadUnifiedGroupsSettings");Object(i.orchestrator)(a,(function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,Object(u.b)()];case 1:return(null==(t=e.sent())?void 0:t.unifiedGroupSettings)&&t.responseCode===u.a.Success&&Object(o.a)(t.unifiedGroupSettings),[2]}}))}))}));var c=a,s=r(3114);r.d(e,"loadUnifiedGroupsSettings",(function(){return c})),r.d(e,"getGroupDetailsAction",(function(){return s.a}))},6878:function(t,e,r){"use strict";var n=r(391),o=r(1257);e.a=Object(n.mutatorAction)("updateUnifiedGroupSettings",(function(t){var e=Object(o.a)();Object.keys(t).forEach((function(r){e[r]=t[r]}))}))}}]);
//# sourceMappingURL=owa.MailBoot~OwaGroupSharedActions.js.map
self.scriptsLoaded['owa.MailBoot~OwaGroupSharedActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OwaGroupSharedActions.js'] = (new Date()).getTime();