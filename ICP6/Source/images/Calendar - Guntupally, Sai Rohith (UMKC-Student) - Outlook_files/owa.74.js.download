self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.74.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[74],{10461:function(e,t,n){"use strict";var r=n(9007),i=n(69),a=n(1833),o=n(7475),c=n(1648),u=n(1834),l=n(4304),d=n(2146),s=n(4305),f=n(2147),b=n(6721),v=n(9200),m=n(3025),O=n(3182),p=n(3),y=n(1183);Object(p.orchestrator)(m.a,(function(e){var t=e.rowKeys,n=e.tableView,r=e.actionType,i=e.shouldRemoveFromAllTables,a=n.id,o=t.filter((function(e){return n.rowKeys.indexOf(e)>=0}));if(0!=o.length){var c=Object(y.D)(o,a);if(Object(v.a)(o,n,r),"All"==Object(y.P)(n)&&i){var u=Object(O.a)(n.tableQuery.folderId,!1),l=Object(y.l)(n),d=Object(y.u)(a);u.forEach((function(e){if(a!=e.id&&l===Object(y.l)(e)&&d==Object(y.u)(e.id)){var t=Object(y.F)(c,e);0!=t.length&&Object(v.a)(t,e,r)}}))}}}));function j(e,t){if(!t||0==t.length)return e;var n=[];return t.forEach((function(e){n.push(e)})),e.forEach((function(e){-1===t.indexOf(e)&&n.push(e)})),n}function w(e,t){return t&&0!=t.length?(e.forEach((function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)})),0===t.length&&(t=void 0),t):t}var I=n(6723),g=n(1200);Object(p.mutator)(I.a,(function(e){var t=e.conversationRowKeys,n=e.tableViewId,r=e.categoriesToAdd,i=e.categoriesToRemove,a=e.clearCategories;t.forEach((function(e){r&&function(e,t,n){var r=Object(y.L)(e,t);r.categories=j(n,r.categories);var i=Object(y.K)().tableViews.get(t);y.b.getItemIds(e,i).forEach((function(e){var t=Object(g.v)(e);t&&(t.Categories=j(n,t.Categories))}))}(e,n,r),i&&function(e,t,n){var r=Object(y.L)(e,t);r.categories=w(n,r.categories);var i=Object(y.K)().tableViews.get(t);y.b.getItemIds(e,i).forEach((function(e){var t=Object(g.v)(e);t&&(t.Categories=w(n,t.Categories))}))}(e,n,i),a&&function(e,t){Object(y.L)(e,t).categories=void 0;var n=Object(y.K)().tableViews.get(t);y.b.getItemIds(e,n).forEach((function(e){var t=Object(g.v)(e);t&&(t.Categories=void 0)}))}(e,n)}))}));var h=n(0),k=n(6724);Object(p.mutator)(k.a,(function(e){var t=e.itemIds,n=e.categoriesToAdd,r=e.categoriesToRemove,i=e.clearCategories;t.forEach((function(e){var t=Object(g.v)(e);n&&(t.Categories=j(n,t.Categories),function(e,t){var n,r,i=Object(O.a)(e.ParentFolderId.Id,!0),a=function(n){if(Object(y.Q)(n)){var r=e.ConversationId.Id,i=Object(y.F)([r],n);if(0===i.length)return"continue";i.forEach((function(e){var r=Object(y.L)(e,n.id);r.categories=j(t,r.categories)}))}};try{for(var o=Object(h.__values)(i),c=o.next();!c.done;c=o.next()){var u=c.value;a(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(t,n)),r&&(t.Categories=w(r,t.Categories),t.Categories||(t.Categories=[])),i&&(t.Categories=[])}))}));var T=new i.c((function(){return n.e(1150).then(n.bind(null,16343))}));Object(i.f)(f.a,T,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(i.f)(s.a,T,(function(e){return e.markItemsAsPinnedStoreUpdateOrchestrator})),Object(i.f)(d.a,T,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(i.f)(l.a,T,(function(e){return e.markConversationsAsPinnedStoreUpdateOrchestrator})),Object(i.f)(c.a,T,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(i.f)(a.a,T,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(i.f)(o.a,T,(function(e){return e.deleteFolderStoreUpdateOrchestrator})),Object(i.f)(u.a,T,(function(e){return e.markAllAsReadOrchestrator})),Object(i.f)(b.a,T,(function(e){return e.updateCategoriesInViewOrchestrator}));var N=new i.a(T,(function(e){return e.removeTableFromStore}));function S(e){Object(r.b)(e),N.importAndExecute(e)}n.d(t,"a",(function(){return S}))},10524:function(e,t,n){"use strict";var r={warmedUpGroups:null,warmUpTime:0};function i(e){r.warmUpTime=e}function a(){return r.warmUpTime}function o(e){r.warmedUpGroups=e}function c(e){var t=e.toLowerCase();if(!r.warmedUpGroups)return!1;for(var n=0;n<r.warmedUpGroups.length;++n){if(r.warmedUpGroups[n].toLowerCase()==t)return!0}return!1}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}))},10537:function(e,t,n){"use strict";var r=n(31),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetFolderChangeDigestRequest:#Exchange"},n)),Object(r.a)("GetFolderChangeDigest",e,t)}n.d(t,"a",(function(){return a}))},10645:function(e){e.exports=JSON.parse('{"a":"Bca","c":"Cca","b":"Dca","d":"Eca"}')},1513:function(e,t){e.exports=function(e){return e instanceof Date}},1526:function(e,t,n){var r=n(1513),i=36e5,a=6e4,o=2,c=/[T ]/,u=/:/,l=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],s=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,v=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,O=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,y=/^(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,g=/^(Z)$/,h=/^([+-])(\d{2})$/,k=/^([+-])(\d{2}):?(\d{2})$/;function T(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var N=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=I.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),S=function(e,t){var n,r=d[t],i=f[t];if(n=s.exec(e)||i.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=l.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(N.date,n),C=S.year,F=function(e,t){if(null===t)return null;var n,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=b.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=v.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=m.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,i,c),r}if(n=O.exec(e))return a=parseInt(n[1],10)-1,T(t,a);if(n=p.exec(e)){a=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return T(t,a,u)}return null}(S.restDateString,C);if(F){var R,V=F.getTime(),E=0;return N.time&&(E=function(e){var t,n,r;if(t=y.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=j.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*a;if(t=w.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*i+r*a+1e3*o}return null}(N.time)),N.timezone?R=function(e){var t,n;if(t=g.exec(e))return 0;if(t=h.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=k.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(N.timezone):(R=new Date(V+E).getTimezoneOffset(),R=new Date(V+E+R*a).getTimezoneOffset()),new Date(V+E+R*a)}return new Date(e)}},1533:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(3),i={bulkActionInformationMap:new(n(18).ObservableMap)},a=Object(r.createStore)("bulkActionStore",i),o=a();t.a=o},1565:function(e,t,n){"use strict";var r=n(69),i=n(1533),a=n(2697),o=n(52);function c(e){var t=i.a.bulkActionInformationMap.get(e);return!!t&&(!(t.customData&&!function(e){var t;try{t=JSON.parse(e)}catch(e){return o.d("Failed to parse bulkActionInfo.customData"),!1}return null!==t&&null!==t.Scenario}(t.customData))&&!Object(a.a)(t,e))}function u(e,t){var n=i.a.bulkActionInformationMap.get(e);return c(e)&&n.state==t}function l(e){return(u(e,d.b.Uninitialized)||u(e,d.b.Running))&&c(e)}var d=n(1836);n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return v})),n.d(t,"k",(function(){return m})),n.d(t,"f",(function(){return O})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return y})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d.b})),n.d(t,"l",(function(){return i.a}));var s=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(25),n.e(43),n.e(51),n.e(58),n.e(66),n.e(203),n.e(445)]).then(n.bind(null,10430))})),f=Object(r.d)(s,(function(e){return e.BulkActionSpinner})),b=new r.a(s,(function(e){return e.subscribeToBulkActionNotification})),v=new r.a(s,(function(e){return e.onBulkActionSubmitted})),m=new r.a(s,(function(e){return e.findBulkActionItemAction})),O=new r.a(s,(function(e){return e.onBulkActionCancel})),p=new r.a(s,(function(e){return e.onBulkActionHierarchyNotification})),y=new r.a(s,(function(e){return e.onBulkActionDismiss}))},1705:function(e,t,n){"use strict";var r=n(69),i=n(2246),a=n(1833),o=n(1648),c=n(1834),u=n(2146),l=n(2147),d=n(2062),s=n(2185),f=n(2103),b=n(1286),v=n(84),m=n(1197);function O(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function p(e,t){return 2!=t&&(Object(v.i)("rp-persistedReadingPaneTabs")?b.a.loadedItemReadingPaneViewStates.has(e):b.a.itemReadingPaneViewState&&b.a.itemReadingPaneViewState.itemId==e)}var y=n(1910),j=n(1911),w=n(1805),I=n(1349);n.d(t,"l",(function(){return h})),n.d(t,"p",(function(){return k})),n.d(t,"m",(function(){return T})),n.d(t,"q",(function(){return N})),n.d(t,"s",(function(){return S})),n.d(t,"n",(function(){return C})),n.d(t,"o",(function(){return F})),n.d(t,"i",(function(){return R})),n.d(t,"j",(function(){return V})),n.d(t,"k",(function(){return E})),n.d(t,"g",(function(){return D})),n.d(t,"r",(function(){return x})),n.d(t,"h",(function(){return A})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return y.a})),n.d(t,"a",(function(){return j.a})),n.d(t,"t",(function(){return b.a})),n.d(t,"c",(function(){return w.a})),n.d(t,"b",(function(){return I.a}));var g=new r.c((function(){return Promise.all([n.e(1),n.e(5),n.e(7),n.e(11),n.e(15),n.e(16),n.e(17),n.e(18),n.e(26),n.e(42),n.e(76),n.e(120),n.e(166),n.e(171),n.e(169),n.e(245),n.e(255),n.e(650)]).then(n.bind(null,16275))})),h=new r.a(g,(function(e){return e.loadConversationReadingPane})),k=new r.a(g,(function(e){return e.moveReadingPaneToTab})),T=new r.a(g,(function(e){return e.loadConversationReadingPaneForSingleMailItemSelected})),N=new r.a(g,(function(e){return e.print})),S=new r.a(g,(function(e){return e.setItemIdToScrollTo})),C=new r.a(g,(function(e){return e.loadItemReadingPane})),F=new r.a(g,(function(e){return e.loadItemReadingPaneForSingleMailItemSelected})),R=new r.a(g,(function(e){return e.expandCollapseAllItemParts}));Object(r.f)(o.a,g,(function(e){return e.deleteItemsStoreUpdateOrchestrator})),Object(r.f)(u.a,g,(function(e){return e.markConversationsAsReadStoreUpdateOrchestrator})),Object(r.f)(l.a,g,(function(e){return e.markItemsAsReadStoreUpdateOrchestrator})),Object(r.f)(c.a,g,(function(e){return e.markAllAsReadOrchestrator})),Object(r.f)(i.a,g,(function(e){return e.applyConversationFlagStateStoreUpdateOrchestrator})),Object(r.f)(a.a,g,(function(e){return e.deleteConversationStoreUpdateOrchestrator})),Object(r.f)(f.a,g,(function(e){return e.conversationReadyToLoadOrchestrator})),Object(r.f)(f.b,g,(function(e){return e.updateAttachmentsOrchestrator})),Object(r.f)(f.c,g,(function(e){return e.updateItemMandatoryPropertiesOrchestrator})),Object(r.f)(d.a,g,(function(e){return e.updateInternetMessageIdOrchestrator})),Object(r.f)(s.a,g,(function(e){return e.initializeExtendedCardForItemReadingPaneOrchestrator}));new r.b(g,(function(e){return e.getLastestNonDraftItemId}));var V=new r.b(g,(function(e){return e.getLatestNonDraftItemIdFromConversation})),E=new r.b(g,(function(e){return e.isUnsupportedItem})),D=new r.a(g,(function(e){return e.clearReadingPaneStore})),x=new r.a(g,(function(e){return e.replyByMeeting})),A=new r.a(g,(function(e){return e.ensureSecondaryReadingPaneTabHandler}))},1836:function(e,t,n){"use strict";var r,i;n.d(t,"a",(function(){return i})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(r||(r={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(i||(i={})),t.b=r},2227:function(e,t,n){"use strict";var r=n(2274),i=n(2462),a=n(0),o=n(2903),c=n(2327),u=n(1225),l=n(2086);var d=n(1183);function s(e,t,n,s,f,b,v,m){var O,p=f||"All",y=v||Object(i.a)(e),j=null==s?function(e){if("inbox"!==Object(u.a)(e))return-1;if(!Object(c.a)())return-1;return 0}(e):s,w=null==m?function(e){var t,n;if("inbox"!==Object(u.a)(e))return 0;if(!Object(l.b)())return Object(c.a)()?1:0;var r=o.a.inboxPlusPivots;try{for(var i=Object(a.__values)(r),d=i.next();!d.done;d=i.next()){var s=d.value;if(s.isEnabled)return s.InboxClassificationFilter}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return 0}(e):m;switch(t){case 0:O=Object(r.g)(e,Object(d.S)(n));break;case 1:O=Object(r.j)()}return{folderId:e,focusedViewFilter:j,listViewType:t,viewFilter:p,sortBy:y,requestShapeName:O,type:0,shouldTryToUseSessionDataResponse:!0,categoryName:b,scenarioType:n,inboxClassificationFilter:w}}n.d(t,"a",(function(){return s}))},2344:function(e,t,n){"use strict";var r;!function(e){e[e.Email=0]="Email",e[e.Files=1]="Files",e[e.Calendar=2]="Calendar",e[e.Members=3]="Members"}(r||(r={})),t.a=r},2696:function(e,t,n){"use strict";var r=n(3),i=n(2344);t.a=Object(r.createStore)("commandBarStore",{navigationButtonSelected:i.a.Email,hidden:!1})()},2697:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2907),i=n.n(r),a=n(1836),o=n(1533);function c(e,t){var n=new Date,r=new Date(e.sendTime),c=i()(n,r),u=isNaN(c),l=c>7.5,d=Object(o.b)().bulkActionInformationMap.get(t);return!(!u&&!l)||!!d&&[a.b.Cancelled,a.b.Failed,a.b.Complete].indexOf(d.state)>-1}},2797:function(e,t,n){var r=n(1526);e.exports=function(e,t){var n=r(e),i=r(t);return n.getTime()-i.getTime()}},2907:function(e,t,n){var r=n(2797),i=36e5;e.exports=function(e,t){var n=r(e,t)/i;return n>0?Math.floor(n):Math.ceil(n)}},3025:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(function(e,t,n,r){return void 0===r&&(r=!0),{rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}}))},3182:function(e,t,n){"use strict";var r=n(1183),i=n(275);t.a=Object(i.select)({tableViews:function(){return r.Y.tableViews}})((function(e,t,n){var r=n.tableViews,i=[];return r.forEach((function(n){if(n.tableQuery.folderId==e||t&&1==n.tableQuery.type)i.push(n);else if(t){var r=n.tableQuery.scenarioType;"category"!==r&&"persona"!==r&&"privatedistributionlist"!==r||i.push(n)}})),i}))},3291:function(e,t,n){"use strict";var r=n(4552),i=n(6718),a=n(0),o=n(5115),c=n(1454),u=n(3);Object(u.orchestrator)(c.d,(function(e){return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.searchTableQuery,n=e.searchEndToEndPerformanceDatapoint,i=e.actionSource,[4,Object(r.a)(t,n,i)];case 1:return a.sent(),n.end(),Object(o.a)(t),[2]}}))}))}));var l=n(1197);var d=n(1900),s=n(3287),f=n(9198),b=n(1200),v=n(1484),m=function(e){var t=e.actionSource,n=e.row,i=e.searchTableQuery,o=e.referenceId,c=e.traceId,u=e.itemPartId,m=Object(d.c)(i);s.a.clear(m),s.a.addRow(0,n,m),Object(r.a)(i,null,t);var O={referenceKey:o,index:0,traceId:c};if(Object(f.a)(n.InstanceKey,m,O),Object(v.p)(m,m.rowKeys[0],!1,b.b.SearchSuggestionClick),0==i.listViewType&&u){var p=function(e,t){var n,r,i,o;if(l.a.conversations.has(e)){var c=l.a.conversations.get(e);try{for(var u=Object(a.__values)(c.conversationNodeIds),d=u.next();!d.done;d=u.next()){var s=d.value,f=l.a.conversationNodes.get(s);try{for(var b=(i=void 0,Object(a.__values)(f.itemIds)),v=b.next();!v.done;v=b.next()){if(v.value==t)return s}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}return null}(n.ConversationId.Id,u),y=Object(l.b)().conversations.get(n.ConversationId.Id),j=y?y.conversationNodeIds:[];Object(v.a)(p,u,j,m,b.b.MailListItemExpansion)}},O=(Object(u.orchestrator)(c.c,(function(e){m(e)})),n(2227)),p=n(1885),y=n(5473),j=n(1437);Object(u.orchestrator)(d.e,(function(e){var t=e.focusedViewFilter;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){var e,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return e=Object(p.a)(),Object(y.d)(t,"NonUserAction"),n=Object(O.a)(e.tableQuery.folderId,e.tableQuery.listViewType,"mail",t,null,null,null,0===t?1:5),[4,Object(r.a)(n)];case 1:return i=a.sent(),j.b.importAndExecute(),[2,i]}}))}))}));var w=n(6719),I=n(1748);Object(u.orchestrator)(I.a,(function(){w.d.import()}));var g=n(5116),h=n(69);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return i.b}));var k=new h.c((function(){return n.e(1194).then(n.bind(null,16684))}));Object(h.f)(g.a,k,(function(e){return e.onListViewTypeOptionSavedOrchestrator}))},3992:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("INIT_TABLE_SELECTION_ON_LOAD",(function(e){return{tableView:e}}))},4304:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_CONVERSATIONS_PINNED_STORE_UPDATE",(function(e,t,n){return{rowKeys:e,tableViewId:t,shouldMarkAsPinned:n}}))},4305:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ITEMS_PINNED_STORE_UPDATE",(function(e,t,n){return{rowKeys:e,tableViewId:t,shouldMarkAsPinned:n}}))},4312:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return s}));var r=n(2462),i=n(2227),a=n(1183),o=n(1190),c=n(2327);function u(){var e=Object(o.a)("inbox"),t=Object(a.B)(e),n=Object(r.a)(e);return Object(i.a)(e,t,"mail",-1,null,null,n,0)}function l(){var e=u();return e.focusedViewFilter=0,e.inboxClassificationFilter=1,e}function d(){var e=u();return e.focusedViewFilter=1,e.inboxClassificationFilter=5,e}function s(){return Object(c.a)()?l():u()}},4552:function(e,t,n){"use strict";var r=n(0),i=n(1900),a=n(6718),o=n(6719),c=n(1316),u=n(2696),l=n(2344),d=n(10524),s=n(5023),f=n(269),b=n(3992),v=n(2992),m=n(5504),O=n(1183);function p(e,t,n){e.currentLoadedIndex=Math.min(i.b,e.rowKeys.length),Object(b.a)(e);var r=0==e.tableQuery.type;Object(m.b)(e);var a=e.tableQuery.scenarioType;if(r){var o=Object(f.r)((function(e){return"SwitchMailFolder"==e.eventName}));o&&(o.addCustomProperty("isCached",e.isInitialLoadComplete),o.addCustomProperty("scenario",a))}if(r&&e.isInitialLoadComplete&&Object(O.U)(e.tableQuery.folderId))return Promise.resolve();var c="spotlight"===a?v.f.importAndExecute(e,t,n):Object(s.a)(e,!1,t);return e.isInitialLoadComplete?Promise.resolve():c}var y=n(1504);var j=n(5113),w=n(1885),I=n(6645),g=n(275),h=n(1862),k=n(1689);var T=n(1484),N=n(1200);t.a=Object(g.action)("loadTableViewFromTableQuery")(Object(g.select)({listViewStore:function(){return O.Y}})((function(e,t,n,s){var b=Object(w.a)(),v=Object(i.c)(e);e=v.tableQuery,s.listViewStore.selectedTableViewId=v.id;var m,O=[];switch(b&&(O=Object(r.__spread)(b.selectedRowKeys.keys()),function(e,t){I.a.clear(),Object(T.i)(e,N.b.Reset)}(b)),e.type){case 1:m=o.d.importAndExecute(v,a.a,j.a,n,t);break;case 2:m=function(e,t,n){var r=Object(f.r)((function(e){return e.eventName==y.j||e.eventName==y.k})),i=u.a.navigationButtonSelected;if(r){r.addCustomProperty("GroupModule",l.a[i]);var a=Object(c.b)(e.tableQuery);if(Object(d.d)(a)){var o=Object(d.a)();r.addCustomProperty("TimeSinceWarmUp",Date.now()-o)}}var s=Promise.resolve();return i===l.a.Email&&(s=p(e,t,n)),s}(v,a.a,n);break;case 0:m=p(v,a.a,n);break;default:throw new Error("Only Folder, Group or Search Table types are supported in Table Loading")}return b&&function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 0===t.tableQuery.type&&k.a.clearMapForFolder(t.serverFolderId),[4,h.e.import()];case 1:return r.sent()(e,t,n),1===t.tableQuery.type&&t.id!==n.id&&(i=Object(f.r)(),Object(o.a)(t,i)),[2]}}))}))}(O,b,v),m})))},5023:function(e,t,n){"use strict";var r=n(3765),i=n(5113),a=n(1183),o=n(1402),c=n(2045),u=n(1900),l=n(84),d=n(2274),s=n(3027),f=n(3766),b=n(532),v=n(5600);function m(e,t,n){return Object(l.i)("mon-conv-useGqlForFindConv")?function(e,t,n){var r,l=e.tableQuery,s=Object(a.j)(e,!0),f=null===(r=s)||void 0===r?void 0:r.Id,m=l.viewFilter&&"All"!==l.viewFilter,O=a.c.getDefaultSortBy(),p=O.sortColumn,y=O.sortDirection,j=l.sortBy&&(l.sortBy.sortColumn!==p||l.sortBy.sortDirection!==y);return Object(d.f)(l.folderId,u.a,l.viewFilter,l.sortBy,Object(c.l)(l),l.focusedViewFilter,l.requestShapeName,Object(o.e)(l),void 0,l.categoryName,f,{datapoint:{customData:{scenarioType:l.scenarioType,isPrefetch:t,isFilter:m,isSort:j}}},l.shouldTryToUseSessionDataResponse).then((function(r){var a=[];return r.edges&&(a=r.edges.map((function(e){return e.node}))),Object(i.a)(e,a,r.totalConversationRowsInView,r.searchFolderId?Object(b.a)({Id:r.searchFolderId}):null,r.folderId?Object(b.a)({Id:r.folderId}):null),n(e,!0,"200",t),Promise.resolve()})).catch((function(r){var i=Object(v.a)(r);return n(e,!1,i,t),Promise.reject(r)}))}(e,t,n):function(e,t,n){var c=e.tableQuery,b=c.viewFilter&&"All"!==c.viewFilter,v=a.c.getDefaultSortBy(),m=v.sortColumn,O=v.sortDirection,p=c.sortBy&&(c.sortBy.sortColumn!==m||c.sortBy.sortDirection!==O),y=Object(o.d)(c).requestOptions;y&&(y.datapoint={customData:{scenarioType:c.scenarioType,isPrefetch:t,isFilter:b,isSort:p,isRoamingFavoritesEnabled:Object(l.i)("tri-favorites-roaming")}});var j=Object(d.i)(e);return function(e,t,n,r){return e.then((function(e){var a=Promise.resolve(),o=e.findConversationResponseMessage,c="Success"==o.ResponseClass;if(c)Object(i.a)(t,o.Conversations,o.TotalConversationsInView,o.SearchFolderId,o.FolderId);else{var u=new Error("ResponseCode="+o.ResponseCode);u.fetchErrorType="ServerFailure",u.response=new Response(void 0,e.responseInit),a=Promise.reject(u)}return n(t,c,o.ResponseCode,r),a}),(function(e){var i,a=(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.status)||"";return n(t,!1,a,r),Promise.reject(e)}))}(Object(d.c)(Object(a.i)(c),0,u.a,c.viewFilter,Object(r.a)(c),c.focusedViewFilter,c.requestShapeName,c.shouldTryToUseSessionDataResponse,y,c.categoryName,Object(f.a)(c.inboxClassificationFilter),Object(s.a)(c.inboxClassificationFilter),Object(a.j)(e,!0),j,j),e,n,t)}(e,t,n)}var O=n(4311);var p=n(52),y=n(3);function j(e,t,n){switch(w(e),e.tableQuery.listViewType){case 0:return m(e,t,n);case 1:return function(e,t,n){var r=e.tableQuery;return Object(d.e)(Object(a.i)(r),0,u.a,r.viewFilter,Object(O.a)(r),r.focusedViewFilter,r.requestShapeName,r.shouldTryToUseSessionDataResponse,Object(o.f)(r,!0),r.categoryName,Object(f.a)(r.inboxClassificationFilter),Object(s.a)(r.inboxClassificationFilter),Object(a.j)(e,!0)).then((function(r){var a=Promise.resolve(),o="Success"==r.ResponseClass;if(o)Object(i.a)(e,r.RootFolder.Items,r.RootFolder.TotalItemsInView,r.SearchFolderId,null);else{var c=new Error("ResponseCode="+r.ResponseCode+", Stacktrace="+r.StackTrace);c.fetchErrorType="ServerFailure",a=Promise.reject(c)}return n(e,o,r.ResponseCode,t),a}),(function(r){var i,a=(null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.status)||"";return n(e,!1,a,t),Promise.reject(r)}))}(e,t,n);default:return p.g.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}n.d(t,"a",(function(){return j}));var w=Object(y.mutatorAction)("setTableViewLoading",(function(e){e.isLoading=!0,e.loadErrorStatus=0}))},5113:function(e,t,n){"use strict";var r=n(1900),i=n(2045),a=n(1183),o=n(275);t.a=Object(o.action)("onLoadInitialRowsSucceeded")((function(e,t,n,o,c){2==e.tableQuery.type&&c&&(e.serverFolderId=c.Id),o&&(e.serverFolderId=o.Id);var u=Object(a.e)(e);Object(i.h)(t,e,n,u,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},5114:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",(function(e){return{tableView:e}}))},5115:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("ON_MAIL_SEARCH_COMPLETE",(function(e){return{searchTableQuery:e}}))},5116:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("ON_LIST_VIEW_TYPE_OPTION_SAVED",(function(e){return{newListViewType:e}}))},5473:function(e,t,n){"use strict";var r=n(11),i=n(3),a=Object(i.createStore)("focusedInboxRollupStore",{uniqueSenders:null,unseenCountToDisplay:null,viewType:0})(),o=n(1183),c=n(532),u=n(1267),l=n(29),d=n(52),s=n(275),f=n(10537),b=10;var v=99,m=Object(s.action)("getFolderChangeDigestAction")((function(e){var t=0==e.focusedViewFilter,n=t?1:2,i=t?Object(l.a)().ViewStateConfiguration.FocusedViewWatermark:Object(l.a)().ViewStateConfiguration.ClutterViewWatermark;a.viewType=n,function(e,t,n,r){var i={Folders:[{FolderId:e,IsConversationView:r,ViewType:t,Watermark:n}],MaxSendersCount:b};return Object(f.a)(i).then((function(e){return e}))}(Object(u.a)({BaseFolderId:Object(c.a)({Id:e.folderId})}),n,i,0==Object(o.B)(e.folderId)).then((function(e){return function(e){if(null==e.Folders||0==e.Folders.length)return void d.g.info("GetFolderChangeDigestResponse.Folders is null or empty");var t=e.Folders[0],n=t.RecentUniqueSenders||[];a.uniqueSenders=n.join("; ").toString(),a.unseenCountToDisplay=function(e){if(0===e)return null;if(e>v)return Object(r.c)("{0}+",v);return e.toString()}(t.UnseenCount)}(e)}))}));var O=n(10645);function p(e,t){var n,i=Object(o.B)(t);switch(e){case 1:n=0==i?Object(r.b)(O.a):Object(r.b)(O.b);break;case 2:n=0==i?Object(r.b)(O.c):Object(r.b)(O.d)}return n}var y=n(357),j=n(61),w=Object(i.action)("updateWatermarkAndResetRollup",(function(e,t){return Object(j.c)({name:"TnS_ResetFocusedOtherRollup",customData:[t,e]},{focusedViewFilter:e})}));Object(i.orchestrator)(w,(function(e){var t=e.focusedViewFilter,n=new Date(Date.now()).toUTCString();0==t?Object(y.a)((function(e){e.ViewStateConfiguration.FocusedViewWatermark=n}),[{key:"FocusedViewWatermark",valuetype:"String",value:[n]}],"OWA.ViewStateConfiguration"):1==t&&Object(y.a)((function(e){e.ViewStateConfiguration.ClutterViewWatermark=n}),[{key:"ClutterViewWatermark",valuetype:"String",value:[n]}],"OWA.ViewStateConfiguration")})),Object(i.mutator)(w,(function(){a.uniqueSenders=null,a.unseenCountToDisplay=null,a.viewType=0}));var I=w;n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return a}))},5504:function(e,t,n){"use strict";var r=n(10461),i=n(9007),a=5,o=[];function c(e){o.unshift(e.id),Object(i.a)(e),function(){if(o.length>a)for(var e=a;e<o.length;e++)u(o[e])}()}function u(e){var t=o.indexOf(e);if(-1==t)throw new Error("TableViewId should be present in the mru list when remove is called");o.splice(t,1),Object(r.a)(e)}function l(e){var t=o.indexOf(e.id);switch(t){case-1:c(e);break;case 0:break;default:!function(e){var t=e.id;o.splice(o.indexOf(t),1),o.unshift(t)}(e)}return t}var d=n(9090),s=n(2462),f=n(1190),b=n(1183);function v(e){if(1==e.tableQuery.type)throw new Error("updateTablesInCache should never be called for Search table");var t=e.tableQuery;if(e.tableQuery.folderId===Object(f.a)("inbox")&&"All"===Object(b.P)(e)&&function(e){var t=Object(b.u)(e.id);return 0===t||1===t||5===t}(e)&&"spotlight"!==t.scenarioType){var n=t.sortBy.sortColumn,r=t.sortBy.sortDirection,i=Object(s.a)(e.tableQuery.folderId);if(n===i.sortColumn&&r===i.sortDirection)return Object(d.a)(),0}return l(e)}function m(){Object(d.a)()}function O(){return o.length<a}function p(e){u(e)}n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"d",(function(){return p}))},5594:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ROW_UPDATED",(function(e,t){return{rowKey:e,tableView:t}}))},5601:function(e,t,n){"use strict";function r(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return r}))},6645:function(e,t,n){"use strict";var r=n(433),i=n(69),a=new i.c((function(){return Promise.all([n.e(1),n.e(810)]).then(n.bind(null,16114))})),o=new i.a(a,(function(e){return e.downloadPersonaPhoto})),c=n(1189),u=n(1343),l=new r.a(3,(function(e){var t=Object(u.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=c.a.viewStates.get(t);return o.importAndExecute(n,!1,e.skipLoadingPhoto)}),500);t.a=l},6710:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(69),i=new r.c((function(){return n.e(772).then(n.bind(null,16007))})),a=new r.a(i,(function(e){return e.prefetchRowInCache})),o=new r.a(i,(function(e){return e.prefetchSingleRow})),c=new r.a(i,(function(e){return e.prefetchFirstN})),u=new r.a(i,(function(e){return e.prefetchAdjacentRowsOnDelay}))},6718:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(3992),i=n(1183),a=n(1900),o=n(6710),c=n(275);t.a=Object(c.action)("onInitialTableLoadComplete")((function(e,t,n,c){if(e.isLoading=!1,e.isInitialLoadComplete=!0,!c)if(t){e.loadErrorStatus=0;var l=e.selectedRowKeys.size>0;0!=e.tableQuery.type&&2!=e.tableQuery.type||(l||e!=Object(i.H)()||Object(r.a)(e),o.b.importAndExecute(e,10)),Object(a.d)(e)}else u(e,n)}));var u=Object(c.action)("setTableViewErrorState")((function(e,t){switch(t){case"ErrorAccessDenied":e.loadErrorStatus=1;break;case"UnexpectedClientError":e.loadErrorStatus=2;break;default:e.loadErrorStatus=3}}))},6719:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(69),i=new r.c((function(){return Promise.all([n.e(38),n.e(37),n.e(44),n.e(51),n.e(669)]).then(n.bind(null,15984))})),a=new r.a(i,(function(e){return e.loadSearchTable})),o=new r.a(i,(function(e){return e.cleanSearchTableState})).importAndExecute,c=new r.b(i,(function(e){return e.loadMoreFindItemSearch})),u=new r.b(i,(function(e){return e.loadMoreSubstrateSearch}))},6720:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(2438),i=n(1183),a=n(2045);function o(e,t,n,r){var o=new Date(i.b.getLastDeliveryTimeStamp(n,r)).getTime()-new Date(t).getTime();if(Object(a.l)(r.tableQuery)){var c=new Date(i.b.getLastDeliveryOrRenewTimeStamp(n,r)).getTime()-new Date(e).getTime();return 0!=c?c:o}return o}function c(e,t,n,i,o){return Object(r.a)(o,n.id,e)?Object(a.f)(n,0):u(e,t,n,i)}function u(e,t,n,a){var c=n.rowKeys.length;if(0==c)return 0;var u,l=Object(i.J)(n).sortDirection==i.c.DESCENDING_SORT_DIR;for(u=a;u<c;u++){var d=n.rowKeys[u];if(!Object(r.a)(d,n.id,e)){var s=o(e,t,d,n);if(l?s<=0:s>0)return u}}return c==n.totalRowsInView?c:-1}},6721:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateCategoriesInView",(function(e,t){return{modifiedCategoryName:e,newCategoryName:t}}))},6722:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(function(e,t){return{tableViewId:e,currentLoadedIndexToSet:t}}))},6723:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("CONVERSATION_CATEGORIES_STORE_UPDATE",(function(e,t,n,r,i){return{conversationRowKeys:e,tableViewId:t,categoriesToAdd:n,categoriesToRemove:r,clearCategories:i}}))},6724:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ITEMS_CATEGORIES_STORE_UPDATE",(function(e,t,n,r){return{itemIds:e,categoriesToAdd:t,categoriesToRemove:n,clearCategories:r}}))},7475:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("DELETE_FOLDER_STORE_UPDATE",(function(e){return{folderIds:e}}))},9007:function(e,t,n){"use strict";var r=n(0),i=n(5601),a=n(9),o=n(2086),c=n(3025),u=n(5594),l=n(5473),d=n(1183),s=n(275),f=Object(s.action)("updateRollupOnAddOrUpdateRowNotification")((function(e){var t=Object(d.H)();if(null!=t){var n=Object(d.l)(e),r=Object(d.l)(t);(0==n&&1==r||1==n&&0==r)&&Object(l.b)(e.tableQuery)}})),b=n(2045),v=n(3287),m=n(6710),O=n(6720);var p=Object(s.action)("rowNotificationHandler.onAddOrUpdateRow")((function(e,t){var n=e.InstanceKey;if(!n)throw new Error("onAddOrUpdateNotification: Row instanceKey should not be null");if(Object(b.k)(e,t)){var r=Object(b.e)(e,t.tableQuery.listViewType),l=r.lastDeliveryOrRenewTimeStamp,s=r.lastDeliveryTimeStamp,p=Object(O.b)(l,s,t,0,n),y=Object(i.a)(n,t),j=y>=0;-1!=p?Object(d.U)(t.tableQuery.folderId)&&Object(a.Eb)(Object(a.lc)(s),d.Y.inboxPausedDateTime)||(j?(y<p&&p--,function(e,t,n){Object(b.g)(e,t)?(v.a.updateRowData(e,t),Object(d.ab)(t,4)):(v.a.updateRow(n,e,t,"RowUpdateNotification"),Object(d.ab)(t,2)),Object(u.a)(e.InstanceKey,t)}(e,t,p)):function(e,t,n){v.a.addRow(n,e,t,"RowAddNotification"),Object(d.ab)(t,1),t.currentLoadedIndex++}(e,t,p),m.d.importAndExecute(n,t,!0),-1==Object(d.l)(t)||Object(o.b)()||f(t),Object(b.d)(t)):j&&Object(c.a)([n],t,"UpdateNotification")}})),y=n(5060),j=n(3),w=Object(j.action)("TRY_REMOVE_ITEM_NORMALIZED_BODY",(function(e){return{item:e}})),I=n(1689),g=n(1200),h=n(1485),k=n(1705),T=n(1383),N=n(52),S=Object(s.select)({tableView:function(e){return T.a.tableViews.get(e.id)}})(Object(s.action)("handleRowNotification")((function(e,t){var n,r=t.tableView;if(r)if(r.isInitialLoadComplete)switch(e.EventType){case"RowAdded":n=C(e,r),F(n,r);break;case"RowModified":n=C(e,r),R(n,r);break;case"RowDeleted":n=C(e,r),V(n,r);break;case"QueryResultChanged":case"Reload":E(r);break;default:return}else N.g.info("Ignore row notifications as table has not loaded");else N.g.info("Received row notification for a deleted folder")})));function C(e,t){switch(t.tableQuery.listViewType){case 0:return e.Conversation?e.Conversation:(N.d("Conversation should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);case 1:return e.Item?e.Item:(N.d("Item should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);default:return N.d("rowNotificationStrategy: unsupported listViewType: "+t.tableQuery.listViewType),null}}var F=Object(s.action)("rowNotificationHandler.onAddRow")((function(e,t){Object(d.U)(t.tableQuery.folderId)||t.totalRowsInView++,p(e,t)})),R=Object(s.action)("rowNotificationHandler.onUpdateRow")((function(e,t){p(e,t)})),V=Object(s.action)("rowNotificationHandler.onDeleteRow")((function(e,t){var n=e.InstanceKey;if(!n)throw new Error("onDeleteNotification: Row instanceKey should not be null");(t.totalRowsInView--,Object(b.j)(e,t))&&(Object(i.a)(n,t)>=0&&(Object(c.a)([n],t,"DeleteNotification"),Object(d.ab)(t,3)))})),E=Object(s.select)({conversations:function(){return h.a},items:function(){return g.u.items}})(Object(s.action)("rowNotificationHandler.onReload")((function(e,t){!function(e,t){var n,i;switch(e.tableQuery.listViewType){case 0:t.conversations.clear();for(var a=t.conversations.getItemIds(),o=0,c=a.length;o<c;o++){var u=a[o];if(t.conversations.has(u)){var l=t.conversations.get(u);m.c.importAndExecute(l.conversationId,e)}}break;case 1:try{for(var s=Object(r.__values)(e.rowKeys),f=s.next();!f.done;f=s.next()){var b=f.value,v=d.b.getRowClientItemId(b,e),O=t.items.get(v.Id);w(O),t.items.get(v.Id).NormalizedBody&&m.c.importAndExecute(v,e)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}}(e,t),Object(y.a)(e),I.a.clearMapForFolder(e.serverFolderId)})));Object(j.mutator)(w,(function(e){var t=e.item;Object(k.d)(t.ConversationId.Id,0)||Object(k.e)(t.ItemId.Id,0)||(t.NormalizedBody=void 0)}));var D=n(1185),x=n(1193),A=n(4664),_=n(3027),P=n(3766),U=n(3765),Q=n(4311),L=n(1360),B=n(7473),M={kind:"Document",definitions:Object(r.__spread)([{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToRowNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listViewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReactListViewType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TableQueryType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToRowNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"listViewType"},value:{kind:"Variable",name:{kind:"Name",value:"listViewType"}}},{kind:"ObjectField",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoryName"},value:{kind:"Variable",name:{kind:"Name",value:"categoryName"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"EventType"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationChangePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"},directives:[]}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationDeletePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"},arguments:[],directives:[]}]}}]}}]}}]}}],B.a.definitions)},K=n(543),G=n(84),q=n(1402),$=n(1225);var W={};function z(e){var t=W[e];if(t){var n=Object(d.K)().tableViews.get(e);Object(G.i)("mon-conv-useGqlForConvSubscription")&&n&&0==n.tableQuery.listViewType?function(e){e.unsubscribe()}(t):L.g.importAndExecute(t,S),delete W[e]}}function H(e){if(!W[e.id]){if(0!=e.tableQuery.type&&2!=e.tableQuery.type)throw new Error("subscribeToRowNotifications should only be called for Folder or Group table type");var t=e.tableQuery;1!=t.sortBy.sortColumn||Object(g.m)(e.tableQuery.folderId)||Object(D.C)(e.tableQuery.folderId,x.k)||"spotlight"!==t.scenarioType&&(Object(G.i)("mon-conv-useGqlForFindConv")&&Object(G.i)("mon-conv-useGqlForConvSubscription")&&0==t.listViewType?function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.tableQuery,[4,Object(K.a)()];case 1:return n=r.sent(),i=n.subscribe({query:M,variables:{subscriptionId:e.id,folderId:e.tableQuery.folderId,listViewType:Object(d.q)(t.listViewType),type:Object(d.s)(e.tableQuery.type),categoryName:t.categoryName,focusedViewFilter:Object(d.p)(t.focusedViewFilter),viewFilter:Object(d.t)(t.viewFilter),sortBy:{sortColumn:Object(d.r)(t.sortBy.sortColumn),sortDirection:t.sortBy.sortDirection,canSortByRenewTime:Object(b.l)(t)},shapeName:A.c(e.tableQuery.folderId,Object(d.S)(t.scenarioType)),isScheduledFolder:"scheduled"==Object($.a)(e.tableQuery.folderId),mailboxInfo:Object(q.e)(t)},context:{attemptToUseHxResolver:Object(G.i)("mon-conv-useHxForConvListViewLoad")}}),[2,i.subscribe({next:function(e){return S(e.data.subscribeToRowNotifications)},error:function(e){N.g.info("Row notification error "+e)}})]}}))}))}(e).then((function(t){W[e.id]=t})):L.b.import().then((function(n){var r={NotificationType:"RowNotification",FolderId:Y(e),FocusedViewFilter:t.focusedViewFilter,HashtagsToInclude:Object(P.a)(t.inboxClassificationFilter),HashtagsToExclude:Object(_.a)(t.inboxClassificationFilter),IsConversation:0==t.listViewType,CategoryFilter:t.categoryName,Filter:t.viewFilter,ChannelId:n(),MailboxId:J(e)};!0===r.IsConversation?(r.ConversationShapeName=A.c(e.tableQuery.folderId,Object(d.S)(t.scenarioType)),r.ConversationResponseShape=A.b(e.tableQuery.folderId),r.SortBy=Object(U.a)(t)):r.SortBy=Object(Q.a)(t);var i={subscriptionId:e.id,requiresExplicitSubscribe:!0,subscriptionParameters:r};L.f.importAndExecute(i,S),W[e.id]=i})))}}function Y(e){return 0==e.tableQuery.type?e.tableQuery.folderId:null}function J(e){return 2==e.tableQuery.type?e.tableQuery.folderId:null}n.d(t,"a",(function(){return H})),n.d(t,"b",(function(){return z}))},9039:function(e,t,n){"use strict";var r=n(69),i=n(5114),a=n(1689),o=n(1565);function c(e){var t;if(Object(o.c)(e.serverFolderId,o.b.Running))return!1;if(e.currentLoadedIndex<e.rowKeys.length)return!0;if("spotlight"===(null===(t=null==e?void 0:e.tableQuery)||void 0===t?void 0:t.scenarioType))return!1;var n=a.a.getCount(e.serverFolderId,3);return e.rowKeys.length>0&&e.rowKeys.length<e.totalRowsInView-n}var u=n(1900);function l(e){(function(e){return e.rowKeys.length<u.a&&!e.isLoading&&c(e)})(e)&&f.importAndExecute(e)}var d=n(3);Object(d.orchestrator)(u.d,(function(e){var t=e.tableView;t&&c(t)&&f.import().then((function(e){c(t)&&e(t)}))})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return l}));var s=new r.c((function(){return n.e(1151).then(n.bind(null,16402))}));Object(r.f)(i.a,s,(function(e){return e.reloadTableOnTriageActionFailOrchestrator}));var f=new r.a(s,(function(e){return e.loadMoreInTable})),b=new r.a(s,(function(e){return e.reloadInboxPostBoot}))},9090:function(e,t,n){"use strict";var r=n(10461),i=n(9007),a=n(1900),o=[];function c(e,t){if(-1===l(e)){o.push(e);var n=Object(a.c)(t);Object(i.a)(n)}}function u(e,t){var n=l(e);if(-1!==n){o.splice(n,1);var i=Object(a.c)(t,!0);i&&Object(r.a)(i.id)}}function l(e){return o.indexOf(e)}var d=n(5473),s=n(2327),f=n(4312),b=n(2086);n.d(t,"a",(function(){return p}));var v="FOCUSED",m="OTHER",O="ALL";function p(){var e=Object(f.c)(),t=Object(f.b)(),n=Object(f.d)();Object(s.a)()?(c(v,t),c(m,n),u(O,e),Object(b.b)()||Object(d.b)(n)):(u(v,t),u(m,n),c(O,e))}},9200:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),i=n(9039),a=n(1484),o=n(1183),c=n(3287),u=n(1190),l=n(6722),d=n(2904),s=n(1953),f=n(2064);function b(e,t,n){var b,v;void 0===n&&(n="LocalUpdate");var m=-1,O=!1;try{for(var p=Object(r.__values)(e),y=p.next();!y.done;y=p.next()){var j=y.value;t.selectedRowKeys.has(j)&&(m=t.rowKeys.indexOf(j))>-1&&(O=o.b.getIsPinned(t.rowKeys[m],t)),c.a.removeRow(j,t,n)}}catch(e){b={error:e}}finally{try{y&&!y.done&&(v=p.return)&&v.call(p)}finally{if(b)throw b.error}}Object(l.a)(t.id,Math.min(t.currentLoadedIndex,t.rowKeys.length)),t.id===Object(d.a)()&&(Object(i.d)(t),m>-1&&t.tableQuery.folderId!=Object(u.a)("junkemail")&&t.rowKeys.length>0?Object(a.k)(t,m,O):Object(f.a)()&&Object(s.a)())}}}]);
//# sourceMappingURL=owa.74.js.map
self.scriptsLoaded['owa.74.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.74.js'] = (new Date()).getTime();