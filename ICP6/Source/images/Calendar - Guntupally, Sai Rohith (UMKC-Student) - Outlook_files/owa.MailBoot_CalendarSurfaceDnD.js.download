self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarSurfaceDnD.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[465],{16523:function(n,e,t){"use strict";t.r(e);var r=t(3),o=Object(r.action)("onCalendarEventDropped",(function(n,e){return{droppedItem:n,originalItem:e}})),u=t(61),c=Object(r.action)("onTodoItemDropped",(function(n,e){return Object(u.c)({name:"todoItemActionDragToCalendar"},{droppedItem:n,dragInfo:e})})),i=t(9),a=t(1192),l=t(3322),d=t(1386),b=(Object(r.orchestrator)(o,(function(n){var e=n.droppedItem,t={ItemId:e.ItemId,Start:e.Start,End:e.End,IsAllDayEvent:e.IsAllDayEvent};0===Object(i.p)(e.Start,n.originalItem.Start)&&0===Object(i.p)(e.End,n.originalItem.End)&&e.IsAllDayEvent==n.originalItem.IsAllDayEvent||(Object(a.D)(e)?(e.IsAllDayEvent&&(t.End=Object(i.e)(t.End,-1)),l.f.importAndExecute(t,n.originalItem)):Object(d.k)(e,t,"Surface"))})),t(3580));Object(r.orchestrator)(c,(function(n){var e=n.dragInfo,t=Object(b.a)({IsAllDayEvent:n.droppedItem.IsAllDayEvent,Start:n.droppedItem.Start,End:n.droppedItem.End,Subject:e.subjects[0],CharmId:55});return new Promise((function(n,e){return Object(d.f)(t,"Surface",n,e)}))}));t.d(e,"onCalendarEventDropped",(function(){return o})),t.d(e,"onTodoItemDropped",(function(){return c}))},188:function(n,e,t){"use strict";var r=t(69),o=t(609),u=t(610),c=t(416);function i(){return Object(c.a)().endShortEventsBy}function a(){return Object(c.a)().endLongEventsBy}var l=t(611),d=t(608),b=t(727),s=t(612),f=t(613),O=t(84),j=5;function I(){if(!Object(O.i)("cal-mf-shouldEventsEndEarlySetting")&&!Object(O.i)("cal-mf-shortenEventsDuration"))return 0;var n=i();return null!=n?n:j}var v=10;function g(){if(!Object(O.i)("cal-mf-shouldEventsEndEarlySetting")&&!Object(O.i)("cal-mf-shortenEventsDuration"))return 0;var n=a();return null!=n?n:v}var m=t(728),S=t(457);t.d(e,"o",(function(){return E})),t.d(e,"n",(function(){return p})),t.d(e,"m",(function(){return o.a})),t.d(e,"l",(function(){return u.a})),t.d(e,"k",(function(){return i})),t.d(e,"j",(function(){return a})),t.d(e,"i",(function(){return l.a})),t.d(e,"e",(function(){return d.a})),t.d(e,"f",(function(){return b.a})),t.d(e,"g",(function(){return s.a})),t.d(e,"h",(function(){return f.a})),t.d(e,"c",(function(){return I})),t.d(e,"b",(function(){return g})),t.d(e,"d",(function(){return m.a})),t.d(e,"a",(function(){return S.a}));var h=new r.c((function(){return t.e(450).then(t.bind(null,16418))})),E=new r.a(h,(function(n){return n.saveCalendarCloudSettings})),p=new r.a(h,(function(n){return n.initCalendarCloudSettings}))},2477:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(29),o=15,u=420;function c(n){if(n)return u;var e=Object(r.a)();return e?e.UserOptions.DefaultReminderTimeInMinutes:o}},3580:function(n,e,t){"use strict";t.d(e,"a",(function(){return b}));var r=t(0),o=t(2477),u=t(4763),c=t(9),i=t(1216),a=t(527),l=t(743),d=15;function b(n,e){var t,b,s,f=Object(l.a)(),O=d,j=!1,I=!e;if(n?(n.IsAllDayEvent?(t=n.Start||Object(c.Wb)(Object(c.Pb)()),b=n.End||Object(c.Wb)(Object(c.e)(Object(c.Pb)(),1)),I=!1):(t=n.Start||Object(c.f)(Object(c.Xb)(Object(c.Pb)()),1),b=n.End||Object(c.h)(t,f)),O=n.ReminderMinutesBeforeStart||Object(o.a)(n.IsAllDayEvent),n.ParentFolderId||(s=Object(u.a)()),j=n.IsOnlineMeeting):(t=Object(c.f)(Object(c.Xb)(Object(c.Pb)()),1),b=Object(c.h)(t,f),s=Object(u.a)(),O=Object(o.a)(!1)),I){var v=Object(a.g)(t,b);t=v.start,b=v.end}var g={ItemId:null,ParentFolderId:s,Subject:null,ReminderIsSet:-1!=O,ReminderMinutesBeforeStart:O,LastModifiedTime:null,InstanceKey:null,Preview:null,__type:null,Start:t,StartTimeZoneId:t.tz,End:b,EndTimeZoneId:b.tz,IsAllDayEvent:!1,IsRoomRequested:!1,AutoRoomBookingStatus:void 0,IsDraft:!1,FreeBusyType:"Busy",IsMeeting:!1,IsCancelled:!1,IsRecurring:!1,IsResponseRequested:!0,CalendarItemType:"Single",ResponseType:null,Organizer:null,RequiredAttendees:null,OptionalAttendees:null,Resources:null,AppointmentReplyTime:null,Recurrence:null,Location:null,IntendedFreeBusyStatus:null,IsOrganizer:!0,AppointmentReplyName:null,IsSeriesCancelled:null,CharmId:Object(i.t)().IconId,Locations:null,ClientSeriesId:null,EffectiveRights:null,HasAttachments:!1,HasBlockedImages:!1,Attachments:null,Sensitivity:"Normal",Body:{Value:"",BodyType:"HTML"},EntityNamesMap:0,TailoredXpEntities:null,UID:null,ExperienceType:"Unspecified",DoNotForwardMeeting:!1,IsOnlineMeeting:j,JoinOnlineMeetingUrl:null,Categories:null,InboxReminders:null,MeetingRequestWasSent:null,ExtractionSourceId:null,OnlineMeetingProvider:null,OnlineMeetingJoinUrl:null,OnlineMeetingConferenceId:null,OnlineMeetingTollNumber:null,OnlineMeetingTollFreeNumbers:null,SeriesMasterItemId:null,ExtractionSourceInternetMessageId:null,PersonId:null,InReplyTo:null,HideAttendees:!1,IsFreeBusyOnly:null,MeetingNotesWebUrl:null,SkypeTeamsProperties:null,DocLinks:[],AppendOnSend:[],IsBookedFreeBlocks:!1,AssociatedTasks:[],CollabSpace:null};return n&&(g=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g),n),{Start:t,End:b}),n.FreeBusyType||(g.FreeBusyType=n.IsAllDayEvent?"Free":"Busy")),g}},3581:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(1561),o=t(179);function u(n){var e=Object(r.e)(n);return Object(o.z)(e)}},4763:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(287),o=t(179),u=t(3581),c=t(373);function i(){var n=Object(o.w)(),e=a(null==n?void 0:n.id.mailboxInfo.userIdentity);if(e)return e;var t=Object(c.i)();if(t){var u=a(t.userIdentity);if(u)return u}var i=null,l=Object(r.d)();return n&&(l=n.id.mailboxInfo,i=Object(o.r)(n)),{Id:i,mailboxInfo:l}}function a(n){var e=Object(o.w)(n),t=e?function(n){var e=Object(u.a)(n);return e?e.filter(o.N):null}(e.id.mailboxInfo.userIdentity):null,r=t?t.length:0,c=e;return t&&r>0?(c=t[r-1],e&&t.forEach((function(n){n.id.id==e.id.id&&(c=e)})),{Id:Object(o.r)(c),mailboxInfo:c.id.mailboxInfo}):null}},527:function(n,e,t){"use strict";var r=t(188);function o(n){return Object(r.f)()&&0!==n?n<60?Object(r.c)():Object(r.b)():0}var u=t(743);function c(){var n=Object(u.a)(),e=o(n);return Math.max(n-e,0)}var i,a=t(9);function l(n,e){if(!Object(r.g)())return e;var t=o(Object(a.x)(e,n)),u=t?Object(a.ec)(e,t):e;return Object(a.Gb)(n,u)?u:e}function d(n,e){if(!Object(r.h)())return n;var t=o(Object(a.x)(e,n)),u=t?Object(a.h)(n,t):n;return Object(a.Gb)(u,e)?u:n}function b(n,e){return{start:d(n,e),end:l(n,e)}}function s(n,e,t,o){var u=Object(a.x)(e,n),c=Object(a.x)(o,t),l=60-Object(r.b)();return 0===u&&0!==c&&c<l?i.ZeroToShort:0===u&&c>=l?i.ZeroToLong:0===c&&0!==u&&u<l?i.ShortToZero:0===c&&u>=l?i.LongToZero:u<l&&c<l||u>=l&&c>=l?i.None:u<l&&c>=l?i.ShortToLong:u>=l&&c<l?i.LongToShort:null}function f(n,e,t,o,u,c){if(!Object(r.h)())return t;var l=s(n,e,t,o),d=u?t:n,b=t;return l===i.ShortToLong?b=Object(a.h)(Object(a.ec)(d,Object(r.c)()),Object(r.b)()):l===i.LongToShort?b=Object(a.h)(Object(a.ec)(d,Object(r.b)()),Object(r.c)()):l!==i.ZeroToShort||c?l!==i.ZeroToLong||c||(b=Object(a.h)(d,Object(r.b)())):b=Object(a.h)(d,Object(r.c)()),Object(a.Gb)(b,o)?b:t}function O(n,e,t,o){if(!Object(r.g)())return o;var u=s(n,e,t,o),c=o;return u===i.ShortToLong?c=Object(a.ec)(Object(a.h)(o,Object(r.c)()),Object(r.b)()):u===i.LongToShort?c=Object(a.ec)(Object(a.h)(o,Object(r.b)()),Object(r.c)()):u===i.ZeroToShort?c=Object(a.ec)(o,Object(r.c)()):u===i.ZeroToLong&&(c=Object(a.ec)(o,Object(r.b)())),Object(a.Gb)(t,c)?c:o}function j(n,e){if(!Object(r.h)())return e;var t=Object(r.c)(),o=Object(r.b)();return n>=60-o?Object(a.h)(e,o):Object(a.h)(e,t)}function I(n,e,t,r){return Object(a.Hb)(e,r)?O(n,e,t,r):l(t,r)}function v(n,e,t,r){return Object(a.Hb)(n,t)?f(n,e,t,r):d(t,r)}function g(n,e,t,r){return{start:v(n,e,t,r),end:I(n,e,t,r)}}!function(n){n[n.None=0]="None",n[n.ShortToLong=1]="ShortToLong",n[n.LongToShort=2]="LongToShort",n[n.ZeroToShort=3]="ZeroToShort",n[n.ZeroToLong=4]="ZeroToLong",n[n.ShortToZero=5]="ShortToZero",n[n.LongToZero=6]="LongToZero"}(i||(i={})),t.d(e,"a",(function(){return c})),t.d(e,"b",(function(){return l})),t.d(e,"d",(function(){return d})),t.d(e,"g",(function(){return b})),t.d(e,"f",(function(){return f})),t.d(e,"c",(function(){return O})),t.d(e,"e",(function(){return j})),t.d(e,"h",(function(){return g}))},608:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(609),o=t(84),u=!1;function c(){if(!Object(o.i)("cal-mf-shouldEventsEndEarlySetting"))return!1;var n=Object(r.a)();return null!=n?n:u}},609:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(416);function o(){return Object(r.a)().shouldEventsEndEarly}},610:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(416);function o(){return Object(r.a)().shortenEventScope}},611:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(416);function o(){return Object(r.a)().enableOnlineMeetingsByDefault}},612:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(615),o=t(608),u=t(457);function c(){var n=Object(r.a)();return n?n===u.a.EndEarly:Object(o.a)()}},613:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(615),o=t(457);function u(){return Object(r.a)()===o.a.StartLate}},615:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(457),o=t(610),u=t(84),c=r.a.None;function i(){if(!Object(u.i)("cal-mf-shortenEventsDuration"))return null;var n=Object(o.a)();return null!=n?n:c}},727:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(612),o=t(613);function u(){return Object(o.a)()||Object(r.a)()}},728:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(611),o=t(84),u=!1;function c(){if(!Object(o.i)("cal-mf-enableDefaultOnlineMeetingSetting"))return!1;var n=Object(r.a)();return null!=n?n:u}}}]);
//# sourceMappingURL=owa.MailBoot~CalendarSurfaceDnD.js.map
self.scriptsLoaded['owa.MailBoot~CalendarSurfaceDnD.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarSurfaceDnD.js'] = (new Date()).getTime();