self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarQuickCompose~Editor~InboxForMeSurface.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[156],{1195:function(e,t,n){"use strict";n.d(t,"p",(function(){return a})),n.d(t,"x",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"s",(function(){return o})),n.d(t,"v",(function(){return s})),n.d(t,"w",(function(){return l})),n.d(t,"u",(function(){return f})),n.d(t,"t",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return b})),n.d(t,"h",(function(){return h})),n.d(t,"l",(function(){return m})),n.d(t,"y",(function(){return v})),n.d(t,"j",(function(){return M})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return C})),n.d(t,"a",(function(){return g})),n.d(t,"k",(function(){return x})),n.d(t,"o",(function(){return y})),n.d(t,"i",(function(){return w})),n.d(t,"b",(function(){return E})),n.d(t,"m",(function(){return A})),n.d(t,"c",(function(){return j})),n.d(t,"g",(function(){return T})),n.d(t,"n",(function(){return R}));var r=n(69),i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(5),n.e(7),n.e(16),n.e(20),n.e(25),n.e(43),n.e(78),n.e(116),n.e(120),n.e(145),n.e(191),n.e(418)]).then(n.bind(null,3437))})),a=new r.b(i,(function(e){return e.removeExtensibilityNotification})),c=new r.b(i,(function(e){return e.updatePersistentNotifications})),u=new r.b(i,(function(e){return e.closeTaskPaneAddinCommand})),o=new r.b(i,(function(e){return e.triggerAppointmentTimeChangedEvent})),s=new r.b(i,(function(e){return e.triggerRecipientsChangedEvent})),l=new r.b(i,(function(e){return e.triggerRecurrenceChangedEvent})),f=new r.b(i,(function(e){return e.triggerLocationsChangedEvent})),d=new r.b(i,(function(e){return e.triggerAttachmentsChangedEvent})),p=new r.b(i,(function(e){return e.deinitializeAddinsForItem})),b=new r.b(i,(function(e){return e.initializeAddinsForItem})),h=new r.a(i,(function(e){return e.initializeExtensibilityContext})),m=new r.b(i,(function(e){return e.onHostItemChanged})),v=new r.b(i,(function(e){return e.whenItemHasContextualAddinKeywords})),M=new r.b(i,(function(e){return e.launchTranslateCommand})),O=new r.b(i,(function(e){return e.setPersistedAddin})),C=new r.b(i,(function(e){return e.shouldForceOnSendCompliantBehavior})),g=(Object(r.d)(i,(function(e){return e.AddinBarView})),Object(r.d)(i,(function(e){return e.TaskPaneCollection}))),x=new r.b(i,(function(e){return e.onComposeClose})),y=new r.b(i,(function(e){return e.openContextualCallout})),w=new r.b(i,(function(e){return e.launchAddinCommand})),E=new r.b(i,(function(e){return e.observeAddinCommandSurfaceItems})),A=new r.b(i,(function(e){return e.onItemNavigation})),j=new r.b(i,(function(e){return e.allowItemSendEvent})),T=new r.a(i,(function(e){return e.ExecuteEntryPoint})),R=new r.a(i,(function(e){return e.onLaunchEventTriggered}))},1550:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"h",(function(){return d}));var r,i,a,c=n(269);function u(e){return[e.AutomaticReply,e.LargeAudience,e.ModeratedMailbox,e.PrefersAccessibility,e.MailboxFull,e.DeliveryRestricted,e.GuestMailtip,e.ExternalMembers,e.CustomMailtip]}!function(e){e[e.RemoveRecipient=0]="RemoveRecipient",e[e.ShowDetails=1]="ShowDetails",e[e.HideDetails=2]="HideDetails",e[e.RemoveAll=3]="RemoveAll",e[e.ShowMore=4]="ShowMore",e[e.ShowLess=5]="ShowLess",e[e.EmailClicked=6]="EmailClicked",e[e.AccCheckerClick=7]="AccCheckerClick"}(r||(r={})),function(e){e[e.None=0]="None",e[e.OutOfOffice=1]="OutOfOffice",e[e.LargeAudience=2]="LargeAudience",e[e.IsModerated=3]="IsModerated",e[e.CustomMailTip=4]="CustomMailTip",e[e.PreferAccessibleContent=5]="PreferAccessibleContent",e[e.MailboxFull=6]="MailboxFull",e[e.DeliveryRestricted=7]="DeliveryRestricted",e[e.GuestsDisabledGroupsWithGuests=8]="GuestsDisabledGroupsWithGuests",e[e.ExternalMemberCount=9]="ExternalMemberCount"}(i||(i={})),function(e){e[e.None=0]="None",e[e.SingleRecipient=1]="SingleRecipient",e[e.MultipleRecipients=2]="MultipleRecipients"}(a||(a={}));var o="MailtipsActionDatapoint";function s(e){Object.keys(e).some((function(t){return e[t]!=a.None}))&&Object(c.p)("RecipientRemovedFromRecipientWellDatapoint",u(e))}function l(e){Object.keys(e).some((function(t){return e[t]!=a.None}))&&Object(c.p)("SendActionMailTipsDatapoint",u(e))}function f(e){Object.keys(e).some((function(t){return e[t]!=a.None}))&&Object(c.p)("DiscardActionMailTipsDatapoint",u(e))}function d(e){return e>23?23:e}},1820:function(e,t,n){"use strict";var r=n(233),i=n(84),a=n(324),c=n(1502),u=n(1188),o=n(59);function s(e){if(!Object(a.a)()&&Object(c.a)()&&function(){switch(Object(o.a)().browser){case"Chrome":case"Firefox":case"Edge Anaheim":case"Opera":return!0;case"Safari":return"Windows"!==Object(o.c)().os;default:return!1}}()&&Object(u.d)(u.a.Bohemia).bohemiaEnabled)switch(e){case 0:case 1:return Object(i.i)("cmp-prague");case 6:return Object(i.i)("cal-cmp-fluid");case 2:case 3:case 5:case 7:return Object(i.i)("cal-cmp-fluid")&&Object(i.i)("cal-cmp-fluidCollaborativeSpace");case 4:return Object(i.i)("outlookSpaces-fluid-asset");default:return Object(r.a)(e)}return!1}n.d(t,"a",(function(){return s}))},2210:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3117);function i(){return Object(r.b)().mailTips}},2264:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateMailtips",(function(e,t,n){return{composeId:e,fromEmailAddress:t,recipients:n}}))},2369:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onMailTipRetrieved",(function(e,t){return{composeId:e,fromAddress:t}}))},2380:function(e,t,n){"use strict";var r=n(350),i=n(31),a=n(0);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(a.__assign)({__type:"GetMailTipsJsonRequest:#Exchange"},n)),Object(i.a)("GetMailTips",e,t)}var u=n(431),o=n(287);function s(e,t){var n,i=Object(u.a)(Object(o.d)(e));return c({Header:Object(r.a)(),Body:(n={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:t.map((function(e){return{EmailAddress:e}}))},Object(a.__assign)({__type:"GetMailTipsRequest:#Exchange"},n))},i).then((function(e){return(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null})).catch((function(e){return Promise.resolve(null)}))}n.d(t,"a",(function(){return s}))},2384:function(e,t,n){"use strict";var r;!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var i=r,a=n(2648);n.d(t,"a",(function(){return o}));var c=/<!--((.|\n)*?)-->/gi,u=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t};function o(e){if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return u(t).reduce((function(e,t){switch(t.localName){case i.RecipientAddress:t.childNodes.length>1&&(e.RecipientAddress=t.childNodes[1].textContent);break;case i.MailboxFull:e.MailboxFull="true"===t.textContent;break;case i.IsModerated:e.IsModerated="true"===t.textContent;break;case i.TotalMemberCount:e.TotalMemberCount=parseInt(t.textContent)||0;break;case i.ExternalMemberCount:e.ExternalMemberCount=parseInt(t.textContent)||0;break;case i.MaxMessageSize:e.MaxMessageSize=parseInt(t.textContent)||0;break;case i.DeliveryRestricted:e.DeliveryRestricted="true"===t.textContent;break;case i.PreferAccessibleContent:e.PreferAccessibleContent="true"===t.textContent;break;case i.OutOfOffice:e.OutOfOffice=s(t);break;case i.CustomMailTip:e.CustomMailTip=d(t);break;case i.GuestMailTipStatus:e.GuestStatus=f(t.textContent)}return e}),{})}var s=function(e){return e.childNodes?d(u(e.childNodes).filter((function(e){return"ReplyBody"===e.localName}))[0]):""},l=function(e){return e.replace(c,"")},f=function(e){var t=e.split(" "),n=a.a.None;return t.map((function(e){n|=a.a[e]})),n};function d(e){var t;if(e){var n=l(e.textContent).replace(/<\/a>/gi,"</a> "),r=(new DOMParser).parseFromString(n,"text/html");if((null===(t=null==r?void 0:r.childNodes)||void 0===t?void 0:t.length)&&r.childNodes[0].textContent)return r.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},2647:function(e,t,n){"use strict";var r=n(0),i=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i.value=t,i}return Object(r.__extends)(t,e),t}(n(2667).a);t.a=i},2648:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},2667:function(e,t,n){"use strict";var r=n(0),i=n(18),a=n(725),c=300,u=function(){function e(e,t){this.parentCacheKey=e,this.childMruCacheKey=t,this.cacheTime=Date.now()}return e.isExpired=function(e){return Date.now()-e.cacheTime>=72e5},e.compareEntryCacheTime=function(e,t){return e.cacheTime-t.cacheTime},e}(),o=n(275),s=function(){function e(e,t,n){void 0===t&&(t=c),void 0===n&&(n=Date.now()),this.comparer=e,this.cacheLimit=t,this.lastExpiredEntryClearedTime=n,this.cache=new i.ObservableMap}return e.prototype.initialize=function(e){this.cache=e.cache},e.prototype.add=function(e,t){var n=this;Object(o.action)("NestedMruCache_add")((function(){n.clearOldEntriesIfNeeded();var r=null;n.cache.has(e)?r=n.cache.get(e):((r=new a.a(n.cacheLimit)).initialize(new i.ObservableMap),n.cache.set(e,r)),r.add(t.childMruCacheKey,t)}))()},e.prototype.containsValueForKey=function(e,t){if(!this.cache.has(e))return!1;var n=this.cache.get(e).get(t);return!(!n||u.isExpired(n))},e.prototype.get=function(e,t){var n=null;return this.containsValueForKey(e,t)&&(n=this.cache.get(e).get(t)),n},e.prototype.clearUpExpiredEntries=function(){var e,t;if(!(Date.now()-this.lastExpiredEntryClearedTime<12e5)){var n=function(e){e.getItemIds().forEach((function(t){u.isExpired(e.get(t))&&e.remove(t)}))};try{for(var i=Object(r.__values)(this.cache.values()),a=i.next();!a.done;a=i.next()){n(a.value)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.lastExpiredEntryClearedTime=Date.now()}},e.prototype.remove=function(e){var t=this;Object(o.action)("NestedMruCache_remove")((function(){if(t.cache.has(e)){var n=t.cache.get(e);n.getItemIds().map((function(e){n.remove(e)}))}}))()},e.prototype.clear=function(){var e=this;Object(o.action)("NestedMruCache_clear")((function(){var t,n,i=e.cache.keys();try{for(var a=Object(r.__values)(i),c=a.next();!c.done;c=a.next()){var u=c.value;e.remove(u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}))()},e.prototype.countTotalNumberOfEntries=function(){var e,t,n=0;if(this.cache)try{for(var i=Object(r.__values)(this.cache.values()),a=i.next();!a.done;a=i.next()){n+=a.value.getItemIds().length}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},e.prototype.returnAllMailTipsCacheEntries=function(){var e,t,n=[];if(this.cache){var i=function(e){e&&e.getItemIds().map((function(t){var r=e.get(t);n.push(r)}))};try{for(var a=Object(r.__values)(this.cache.values()),c=a.next();!c.done;c=a.next()){i(c.value)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return n},e.prototype.clearOldEntriesIfNeeded=function(){var e,t;if(this.countTotalNumberOfEntries()>=c&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=c){var n=[],i=function(e){e.getItemIds().forEach((function(t){n.push(e.get(t))}))};try{for(var a=Object(r.__values)(this.cache.values()),u=a.next();!u.done;u=a.next()){i(u.value)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}n.sort(this.comparer);for(var o=0;o<50;o++){var s=n[o].parentCacheKey,l=n[o].childMruCacheKey;this.cache.get(s).remove(l)}}},e}();n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}))},2946:function(e){e.exports=JSON.parse('{"a":"Ffb"}')},3117:function(e,t,n){"use strict";var r=n(3),i=n(2647),a=n(2667),c=n(0),u=n(2369),o=n(2264),s=n(2210),l=n(2380);var f=n(2384),d=n(269);Object(r.orchestrator)(o.a,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,o,p,b,h;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:return t=e.composeId,n=e.fromEmailAddress,r=e.recipients,n&&r&&r.length?(a=Object(s.a)(),(o=r.filter((function(e){return e&&!a.containsValueForKey(n,e)}))).length?[4,Object(l.a)(n,o)]:[3,2]):[3,3];case 1:(p=c.sent())&&(b=p.ResponseMessages.map((function(e){return Object(f.a)(e.MessageText)})).filter((function(e){return!!e})))&&b.length>0&&(!function(e,t){if(e&&e.length>0&&t){var n=Object(s.a)();e.map((function(e){n.add(t,new i.a(e,t,e.RecipientAddress))}))}}(b,n),Object(u.a)(t,n)),c.label=2;case 2:h=r.filter((function(e){return-1==o.indexOf(e)})),Object(d.p)("UpdateMailtipsDatapoint",{owa_1:h.length>0,rec:r.length,ca:h.length}),c.label=3;case 3:return[2]}}))}))}));n.d(t,"b",(function(){return b}));var p={mailTips:new a.b(i.a.compareEntryCacheTime)},b=Object(r.createStore)("mailTipsCacheStore",p),h=b();t.a=h},3232:function(e){e.exports=JSON.parse('{"a":"Ifb"}')},3233:function(e){e.exports=JSON.parse('{"a":"Hfb"}')},3234:function(e){e.exports=JSON.parse('{"a":"Gfb"}')},3235:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1550),i=n(2210),a=n(3616),c=n(3617);function u(e,t){var n={},u=Object(a.a)(e,Object(i.a)(),t);return Object.keys(u).map((function(e){if(u[e].length>0){var t=u[e].length>1?r.c.MultipleRecipients:r.c.SingleRecipient;switch(e){case"TotalMemberCount":Object(c.a)(u[e])&&(n.LargeAudience=t);break;case"CustomMailTip":n.CustomMailtip=t;break;case"DeliveryRestricted":n.DeliveryRestricted=t;break;case"ExternalMemberCount":n.ExternalMembers=t;break;case"GuestsDisabledGroupsWithGuests":n.GuestMailtip=t;break;case"IsModerated":n.ModeratedMailbox=t;break;case"MailboxFull":n.MailboxFull=t;break;case"OutOfOffice":n.AutomaticReply=t;break;case"PreferAccessibleContent":n.PrefersAccessibility=t}}})),n}},3616:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2648);function i(e,t,n){var i=e.map((function(e){return e.EmailAddress}));return e.filter((function(e,t){return i.indexOf(e.EmailAddress)===t})).reduce((function(e,i){var a=t.get(n,i.EmailAddress),c=a?a.value:{};return c.DeliveryRestricted&&e.DeliveryRestricted.push(i),c.IsModerated&&e.IsModerated.push(i),c.MailboxFull&&e.MailboxFull.push(i),c.OutOfOffice&&e.OutOfOffice.push({recipient:i,message:c.OutOfOffice}),c.PreferAccessibleContent&&e.PreferAccessibleContent.push(i),c.GuestStatus&r.a.IsCalculated&&c.GuestStatus&r.a.GroupHasGuests?0==(c.GuestStatus&r.a.GuestsEnabled)?e.GuestsDisabledGroupsWithGuests.push(i):e.ExternalMemberCount.push({recipient:i,count:1}):c.ExternalMemberCount&&e.ExternalMemberCount.push({recipient:i,count:c.ExternalMemberCount}),c.TotalMemberCount&&e.TotalMemberCount.push({recipient:i,count:c.TotalMemberCount}),c.CustomMailTip&&e.CustomMailTip.push({recipient:i,message:c.CustomMailTip}),e}),{CustomMailTip:[],DeliveryRestricted:[],ExternalMemberCount:[],IsModerated:[],MailboxFull:[],MaxMessageSize:[],OutOfOffice:[],PreferAccessibleContent:[],TotalMemberCount:[],GuestsDisabledGroupsWithGuests:[]})}},3617:function(e,t,n){"use strict";var r=n(29);t.a=function(e){var t=e.reduce((function(e,t){return{totalRecipients:e.totalRecipients+t.count,hasAGroup:e.hasAGroup||t.count>1}}),{totalRecipients:0,hasAGroup:!1}),n=t.totalRecipients;return t.hasAGroup&&n>=Object(r.a)().MailTipsLargeAudienceThreshold}},3822:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.mutatorAction)("clearDomProperties",(function(e){e.initialVisiblePart=null,e.dockingTriggerPart=null}))}}]);
//# sourceMappingURL=owa.MailBoot~CalendarQuickCompose~Editor~InboxForMeSurface.js.map
self.scriptsLoaded['owa.MailBoot~CalendarQuickCompose~Editor~InboxForMeSurface.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarQuickCompose~Editor~InboxForMeSurface.js'] = (new Date()).getTime();