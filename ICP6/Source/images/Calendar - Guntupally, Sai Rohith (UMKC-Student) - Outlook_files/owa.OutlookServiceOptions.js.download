self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[789],{16419:function(e,t,n){"use strict";n.r(t);var o,r=n(0),a=n(96),i=n(1202),u=n(351),c=n(311),d=n(52),s=n(3);!function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(o||(o={}));var f={loadState:o.OptionsNotLoaded},p=Object(s.createStore)("owsOptionsLoadStateStore",f),O=n(1208);var l=n(1313),b="ows/v1.0/OutlookOptions",m=null,A=Object(s.mutatorAction)("setOptionLoadState",(function(e){p().loadState=e}));function S(){switch(p().loadState){case o.OptionsLoading:return m;case o.OptionsLoaded:return Promise.resolve();case o.OptionsNotLoaded:default:return A(o.OptionsLoading),m=Object(c.b)(b).then((function(e){!function(e){e?(e.options&&e.options.forEach((function(e){null!=e&&(e.feature==i.a.SurfaceActions&&(e=function(e){return e.readSurfaceActions=e.readSurfaceActions?e.readSurfaceActions:[],e.readSurfaceAddins=e.readSurfaceAddins?e.readSurfaceAddins:[],e.composeSurfaceActions=e.composeSurfaceActions?e.composeSurfaceActions:[],e.composeSurfaceAddins=e.composeSurfaceAddins?e.composeSurfaceAddins:[],e}(e)),Object(i.g)(e.feature,e))})),void 0===t&&(t=Object(O.a)()),Object.keys(Object(i.e)().options).forEach((function(e){if(!Object(i.e)().options[e].lastModifiedDateTime&&t[e]){var n=Number(e);Object(i.c)(n,t[e])}})),A(o.OptionsLoaded)):(d.g.info("Error loading options"),Object(l.a)(),A(o.OptionsNotLoaded));var t}(e),m=null}))}}var j="ows/v1.0/OutlookOptions/{0}";function v(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,u,c;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return n=Object(a.a)(j,i.a[e]),p().loadState===o.OptionsLoaded?[3,2]:[4,S()];case 1:s.sent(),s.label=2;case 2:return p().loadState===o.OptionsLoaded?Object(i.e)().options[e]&&Object(i.e)().options[e].lastModifiedDateTime?t&&0!==Object.keys(t).length?((u=t)["feature@is.Queryable"],u["feature@odata.type"],u.createdDateTime,u.lastModifiedDateTime,c=Object(r.__rest)(u,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]),[2,w(1,n,c)]):(d.g.info("createOrUpdateOptionsForFeature called with no changes to options"),[2,Promise.resolve()]):[2,w(0,n,t)]:[2,Promise.reject(new Error("Options are not loaded. Cannot update options."))]}}))}))}function w(e,t,n){var o={correlationId:Object(u.a)(),options:n};return(1==e?c.c:c.d)(t,o,o.correlationId).then((function(e){if(!function(e){if((null==e?void 0:e.options)&&1==e.options.length){var t=e.options[0];return Object(i.g)(t.feature,t),!0}return!1}(e)){var t=new Error("Error processing options response");throw t.networkError=!0,t}}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,S()];case 1:return t.sent(),[2,Object(i.d)(e)]}}))}))}var g=Object(s.action)("updateAddInArray",(function(e,t,n){return{addinsArray:e,productId:t,isPushOperation:n}}));Object(s.mutator)(g,(function(e){e.isPushOperation?e.addinsArray.push(e.productId):e.addinsArray.splice(e.addinsArray.indexOf(e.productId),1)}));var L=g;function E(e,t,n){var o=Object(i.d)(i.a.SurfaceActions),r=Object(i.d)(i.a.CalendarSurfaceAddins),a=!!n.readMode&&y(o.readSurfaceAddins,e,t);a=n.composeMode?a||y(o.composeSurfaceAddins,e,t):a;var u=!!n.calendarMode&&y(r.calendarSurfaceAddins,e,t);a&&v(i.a.SurfaceActions,o),u&&v(i.a.CalendarSurfaceAddins,r)}var y=function(e,t,n){var o=!1;return n?-1===e.indexOf(t)&&(L(e,t,!0),o=!0):-1!==e.indexOf(t)&&(L(e,t,!1),o=!0),o};n.d(t,"createOrUpdateOptionsForFeature",(function(){return v})),n.d(t,"loadOptions",(function(){return S})),n.d(t,"getServerOptionsForFeature",(function(){return h})),n.d(t,"updateAddinPinStatus",(function(){return E}))},311:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return s}));var o=n(69),r=new o.c((function(){return Promise.all([n.e(1),n.e(46),n.e(804)]).then(n.bind(null,888))})),a=new o.a(r,(function(e){return e.makePostRequest})).importAndExecute,i=new o.a(r,(function(e){return e.makePatchRequest})).importAndExecute,u=new o.a(r,(function(e){return e.makePutRequest})).importAndExecute,c=new o.a(r,(function(e){return e.makeGetRequest})).importAndExecute,d=new o.a(r,(function(e){return e.makeDeleteRequest})).importAndExecute,s=new o.a(r,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},351:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var o=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}function i(e){return o.test(e)}}}]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
self.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();