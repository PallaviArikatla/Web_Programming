self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarBootstrapUtils.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[447],{1346:function(e,t,n){"use strict";function r(e,t){return!e.some((function(e){return e&&t&&e.calculatedFolderId===t.calculatedFolderId}))}function a(e,t){return e.indexOf(t)<0}function i(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e&&e.forEach((function(e){t(n,e)&&n.push(e)})),n}var u=n(18);function o(e,t){if(void 0===t&&(t=a),!e)return e;var n=new u.ObservableMap;return e.forEach((function(e,r){n.set(r,i(e,t))})),n}function c(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e.forEach((function(e){e&&e.forEach((function(e){t(n,e)&&n.push(e)}))})),n}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}))},1561:function(e,t,n){"use strict";var r=n(3),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",(function(e,t){return{calendarIds:e,userIdentity:t}})),i=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",(function(e,t){return{calendarId:e,userIdentity:t}})),u={selectedCalendars:new(n(18).ObservableMap)},o=Object(r.createStore)("selectedCalendarsStore",u),c=n(1346);Object(r.mutator)(a,(function(e){var t=e.calendarIds,n=e.userIdentity;o().selectedCalendars.set(n,Object(c.b)(t))}));var d=n(0);function s(){return Object(c.c)(o().selectedCalendars)}function l(){return Object(c.d)(s())}function f(e){var t=s().get(e);return t||[]}Object(r.mutator)(i,(function(e){var t=e.calendarId,n=e.userIdentity;o().selectedCalendars.set(n,Object(c.b)(Object(d.__spread)(f(n),[t])))}));var b=Object(r.action)("UPDATE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),O=Object(r.action)("ADD_SELECTED_CALENDAR",(function(e,t){return{calendarId:e,userIdentity:t}})),v=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",(function(e,t){return{calendarIds:e,userIdentity:t}})),Object(r.action)("SELECTED_CALENDARS_UPDATED",(function(e,t){return{calendarIds:e,userIdentity:t}}))),p=n(287),j=n(52),I=n(98),h=n(431),m="OWA.ViewStateConfiguration";function g(e,t){return Object(d.__awaiter)(this,void 0,void 0,(function(){return Object(d.__generator)(this,(function(n){return e&&I.v.importAndExecute([{key:"SelectedCalendarsDesktop",valuetype:"StringArray",value:Object(c.b)(e)}],m,Object(h.a)(Object(p.d)(t))).catch((function(e){j.g.warn("Could not save new selected calendars list to user configuration")})),[2]}))}))}function y(e){return e?function(e){var t=s().get(e);return t?t.length:0}(e):(t=s(),n=0,t.forEach((function(e,t){e&&(n+=e.length)})),n);var t,n}Object(r.orchestrator)(b,(function(e){var t=e.calendarIds,n=e.userIdentity;a(t,n),v(t,n),g(t,n)})),Object(r.orchestrator)(O,(function(e){var t=e.calendarId,n=e.userIdentity;i(t,n);var r=f(n);v(r,n),g(r,n)})),Object(r.orchestrator)(I.A,(function(e){var t=e.userConfiguration,n=e.userIdentity,r=t.ViewStateConfiguration.SelectedCalendarsDesktop,i=n||Object(p.d)().userIdentity;a(r,i),v(r,i)})),n.d(t,"g",(function(){return b})),n.d(t,"a",(function(){return O})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l}))},2856:function(e,t,n){"use strict";var r=n(156);function a(e){return Object(r.d)()&&Object(r.b)().isFeatureDisabled(e)}n.d(t,"a",(function(){return a}))},3519:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(69),a=new r.c((function(){return Promise.all([n.e(134),n.e(259),n.e(876)]).then(n.bind(null,5490))})),i=new r.a(a,(function(e){return e.loadWorkloadScenarioSettings}))},431:function(e,t,n){"use strict";var r=n(0);function a(e,t){return e?Object(r.__assign)({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return a}))},4616:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(98),i=n(645),u=n(729),o=n(84),c=n(156),d=n(2856);function s(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(i.d)()];case 1:return t.sent(),e=Object(a.h)(),Object(o.g)("cal-multiAccounts",(function(){var t,n;Object(d.a)(c.a.MultiAccounts)||Object(a.s)()||(null===(t=null==e?void 0:e.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)||null===(n=null==e?void 0:e.PolicySettings)||void 0===n||!n.PersonalAccountCalendarsEnabled||u.a.importAndExecute()})),[2]}}))}))}},522:function(e,t,n){"use strict";var r=n(599).a.Symbol;t.a=r},531:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},532:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"FolderId:#Exchange"},e)}},544:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var r=n(15),a=n(4),i=n(84),u=new r.b((function(){return n.e(614).then(n.bind(null,1126))})),o=new r.a(u,(function(e){return e.tryGetCalendarViewOffline})),c=new r.a(u,(function(e){return e.onGetCalendarViewResponse})),d=new r.a(u,(function(e){return e.tryGetCalendarFoldersOffline})),s=new r.a(u,(function(e){return e.onGetCalendarFoldersResponse}));function l(){return Object(i.i)("fwk-offline-services")&&Object(a.d)("offlineboot",window.location)}},5486:function(e,t,n){"use strict";var r=n(0),a=n(69),i=new a.c((function(){return n.e(310).then(n.bind(null,16545)).then((function(e){return e.initialize(),e}))})),u=n(4616),o=new a.c((function(){return n.e(325).then(n.bind(null,16518))})),c=new a.a(o,(function(e){return e.autoUpgradeOldModelCalendars})),d=n(84),s=n(3519),l=n(98);n.d(t,"a",(function(){return b}));var f=!1;function b(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return f?[2]:(f=!0,e=[Object(u.a)(),s.a.importAndExecute()],i.import(),[4,Promise.all(e)]);case 1:return n.sent(),t=Object(l.h)(),Object(d.g)("cal-sharing-autoUpgrade",(function(){var e,n;!Object(l.s)()&&1==(null===(e=null==t?void 0:t.ViewStateConfiguration)||void 0===e?void 0:e.CalendarViewTypeDesktop)&&(null===(n=null==t?void 0:t.ViewStateConfiguration)||void 0===n?void 0:n.CalendarViewInSplitMode)&&c.importAndExecute()})),[2]}}))}))}},599:function(e,t,n){"use strict";var r=n(694),a="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||a||Function("return this")();t.a=i},607:function(e,t,n){"use strict";var r=n(531),a=n(599),i=function(){return a.a.Date.now()},u=n(637),o="Expected a function",c=Math.max,d=Math.min;t.a=function(e,t,n){var a,s,l,f,b,O,v=0,p=!1,j=!1,I=!0;if("function"!=typeof e)throw new TypeError(o);function h(t){var n=a,r=s;return a=s=void 0,v=t,f=e.apply(r,n)}function m(e){var n=e-O;return void 0===O||n>=t||n<0||j&&e-v>=l}function g(){var e=i();if(m(e))return y(e);b=setTimeout(g,function(e){var n=t-(e-O);return j?d(n,l-(e-v)):n}(e))}function y(e){return b=void 0,I&&a?h(e):(a=s=void 0,f)}function _(){var e=i(),n=m(e);if(a=arguments,s=this,O=e,n){if(void 0===b)return function(e){return v=e,b=setTimeout(g,t),p?h(e):f}(O);if(j)return clearTimeout(b),b=setTimeout(g,t),h(O)}return void 0===b&&(b=setTimeout(g,t)),f}return t=Object(u.a)(t)||0,Object(r.a)(n)&&(p=!!n.leading,l=(j="maxWait"in n)?c(Object(u.a)(n.maxWait)||0,t):l,I="trailing"in n?!!n.trailing:I),_.cancel=function(){void 0!==b&&clearTimeout(b),v=0,a=O=s=b=void 0},_.flush=function(){return void 0===b?f:y(i())},_}},637:function(e,t,n){"use strict";var r=n(531),a=n(695),i=NaN,u=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,s=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(a.a)(e))return i;if(Object(r.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(r.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var n=c.test(e);return n||d.test(e)?s(e.slice(2),n?2:8):o.test(e)?i:+e}},639:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return o}));var r=n(3),a=Object(r.action)("initializeOwaAccountsStore"),i=Object(r.action)("owaConnectedAccountAdded",(function(e,t){return{userIdentity:e,accountProviderType:t}})),u=Object(r.action)("removeAccount",(function(e){return{userIdentity:e}})),o=Object(r.action)("owaAccountStoreInitializationFailed",(function(e,t,n,r){return{userIdentity:e,isRetry:t,accountProvider:n,error:r}}))},640:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(u,o){a?o(new Error("The function retry was cancelled")):(r++,e().then((function(e){return u(e)})).catch((function(e){t&&r>=t?o(e):setTimeout((function(){return i(u,o)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return i(e,t)}))},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},645:function(e,t,n){"use strict";var r,a=n(3),i=Object(a.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(r||(r={}));var u=n(233),o=n(287);function c(e,t){switch(e){case r.Outlook:case r.OutlookGroup:return(t||Object(o.d)().userIdentity)+e.toString();case r.TeamsCalendars:return e.toString();default:return Object(u.a)(e)}}var d=n(98),s=n(84);function l(e,t){var n=c(e,t);return i().loadedCalendarAccounts.some((function(e){return e===n}))}function f(e){return function(e){if(e&&e!==Object(d.b)()){var t=[r.Outlook];return Object(s.i)("cal-multiAccounts-groups")&&t.push(r.OutlookGroup),t}return[r.Outlook,r.OutlookGroup,r.TeamsCalendars]}(e).every((function(t){return l(t,e)}))}var b=Object(a.action)("addToLoadedCalendarAccounts",(function(e){return{calendarAccountData:e}}));Object(a.mutator)(b,(function(e){i().loadedCalendarAccounts.push(e.calendarAccountData)}));var O=n(729),v=n(52),p=Object(a.action)("calendarCacheInitializedForAccount",(function(e,t){return{calendarEndpointType:e,userId:t}})),j=n(0),I=n(737),h=n(757),m=n(69),g=new m.c((function(){return Promise.all([n.e(16),n.e(18),n.e(696)]).then(n.bind(null,16682))})),y=new m.a(g,(function(e){return e.initializeSelectedTeamsCalendars}));var _=n(640),w=Object(_.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(_.a)(1e3)}),C={};function S(e,t){if(t=t||Object(o.d)().userIdentity,l(e,t))return Promise.resolve();var n=c(e,t),a=C[n];if(a)return a.requestPromise;var i=w((function(){return function(e,t){return Object(j.__awaiter)(this,void 0,void 0,(function(){return Object(j.__generator)(this,(function(n){switch(n.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,3];case r.TeamsCalendars:return[3,5]}return[3,7];case 1:return[4,Object(I.f)(t)];case 2:return n.sent(),[3,8];case 3:return[4,Object(h.b)(t)];case 4:return n.sent(),[3,8];case 5:return[4,y.importAndExecute()];case 6:return n.sent(),[3,8];case 7:Object(u.a)(e),n.label=8;case 8:return[2]}}))}))}(e,t)})).retriableFunc();return C[n]={requestPromise:i},i.then((function(){b(n),p(e,t)})).catch((function(e){v.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)}))}Object(a.orchestrator)(O.e,(function(e){S(r.Outlook,e.userIdentity),Object(s.i)("cal-multiAccounts-groups")&&S(r.OutlookGroup,e.userIdentity)}));var E=n(373);function A(){return Object(j.__awaiter)(this,void 0,void 0,(function(){var e,t,n,a,i,u;return Object(j.__generator)(this,(function(o){switch(o.label){case 0:return e=S(r.Outlook),t=Object(E.n)().map((function(e){return S(r.Outlook,e.userIdentity)})),n=S(r.OutlookGroup),a=S(r.TeamsCalendars),i=Object(j.__spread)([e,n],t,[a]),Object(s.i)("cal-multiAccounts-groups")&&(u=Object(E.n)().map((function(e){return S(r.OutlookGroup,e.userIdentity)})),i=i.concat(u)),[4,Promise.all(i)];case 1:return o.sent(),[2]}}))}))}n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return S})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return A}))},6647:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(645),i=n(3),u=n(1561),o=n(287),c=n(179),d=n(737);Object(i.orchestrator)(a.c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.userId,n=Object(u.e)(t||Object(o.d)().userIdentity),[4,Promise.all(n.filter((function(e){return Object(c.d)(e)&&Object(c.c)(e)})).map(d.c))];case 1:return r.sent(),[2]}}))}))}));var s=n(4616),l=n(5486);n.d(t,"initializeAccountAndCalendars",(function(){return s.a})),n.d(t,"initializeCalendarsDataForModule",(function(){return l.a}))},682:function(e,t,n){"use strict";var r=n(522),a=Object.prototype,i=a.hasOwnProperty,u=a.toString,o=r.a?r.a.toStringTag:void 0;var c=function(e){var t=i.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch(e){}var a=u.call(e);return r&&(t?e[o]=n:delete e[o]),a},d=Object.prototype.toString;var s=function(e){return d.call(e)},l="[object Null]",f="[object Undefined]",b=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:l:b&&b in Object(e)?c(e):s(e)}},684:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},694:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(111))},695:function(e,t,n){"use strict";var r=n(682),a=n(684),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(r.a)(e)==i}},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"DistinguishedFolderId:#Exchange"},e)}},729:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(639);n.d(t,"e",(function(){return r.c})),n.d(t,"d",(function(){return r.b}));var a=n(69),i=new a.c((function(){return n.e(743).then(n.bind(null,1133))})),u=new a.a(i,(function(e){return e.initializeOwaAccountsStore})),o=new a.b(i,(function(e){return e.initializeOwaConnectedAccount})),c=new a.a(i,(function(e){return e.removeOWAConnectedAccount}))},737:function(e,t,n){"use strict";var r=n(0),a=n(179),i=n(287),u=n(29),o=n(526),c=n(52);function d(e,t,n){var d,s={},l={},f={},b={},O={},v=n?[n]:[Object(u.a)().SessionSettings.LogonEmailAddress],p=Object(i.d)(n);return e.forEach((function(e){O[e.ItemId.Id]=e.ItemId.ChangeKey;var n=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:e.GroupId,mailboxInfo:p}}),i=Object(a.s)(p.userIdentity,e.GroupId);b[i]=n,e.Calendars.forEach((function(e){if(function(e,t){if(7==e.CalendarFolderType)return!1;if(Object(o.d)(e)){var n=e;if(n.IsOwnerEmailAddressInvalid)return c.g.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+n.OwnerEmailAddress),!1;var r=n.IsGeneralScheduleCalendar?n.OwnerEmailAddress:n.SharedFolderId?n.SharedFolderId.Id:null;if(!r)return c.g.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(t.includes(r))return c.g.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(t.push(r),n.OwnerEmailAddress=n.OwnerEmailAddress.toLowerCase(),n.IsGroupMailboxCalendar)return!1}return!0}(e,v)){var n=e.ItemId.Id,i=Object(a.h)(e).Id,u=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:n,mailboxInfo:p}});if(1==e.CalendarFolderType){var l=t&&t.filter((function(e){return e.FolderId.Id===i}))[0];d={id:{id:n,mailboxInfo:p},calculatedFolderId:i,displayName:l?l.DisplayName:e.CalendarName,colorScheme:null},u.CalendarName=d.displayName}!s[n]&&(s[n]=u),!f[i]&&(f[i]={id:e.ItemId.Id,mailboxInfo:p}),!O[n]&&(O[n]=e.ItemId.ChangeKey)}}))})),t.forEach((function(e){var t=f[e.FolderId.Id];t&&(l[t.id]=e)})),{defaultCalendar:d,calendarEntryMapping:s,calendarFolderMapping:l,folderIdMapping:f,calendarGroupMapping:b,calendarIdToChangeKeyMapping:O}}var s=n(745),l=n(350),f=n(755),b=n(98),O=n(431),v=n(544);function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=null,n=null,e&&!Object(b.t)(e)||(t=Object(f.a)()),t)return[3,6];n=Object(O.a)(Object(i.d)(e)),r.label=1;case 1:return r.trys.push([1,3,,6]),[4,Object(s.a)({Header:Object(l.a)()},n)];case 2:return t=r.sent(),[3,6];case 3:return r.sent(),Object(v.a)()?[4,v.d.importAndExecute(e)]:[3,5];case 4:t=r.sent(),r.label=5;case 5:return[3,6];case 6:return t&&Object(v.a)()?(n||(n=Object(O.a)(Object(i.d)(e))),[4,v.b.importAndExecute({userIdentity:e,options:n},t)]):[3,8];case 7:r.sent(),r.label=8;case 8:return[2,t]}}))}))}var j=n(707),I=n(753);function h(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,u,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=Object(O.a)({type:"GroupMailbox",userIdentity:n,mailboxSmtpAddress:t,requestOptions:null}),u=Object(a.o)(e.Id),o=u&&(u.IsGeneralScheduleCalendar||u.IsGroupMailboxCalendar)?Object(j.a)({Id:"calendar",Mailbox:{EmailAddress:t}}):5==u.CalendarFolderType?u.SharedFolderId:e,[4,Object(I.a)({request:{FolderId:o}},i)];case 1:return[2,r.sent()]}}))}))}var m=n(532),g=n(269),y=n(3),_=Object(y.action)("calendarFolderIdUpdated"),w=Object(y.action)("setCalendarLoadState",(function(e,t){return{calendarId:e,loadState:t}}));function C(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),w(e,"Loading"),[4,S(e)];case 1:return n.sent(),[3,3];case 2:return(t=n.sent()).message&&(t.message.indexOf("ErrorApiQuarantined")>=0||t.message.indexOf("ErrorTooManyObjectsOpened")>=0)?w(e,"Throttled"):w(e,"Failed"),[3,3];case 3:return[2]}}))}))}function S(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,u,o,c,d,s,l,f,O,v;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(t=Object(a.m)(e)))throw new Error("Unable to get calendar entry for calendar "+e);n=Object(a.x)(e),u=Object(a.i)(e),o=Object(a.u)(n),c=o?o.mailboxInfo:Object(i.d)(),d=Object(a.L)(t),O=Object(a.t)().filter((function(e){return e.GroupId==t.ParentGroupId})),f=O?O[0].id.mailboxInfo.userIdentity:Object(i.d)().userIdentity,5==t.CalendarFolderType&&Object(b.h)().SessionSettings.DefaultPublicFolderMailbox?s=Object(b.h)().SessionSettings.DefaultPublicFolderMailbox:(v=function(e,t){return e||(t?t.userIdentity:null)}(t.OwnerEmailAddress,c),s=d?Object(a.f)(v):v),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,h(Object(m.a)({Id:u}),s,f)];case 2:return l=r.sent(),[3,4];case 3:return r.sent(),Object(g.p)("getCalendarFolderConfigurationServiceFailed"),Object(a.P)(t),[2];case 4:if(!l)throw new Error("Unable to get folder for calendar "+e);return(Object(a.P)(t),5==t.CalendarFolderType?function(e,t,n){var r=e.CalendarFolder;if(r){t.CalendarFolderId||(t.CalendarFolderId=e.CalendarFolder.FolderId);var u=r.ReplicaList[0];Object(a.b)(t,r,(o=u,{type:"PublicMailbox",userIdentity:Object(i.d)().userIdentity,mailboxSmtpAddress:o}))}var o}(l,t):function(e,t,n,r,i){var u,o,c=e.CalendarFolder;i&&(null===(u=null==c?void 0:c.FolderId)||void 0===u?void 0:u.Id)&&(c.FolderId.Id=Object(a.O)(c.FolderId.Id,r));(null===(o=null==c?void 0:c.EffectiveRights)||void 0===o?void 0:o.Read)&&(e.MasterList&&(t.RemoteCategories=e.MasterList),(r==t.OwnerEmailAddress||t.ItemId&&r==t.ItemId.Id)&&(Object(a.e)(r,{id:{id:t.ItemId.Id,mailboxInfo:n},calculatedFolderId:c.FolderId.Id}),Object(a.R)(r),Object(a.b)(t,c,n)))}(l,t,c,e,d),_(),[2])}}))}))}var E=n(373);function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(e)];case 1:if(null==(t=r.sent())||!t.WasSuccessful)throw u=new Error("[getCalendarFoldersFromServer] Failed to load calendars from server"),t?u.fetchErrorType="ServerFailure":u.networkError=!0,Object(c.d)(u),u;return n=d(t.CalendarGroups,t.CalendarFolders,e),o=t.CalendarGroups.length,i=o<1?{lowerBoundResultSize:null,upperBoundResultSize:0}:o<=3?{lowerBoundResultSize:1,upperBoundResultSize:3}:o<=6?{lowerBoundResultSize:4,upperBoundResultSize:6}:{lowerBoundResultSize:7,upperBoundResultSize:null},Object(g.p)("CalendarGroupsPerAccount",{connectedAccount_1:Object(E.r)(e),calendarGroupCount:t.CalendarGroups.length,calendarGroupCount_2:i.lowerBoundResultSize+" - "+i.upperBoundResultSize}),Object(a.E)(n.defaultCalendar,n.calendarEntryMapping,n.calendarFolderMapping,n.calendarGroupMapping,n.folderIdMapping,n.calendarIdToChangeKeyMapping),[2]}var o}))}))}var G=n(18),F=Object(y.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new G.ObservableMap});function x(e){return F().calendarIdsLoadState.get(e)}Object(y.mutator)(w,(function(e){var t=e.calendarId,n=e.loadState;F().calendarIdsLoadState.set(t,n)})),Object(y.mutator)(a.Q,(function(e){var t=e.calendar;F().calendarIdsLoadState.delete(t.id.id)})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return C})),n.d(t,"f",(function(){return A})),n.d(t,"a",(function(){return _})),n.d(t,"d",(function(){return x}))},745:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31);function a(e,t){return Object(r.a)("GetCalendarFolders",e,t)}},746:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(31),a=n(749);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("GetUserUnifiedGroups",e,t)}},747:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}},749:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},e)}},753:function(e,t,n){"use strict";var r=n(31),a=n(0);function i(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(a.__assign)({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},n))),Object(r.a)("GetCalendarFolderConfiguration",e,t)}n.d(t,"a",(function(){return i}))},755:function(e,t,n){"use strict";var r;function a(e){return r=e.getCalendarFolders,e}function i(){var e=r;return r=void 0,e}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},756:function(e){e.exports=JSON.parse('{"a":"Bbb"}')},757:function(e,t,n){"use strict";var r=n(0),a=n(275),i=n(756),u=n(11),o=n(746),c=n(747),d=n(350),s="Groups",l=n(287),f=n(526),b=n(431),O=n(179);function v(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 4,(t=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(n=Object(d.a)()).RequestServerVersion="V2018_01_08",a=Object(b.a)(Object(l.d)(e)),[4,Object(o.a)({Header:n,Body:Object(c.a)({RequestedGroupsSets:t})},a)];case 1:return[2,r.sent()]}}))}))}var p=Object(a.action)("getGroupCalendarsService")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,v(e)];case 1:return null!=(t=n.sent())&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?[2,j(t.Body.GroupsSets,e)]:[2,null]}}))}))}));function j(e,t){var n=[],r=[],a=Object(O.s)(t,s);if(e.forEach((function(e){e.Groups.forEach((function(e){var i=e.SmtpAddress.toLowerCase(),u={type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:i,requestOptions:null},o={__type:f.a,CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:i,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ItemId:{Id:i},ParentGroupId:a},c={DistinguishedFolderId:i,DisplayName:e.DisplayName};n.push({entry:o,folder:c,mailboxInfo:u});var d={id:{id:i,mailboxInfo:u},calculatedFolderId:i,displayName:e.DisplayName,colorScheme:null};r.push(d)}))})),r.length>0){var o={id:{id:a,mailboxInfo:{type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:t,requestOptions:null}},GroupId:a,ItemId:{Id:a},GroupName:Object(u.b)(i.a),GroupType:3};return{groupCalendars:n,calendarGroup:o,calendars:r}}return null}var I=Object(a.action)("getGroupCalendars")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,p(e)];case 1:return null!=(t=n.sent())&&null!=t.groupCalendars?(t.groupCalendars.forEach((function(e){Object(O.b)(e.entry,e.folder,e.mailboxInfo)})),Object(O.a)(t.calendarGroup),[2,{group:t.calendarGroup,calendars:t.calendars}]):[2,null]}}))}))})),h=n(269),m=n(98),g=Object(a.action)("initializeGroupCalendars")((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i,u,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=new h.a("initializeGroupCalendars"),e||(e=Object(l.d)().userIdentity),a=Object(m.i)(e).GroupsEnabled,i=Object(O.s)(e,s),u=!Object(O.t)().some((function(t){return t.id.id===i&&t.id.mailboxInfo.userIdentity===e})),o=a&&(t||u),n.addCustomData({issueServiceCall:o,GroupsEnabled:a,featureEnabled:!0,refresh:t,initialLoad:u}),r.label=1;case 1:return r.trys.push([1,4,,5]),o?[4,I(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return n.end(),[3,5];case 4:throw c=r.sent(),n.endWithError("ServerError",Error(c)),c;case 5:return[2]}}))}))})),y=n(3),_=n(52),w=n(607),C=null;Object(y.orchestrator)(O.D,(function(e){var t=e.payload,n=t.id,r=t.EventType,a=t.Group.SmtpAddress;_.g.info(n+": "+r+", "+a),C||(C=Object(w.a)(g.bind(null,Object(l.d)().userIdentity,!0),2e3)),C()})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return s}))}}]);
//# sourceMappingURL=owa.MailBoot~CalendarBootstrapUtils.js.map
self.scriptsLoaded['owa.MailBoot~CalendarBootstrapUtils.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarBootstrapUtils.js'] = (new Date()).getTime();