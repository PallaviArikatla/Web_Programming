self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarCloudSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[450],{1234:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));var r=t(3),o=t(18),i=Object(r.createStore)("lightningState",{unseenItems:new o.ObservableMap,lightedCount:0,lastShownId:null}),a=i()},1289:function(e,n,t){"use strict";var r=t(0),o=t(47),i=t(1297),a=t(1),u=t.n(a);function c(e,n){var t=function(n,t){return u.a.createElement(l,Object(r.__assign)({},n),u.a.createElement(e,Object(r.__assign)({},n)))};return t.displayName=e.displayName,n?u.a.forwardRef(t):t}var l=Object(o.a)((function(e){var n=e.lid,t=e.when,r=e.series,o=e.children;return u.a.useEffect((function(){return Object(i.b)(n,t,r),function(){i.c.importAndExecute(n)}}),[]),o&&d(n)?u.a.createElement(u.a.Fragment,null,o):null}));function s(e,n){i.c.importAndExecute(e,n)}function d(e){if(i.d.unseenItems){var n=i.d.unseenItems.get(e);if(null==n?void 0:n.visible)return!0}return!1}function f(e){var n;return null===(n=i.d.unseenItems)||void 0===n?void 0:n.has(e)}t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return l})),t.d(n,"e",(function(){return s})),t.d(n,"f",(function(){return d})),t.d(n,"c",(function(){return f})),t.d(n,"b",(function(){return i.a}))},1297:function(e,n,t){"use strict";var r=t(69),o=t(1234),i=t(52),a=t(0),u=t(4),c=t(18),l=t(3),s=Object(l.mutatorAction)("initializeLightning",(function(e){var n,t;if(i.g.info("initialize lightning store"),Object(o.a)().lastShownId=null,Object(o.a)().lightedCount=0,Object(o.a)().unseenItems=new c.ObservableMap,e)try{for(var r=Object(a.__values)(e),u=r.next();!u.done;u=r.next()){var l=u.value;Object(o.a)().unseenItems.set(l.identity,l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}}));var d=t(311),f="ows/v1.0/lightning/items/unseen";function b(){return i.g.info("initialize lightning from server"),Object(d.b)(f).then((function(e){var n=e.map(v);s(n)}))}function v(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var g,E=t(29),h=t(84),O="lightning",y="UnseenLightening";function S(){var e,n,t;if(!g){var r=Object(u.a)(O);if(r)g=function(e){i.g.info("initialize lightning from override query parameter");var n=e.split(",").map((function(e){return{identity:e,visible:!1}}));return s(n),Promise.resolve()}(r);else{var o=Object(E.a)().PrimeSettings;if(Object(h.i)("lightning-initFromSD")&&o&&o.Items)try{for(var c=Object(a.__values)(o.Items),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.Id===y&&d.Value){t=d.Value,i.g.info("initialize lightning from session data"),s(t.map((function(e){return{identity:e.id,visible:!1,category:e.category}}))),g=Promise.resolve();break}}}catch(n){e={error:n}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}g||(g=b())}}return g}var m=t(1583),j=Object(l.action)("lightup",(function(e){return{id:e}})),p=j;Object(l.mutator)(j,(function(e){i.g.info("lightup - id:"+e.id),Object(o.a)().lastShownId=e.id,Object(o.a)().lightedCount++;var n=Object(o.a)().unseenItems.get(e.id);n&&(n.visible=!0)})),Object(l.orchestrator)(j,(function(e){Object(m.a)("LIGHTUP",e.id)}));var C,w=t(685);function B(e,n){(i.g.info("lightupOrReject - id:"+e+", recurrenceCount:"+n+", lightedCount:"+Object(o.a)().lightedCount+", lastShown:"+Object(o.a)().lastShownId),Object(w.v)())?i.g.info("lightning is disabled for deeplink"):Object(o.a)().unseenItems.has(e)&&(!Object(o.a)().lastShownId||function(e,n){var t=!1,r=Object(o.a)().lastShownId;if(r&&n&&!function(){var e=Object(o.a)(),n=e.lastShownId,t=e.unseenItems;return n&&t.has(n)&&t.get(n).visible}()){var i=n.indexOf(r),a=n.indexOf(e);i>=0&&i+1==a&&(t=!0)}return t}(e,n)||function(e){var n=Object(o.a)().unseenItems.get(e);return!!n&&n.category==C.UIFeatureDiscovery}(e)||function(e){var n=Object(o.a)().unseenItems.get(e);return!!n&&n.category==C.Compliance}(e))&&p(e)}function I(e,n,t){i.g.info("beginLightning - id:"+e),n((function(){S().then((function(){return B(e,t)})).catch((function(n){i.g.warn("something is wrong, lightning id:"+e+", reason:"+n)}))}))}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(C||(C={}));var L=t(1301);t.d(n,"c",(function(){return R})),t.d(n,"d",(function(){return o.b})),t.d(n,"b",(function(){return I})),t.d(n,"a",(function(){return L.a}));var F=new r.c((function(){return t.e(399).then(t.bind(null,16603))})),R=new r.a(F,(function(e){return e.endLightningImp}))},1301:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.InsertLinkTeachingMomentOpenCompose="68",e.InsertLinkTeachingMomentAfterAttach="69",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78"}(r||(r={}))},1583:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(61),o=t(1301);function i(e,n){Object.keys(o.a).some((function(t){return o.a[t]==n&&(Object(r.h)(e,{key:t,id:n},{isCore:!0}),!0)}))}},16418:function(e,n,t){"use strict";t.r(n);var r=t(0),o=t(1708),i=t(2244),a=t(3324),u=t(3911);var c=t(311);function l(){var e,n=Object.values(a.c).join(),t=(e=n,""+a.a+a.b.Global+"?settingname="+e);return Object(c.b)(t).then((function(e){return Object(u.a)(e)}))}var s=t(728),d=t(84),f=t(1297),b=t(1289);function v(e){e()}var g=t(608),E=t(727);function h(){if(Object(d.i)("cal-mf-shouldEventsEndEarlySetting")&&Object(d.i)("cal-mf-shouldEventsEndEarlyFREDialog")&&!Object(d.i)("cal-mf-shortenEventsDuration")&&!Object(g.a)()||Object(d.i)("cal-mf-shortenEventsDuration")&&!Object(E.a)()){var e=Object(d.i)("cal-mf-shortenEventsDuration")?b.b.ShortenEventsDurationSetting:b.b.SpeedyMeetingsEndEarlySetting;Object(f.b)(e,O)}}function O(e){e()}var y=t(3758),S=t(3);function m(e){var n=function(e){var n=[];null!=e.shouldEventsEndEarly&&n.push({name:a.c.ShouldEventsEndEarly,value:e.shouldEventsEndEarly,type:a.d.Bool,scope:a.b.Global});null!=e.shortenEventScope&&n.push({name:a.c.ShortenEventScope,value:e.shortenEventScope,type:a.d.String,scope:a.b.Global});null!=e.endShortEventsBy&&n.push({name:a.c.EndShortEventsBy,value:e.endShortEventsBy,type:a.d.Int,scope:a.b.Global});null!=e.endLongEventsBy&&n.push({name:a.c.EndLongEventsBy,value:e.endLongEventsBy,type:a.d.Int,scope:a.b.Global});null!=e.enableOnlineMeetingsByDefault&&n.push({name:a.c.EnableOnlineMeetingsByDefault,value:e.enableOnlineMeetingsByDefault,type:a.d.Bool,scope:a.b.Global});return n.length>0?n:null}(e);return n?Object(c.c)(a.a+a.b.Global,n,void 0,!0):null}Object(S.orchestrator)(i.b,(function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return Object(y.a)()?[4,l()]:[3,2];case 1:if(!(e=n.sent()))return[2];Object(o.f)(e),n.label=2;case 2:return Object(d.i)("cal-mf-enableDefaultOnlineMeetingSetting")&&!Object(s.a)()&&Object(f.b)(b.b.DefaultOnlineMeetingSetting,v),h(),[2]}}))}))})),Object(S.orchestrator)(i.c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return(n=e.calendarCloudSettings)?(Object(o.f)(n),[4,m(n)]):[2];case 1:return t.sent(),[2]}}))}))}));var j=t(3891);t.d(n,"initCalendarCloudSettings",(function(){return i.b})),t.d(n,"saveCalendarCloudSettings",(function(){return i.c})),t.d(n,"bootIndex",(function(){return j}))},1708:function(e,n,t){"use strict";t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return u})),t.d(n,"f",(function(){return c})),t.d(n,"a",(function(){return l}));var r=t(3),o=Object(r.action)("setShouldEventsEndEarly",(function(e){return{shouldEventsEndEarly:e}})),i=Object(r.action)("setShortenEventScope",(function(e){return{shortenEventScope:e}})),a=Object(r.action)("setEndShortEventsBy",(function(e){return{endShortEventsBy:e}})),u=Object(r.action)("setEndLongEventsBy",(function(e){return{endLongEventsBy:e}})),c=Object(r.action)("updateCalendarCloudSettings",(function(e){return{calendarCloudSettings:e}})),l=Object(r.action)("setEnableOnlineMeetingsByDefault",(function(e){return{enableOnlineMeetingsByDefault:e}}))},2244:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return a}));var r=t(3),o=Object(r.action)("initCalendarCloudSettings"),i=Object(r.action)("saveCalendarCloudSettings",(function(e){return{calendarCloudSettings:e}})),a=Object(r.action)("initBootCalendarCloudSettings")},3324:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"c",(function(){return r})),t.d(n,"d",(function(){return o})),t.d(n,"b",(function(){return i}));var r,o,i,a,u="/ows/beta/OutlookCloudSettings/settings/";!function(e){e.ShouldEventsEndEarly="Should_Event_End_Early",e.ShortenEventScope="shorten_event_scope",e.EndShortEventsBy="End_Short_meetings_by",e.EndLongEventsBy="End_long_meetings_by",e.EnableOnlineMeetingsByDefault="onlinemeetings_enabledbydefault"}(r||(r={})),function(e){e.Bool="Bool",e.Int="Int",e.String="String"}(o||(o={})),function(e){e.Global="global",e.Account="account"}(i||(i={})),function(e){e.RoamingSetting="roamingsetting"}(a||(a={}))},3758:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var r=t(416);function o(){var e=Object(r.a)();return!e||(null==e.shouldEventsEndEarly||null==e.shortenEventScope||null==e.endShortEventsBy||null==e.endLongEventsBy||null==e.enableOnlineMeetingsByDefault)}},3891:function(e,n,t){"use strict";t.r(n);var r=t(1708),o=t(416),i=t(3);Object(i.mutator)(r.e,(function(e){Object(o.a)().shouldEventsEndEarly=e.shouldEventsEndEarly})),Object(i.mutator)(r.d,(function(e){Object(o.a)().shortenEventScope=e.shortenEventScope})),Object(i.mutator)(r.c,(function(e){Object(o.a)().endShortEventsBy=e.endShortEventsBy})),Object(i.mutator)(r.b,(function(e){Object(o.a)().endLongEventsBy=e.endLongEventsBy})),Object(i.mutator)(r.a,(function(e){Object(o.a)().enableOnlineMeetingsByDefault=e.enableOnlineMeetingsByDefault}));Object(i.orchestrator)(r.f,(function(e){var n=e.calendarCloudSettings;null!=n.shouldEventsEndEarly&&Object(r.e)(n.shouldEventsEndEarly),null!=n.shortenEventScope&&Object(r.d)(n.shortenEventScope),null!=n.endShortEventsBy&&Object(r.c)(n.endShortEventsBy),null!=n.endLongEventsBy&&Object(r.b)(n.endLongEventsBy),null!=n.enableOnlineMeetingsByDefault&&Object(r.a)(n.enableOnlineMeetingsByDefault)}));var a=t(2244),u=t(3911),c=t(3758),l=t(98);Object(i.orchestrator)(a.a,(function(){if(Object(c.a)()){var e=Object(l.f)(),n=Object(u.a)(e);n&&Object(r.f)(n)}})),t.d(n,"initBootCalendarCloudSettings",(function(){return a.a}))},3911:function(e,n,t){"use strict";var r=t(3324),o=t(457);function i(e){return e&&0!=e.length?(e.forEach((function(e){if(e.name&&e.value)switch(e.name.toLowerCase()){case r.c.ShouldEventsEndEarly.toLowerCase():n="true"===e.value.toLowerCase();break;case r.c.ShortenEventScope.toLowerCase():t=function(e){switch(e.toLowerCase()){case o.a.EndEarly.toLowerCase():return o.a.EndEarly;case o.a.StartLate.toLowerCase():return o.a.StartLate;case o.a.None.toLowerCase():return o.a.None}return null}(e.value);break;case r.c.EndShortEventsBy.toLowerCase():i=+e.value;break;case r.c.EndLongEventsBy.toLowerCase():a=+e.value;break;case r.c.EnableOnlineMeetingsByDefault.toLowerCase():u="true"===e.value.toLowerCase()}})),null==n&&null==t&&null==i&&null==a&&null==u?null:{shouldEventsEndEarly:n,shortenEventScope:t,endShortEventsBy:i,endLongEventsBy:a,enableOnlineMeetingsByDefault:u}):null;var n,t,i,a,u}t.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.MailBoot~CalendarCloudSettings.js.map
self.scriptsLoaded['owa.MailBoot~CalendarCloudSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarCloudSettings.js'] = (new Date()).getTime();