self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFavoritesStore~MailFolderTreesParent~MailFolderTreesParent~38b2abc6.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[91],{1197:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(18),i=n(3),o={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},u=Object(i.createStore)("mail",o),c=u();t.a=c},1200:function(e,t,n){"use strict";var r=n(69),i=n(1197),o=n(1594),u=n(1422),c=n(1367),a="ChronologicalNewestOnBottom";function s(e,t){return e[t==a?0:e.length-1]}var d=n(603),f=n(1207);function l(e){return Object(c.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(f.a)({FieldURI:"TailoredXpEntities"}),Object(f.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(f.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(f.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((function(e){if(e&&!(e instanceof Error)){var t=e;return{TailoredXpEntities:t.TailoredXpEntities,TailoredXpCalendarEventIds:t.TailoredXpCalendarEventIds,TailoredXpEntitiesStatus:t.TailoredXpEntitiesStatus,EntityNamesMap:t.EntityNamesMap}}return{}}))}function b(e){return i.a.items.get(e)}var m=n(29);function O(e){var t=i.a.conversations.get(e);if(t){var n=Object(m.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==n}return!1}var v=n(1485),p=n(1185),h=n(275),I=Object(h.select)({folderTable:function(){return p.d.folderTable}})((function(e,t){return!!t.folderTable.get(e)})),S=n(1193);function g(e,t){var n=p.d.folderTable.get(e);return!!n&&(Object(p.H)(n,S.d,t)||n.DistinguishedFolderId===S.b)}function j(e){return g(e)||function(e){var t=p.d.folderTable.get(e);return t&&t.DistinguishedFolderId===S.d}(e)}var y=Object(h.select)({folderTable:function(){return p.d.folderTable}})((function(e,t,n){return Object(p.H)(e,t,n)})),w=n(1638),C=n(1471);function E(e){return e&&(Object(C.a)(e,S.h)||Object(C.a)(e,S.b))}function T(e){return e&&(y(e,S.g)||y(e,S.a))}var M=n(1545);function R(e,t){try{return _(e,t)}catch(e){return null}}function _(e,t){if(!e||!t)return null;var n=Object(p.n)().get(e).PermissionSet.Permissions.filter((function(e){return e.UserId.PrimarySmtpAddress===t}));return null==n?void 0:n[0]}var A=n(324),x="OneOff",L="Unknown";function N(e,t,n){return!Object(A.a)()&&(n==x||n==L)&&(null==e?void 0:e.indexOf(t))<0}var D=n(3),F=Object(D.mutatorAction)("setIsDraftQueuedForSubmission",(function(e,t){var n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}));n.d(t,"s",(function(){return V})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return u.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return s})),n.d(t,"t",(function(){return l})),n.d(t,"v",(function(){return b})),n.d(t,"q",(function(){return O})),n.d(t,"c",(function(){return v.a})),n.d(t,"r",(function(){return I})),n.d(t,"m",(function(){return g})),n.d(t,"l",(function(){return j})),n.d(t,"n",(function(){return y})),n.d(t,"j",(function(){return w.a})),n.d(t,"k",(function(){return E})),n.d(t,"p",(function(){return T})),n.d(t,"f",(function(){return M.a})),n.d(t,"h",(function(){return R})),n.d(t,"i",(function(){return _})),n.d(t,"o",(function(){return N})),n.d(t,"w",(function(){return F}));var P=new r.c((function(){return n.e(985).then(n.bind(null,16644))})),V=new r.a(P,(function(e){return e.setTriageActionAnnouncement}))},1277:function(e,t,n){"use strict";var r=n(3),i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}}),o=i();function u(){return o.selectedNode}function c(){var e=u();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},1308:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return d}));var r=n(1781),i=n(29),o=n(1391);function u(){return s(r.a.Bottom)}function c(){return s(r.a.Off)}function a(){return s(r.a.Right)}function s(e){var t=Object(o.a)();return null!==t.clientReadingPanePosition?t.clientReadingPanePosition===e:Object(i.a)().UserOptions.GlobalReadingPanePositionReact==e}function d(){var e=Object(i.a)().UserOptions.GlobalReadingPanePositionReact;return e==r.a.Off||e==r.a.Bottom}},1316:function(e,t,n){"use strict";var r=n(69),i=n(1183);function o(){return u(Object(i.H)())}function u(e){return e&&2==e.tableQuery.type?e.tableQuery.folderId:null}function c(){var e=Object(i.H)();return e&&2==e.tableQuery.type}function a(e){return!!e&&(2==e.type||s(e))}function s(e){return!(!e||1!=e.type)&&"Group"==e.searchScope.kind}function d(e){return 2==e.type?e.folderId:s(e)?e.searchScope.groupId:null}function f(){var e=Object(i.H)();return e&&a(e.tableQuery)}n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"m",(function(){return O})),n.d(t,"l",(function(){return v})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"k",(function(){return I})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return f}));var l=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(16),n.e(37),n.e(73),n.e(623)]).then(n.bind(null,16519))})),b=new r.b(l,(function(e){return e.getGroupDisplayName})),m=new r.b(l,(function(e){return e.getGroupDisplayNameFromTableView})),O=new r.b(l,(function(e){return e.isPrivateUnjoinedGroup})),v=new r.b(l,(function(e){return e.isJoinedGroup})),p=new r.b(l,(function(e){return e.getRetentionPolicyTagsForGroup})),h=new r.b(l,(function(e){return e.getRetentionPolicyTagListForGroupTableQuery})),I=new r.b(l,(function(e){return e.isGroupOwner}))},1362:function(e,t,n){"use strict";var r=n(1772),i=n(287),o=n(1185),u=n(1428),c=n(1316),a=n(2051),s=n(1510),d=n(1193),f=n(29);function l(e){return e?m(e.tableQuery):Object(i.d)()}function b(e,t){var n=m(e,t);return Object(s.a)(n)}function m(e,t){var n=Object(c.b)(e),r=null==e?void 0:e.folderId;return null!=n?Object(u.a)(n):O(r,t)}function O(e,t){return Object(o.G)(e)?Object(a.a)(e):Object(r.a)(e,t)}function v(e,t){var n=Object(c.b)(e),l=null==e?void 0:e.folderId;if(n){var b=Object(u.a)(n);return{mailboxInfo:Object(s.a)(b)}}if(Object(o.G)(l)){b=Object(a.a)(l);return{mailboxInfo:Object(s.a)(b)}}return Object(r.a)(l,t),function(e,t){var n,r,u,c,a=Object(o.n)(),s=null==a?void 0:a.get(e),l=Object(f.a)().SessionSettings;if((null==s?void 0:s.treeType)===d.k)r=s.principalSMTPAddress,u="SharedMailbox";else if(e==d.d||e==d.b||(null==s?void 0:s.treeType)==d.c){u="ArchiveMailbox";var b=l.ArchiveMailboxGuid;(c=null===(n=null==s?void 0:s.ReplicaList)||void 0===n?void 0:n[0])&&t?b=c:c=void 0,r=function(e,t){if(!e||!t)return null;return e+"@"+t}(b,l.OrganizationDomain)}else r=l.UserEmailAddress,u="UserMailbox";return{mailboxInfo:{type:u,userIdentity:Object(i.d)().userIdentity,mailboxSmtpAddress:r,auxiliaryMailboxGuid:c}}}(l,t)}n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return O})),n.d(t,"e",(function(){return v}))},1367:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1853),o=n(84),u=new(n(15).d)((function(){return n.e(737).then(n.bind(null,2989))}));function c(e,t,n,c,a,s,d,f){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(o.i)("mon-rp-loadItemViaGql")?[4,u.import().then((function(r){return r.getItemViaGraphQL(e,t,n,c,a,s,d,f)}))]:[3,2];case 1:return[2,r.sent()];case 2:return[4,Object(i.a)(e,t,n,c,s,d,f)];case 3:return[2,r.sent()]}}))}))}},1390:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1423);function o(e){var t,n;if(!e)return Promise.reject(u("500","Server returned a null response!",null));var o=Array.isArray(e)?e:[e];try{for(var c=Object(r.__values)(o),a=c.next();!a.done;a=c.next()){var s=a.value;if(s&&!Object(i.a)(s))return Promise.reject(u(s.ResponseCode,s.StackTrace,s.MessageText))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}function u(e,t,n){var r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);var i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}},1391:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.createStore)("maillayout",{clientReadingPanePosition:null,showReadingPane:!1,showListPane:!0,showFolderPane:!0})},1392:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1344);function i(e){return{headers:Object(r.e)(e,"GroupMailbox")}}},1402:function(e,t,n){"use strict";var r=n(1362),i=n(1183);function o(){return Object(r.a)(Object(i.H)())}var u=n(1772),c=n(1510);function a(e){var t=Object(u.a)(e);return Object(c.a)(t)}n.d(t,"c",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"e",(function(){return r.d})),n.d(t,"f",(function(){return r.e})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}))},1422:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1423:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r="Success";function i(e){return e&&e.ResponseClass==r}},1424:function(e,t,n){"use strict";var r=n(18),i=n(3),o={folderTable:new r.ObservableMap,rootFolder:null},u=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=u},1428:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1392),i=n(287),o={};function u(e){var t=e.toLocaleLowerCase();if(!o[t]){var n={type:"GroupMailbox",userIdentity:Object(i.d)().userIdentity,mailboxSmtpAddress:e,requestOptions:Object(r.a)(e)};o[t]=n}return o[t]}},1432:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"t",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"p",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return O})),n.d(t,"m",(function(){return v})),n.d(t,"d",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"s",(function(){return I})),n.d(t,"o",(function(){return S})),n.d(t,"u",(function(){return g})),n.d(t,"r",(function(){return j})),n.d(t,"q",(function(){return y})),n.d(t,"n",(function(){return w}));var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",u=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",a="CLASSID",s="4",d="0800",f=57,l=78,b=16,m=11,O="IPM.Note.SMIME.MultipartSigned",v="smime-",p="image",h="OwaToSmime",I="SmimeToOwa",S="en-US",g=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],j="OwaSmimeEdgeExtension.appxbundle",y="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",w="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},1471:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(49);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1484:function(e,t,n){"use strict";n.d(t,"p",(function(){return d})),n.d(t,"s",(function(){return f})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return b})),n.d(t,"n",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"l",(function(){return v})),n.d(t,"e",(function(){return p})),n.d(t,"o",(function(){return h})),n.d(t,"r",(function(){return I})),n.d(t,"q",(function(){return S})),n.d(t,"f",(function(){return g})),n.d(t,"i",(function(){return j})),n.d(t,"j",(function(){return y})),n.d(t,"m",(function(){return w})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"g",(function(){return T})),n.d(t,"k",(function(){return M}));var r=n(0),i=n(61),o=n(1183),u=n(1200),c=n(3),a=n(1308),s=n(29),d=Object(c.action)("SINGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(R(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),f=Object(c.action)("TOGGLE_SELECT_ROW",(function(e,t,n,r){return Object(i.c)(R(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})})),l=Object(c.action)("ON_AFTER_SELECTION_CHANGED",(function(e,t,n,r,i){return{rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:r,sxsId:i}})),b=Object(c.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),m=Object(c.action)("SET_LIST_VIEW_EXPANSION_LOADING_STATE",(function(e){return{shouldBeExpanded:e}})),O=Object(c.action)("ITEM_PART_SELECTED",(function(e,t,n,r,i){return{nodeId:e,itemId:t,allNodeIds:n,tableView:r,mailListItemSelectionSource:i}})),v=Object(c.action)("SELECT_NEXT_ITEM_PART",(function(e,t){return{rowKey:e,tableView:t}})),p=Object(c.action)("ON_ITEM_PART_CONTEXT_MENU",(function(e,t,n){return{contextMenuAnchor:e,nodeId:t,tableViewId:n}})),h=Object(c.action)("SINGLE_SELECT_ITEM_PART",(function(e,t,n,r,i){return{rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:r,currentSelectedNodeIds:i}})),I=Object(c.action)("TOGGLE_SELECT_ITEM_PART",(function(e){return{nodeId:e}})),S=Object(c.action)("TOGGLE_SELECT_ALL_ROWS",(function(e){return{tableView:e}})),g=Object(c.action)("RANGE_SELECT_ROW",(function(e,t,n,r){return{tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:r}})),j=Object(c.action)("RESET_SELECTION",(function(e,t){return{tableView:e,mailListItemSelectionSource:t}})),y=Object(c.action)("RESET_SELECTION",(function(e){return{tableView:e}})),w=Object(c.action)("SELECT_ROW_IN_DIRECTION",(function(e,t,n){return Object(i.c)(R(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})})),C=Object(c.action)("KEYBOARD_MULTI_SELECT_ROW",(function(e,t,n,r){return{tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:r}})),E=Object(c.action)("KEYBOARD_COLLAPSE_CONVERSATION",(function(e){return{rowKey:e}})),T=Object(c.action)("RESET_BUS_STOP_STATE_MAP"),M=Object(c.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(function(e,t,n){return{tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}}));function R(e,t,n,i){return{name:function(e,t,n,i){return!(function(e){return e===u.b.MailListItemRichPreview||e===u.b.KeyboardShiftEnter||e===u.b.MailListItemBodyDoubleClick}(e)||Object(a.c)()&&!function(e){var t;return e===u.b.KeyboardEnter||e===u.b.MailListItemBody||e===u.b.RouteHandler||e===u.b.CommandBarArrows||e===u.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(s.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,i){if(Object(a.c)())return!1;if(e===u.b.KeyboardUpDown){var c=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==c&&1===t.selectedRowKeys.size){var s=t.rowKeys.indexOf(Object(r.__spread)(t.selectedRowKeys.keys())[0]);return i===o.d.Next?s===c+1||s===t.rowKeys.length-1&&c===t.rowKeys.length-1:s===c-1||0===s&&0===c}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,i))}(e,t,n,i)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},1485:function(e,t,n){"use strict";var r=new(n(725).a)(50);t.a=r},1495:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1835);function i(e){return e&&Object(r.b)(e.ItemClass)}},1510:function(e,t,n){"use strict";function r(e){return{type:e.type,userIdentity:e.userIdentity,mailboxSmtpAddress:e.mailboxSmtpAddress,auxiliaryMailboxGuid:e.auxiliaryMailboxGuid}}n.d(t,"a",(function(){return r}))},1545:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1185),i=n(1277);function o(){var e=Object(i.c)(),t=null;return null==(t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id)?null:r.d.folderTable.get(t)}},1573:function(e,t,n){"use strict";var r=n(3),i=n(18),o=n(1185),u=n(2526),c=n(1277),a=(Object(r.mutator)(u.a,(function(e){var t=o.d.folderTable.get(e.folderId);t&&(e.isDeltaChange?(t.UnreadCount+=e.unreadCount,t.TotalCount+=e.totalCount):(t.UnreadCount=e.unreadCount,t.TotalCount=e.totalCount),t.pausedTotalCount&&Object(c.b)()===e.folderId&&(t.pausedTotalCount=t.TotalCount),t.UnreadCount=Math.max(t.UnreadCount,0),t.TotalCount=Math.max(t.TotalCount,0))})),{folderNodeViewStates:new i.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null,shouldShowMoveDialog:!1,moveToDestinationFolderId:null}),s=Object(r.createStore)("folderViewState",a)();t.a=s},1594:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},1626:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1344);function i(e){var t=new Headers;return Object(r.f)(e,t),{headers:t}}},1638:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1471),i=n(1193);function o(e){return e&&(Object(r.a)(e,i.g)||Object(r.a)(e,i.a))}},1639:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2525),i=n(1573),o=n(1453),u=n(1226),c=n(1183);function a(e){if(!i.a.folderNodeViewStates.has(e)){var t=c.c.getDefaultSortBy();Object(r.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(o.a)(),drop:Object(u.a)()})}return i.a.folderNodeViewStates.get(e)}},1658:function(e,t,n){"use strict";var r=n(69),i=n(1914),o=n(1985),u=n(1915),c=n(1784),a=n(1916),s=n(1863),d=n(1986);function f(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function l(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return O})),n.d(t,"w",(function(){return v})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return I})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return j})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return w})),n.d(t,"a",(function(){return C})),n.d(t,"c",(function(){return E})),n.d(t,"v",(function(){return T})),n.d(t,"u",(function(){return M})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return u.a})),n.d(t,"q",(function(){return c.a})),n.d(t,"r",(function(){return a.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"p",(function(){return f})),n.d(t,"n",(function(){return l}));var b=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(11),n.e(15),n.e(17),n.e(20),n.e(19),n.e(24),n.e(30),n.e(54),n.e(134),n.e(169),n.e(245),n.e(238),n.e(597)]).then(n.bind(null,16269))})),m=new r.a(b,(function(e){return e.addItemToCalendar})),O=new r.a(b,(function(e){return e.initializeMeetingRequestViewStateAction})),v=new r.a(b,(function(e){return e.removeCancelledMeetingFromCalendar})),p=Object(r.d)(b,(function(e){return e.MeetingMessageInfo})),h=(Object(r.d)(b,(function(e){return e.MeetingRequestActions})),Object(r.d)(b,(function(e){return e.MeetingCancellationAction})),Object(r.d)(b,(function(e){return e.MeetingActionButton})),Object(r.d)(b,(function(e){return e.MeetingDetailsTime})),Object(r.d)(b,(function(e){return e.MeetingDetailsLocation})),Object(r.d)(b,(function(e){return e.MeetingRequestInfo}))),I=Object(r.d)(b,(function(e){return e.MeetingRequestResponseEditor})),S=Object(r.d)(b,(function(e){return e.MeetingDetails})),g=Object(r.d)(b,(function(e){return e.MeetingRequestConflicts})),j=(Object(r.d)(b,(function(e){return e.EditEventLink})),Object(r.d)(b,(function(e){return e.MeetingMessageSummary}))),y=Object(r.d)(b,(function(e){return e.PreviewSummary})),w=Object(r.d)(b,(function(e){return e.SenderSummary})),C=Object(r.d)(b,(function(e){return e.CollapsedMeetingMessage})),E=Object(r.d)(b,(function(e){return e.MeetingIcon})),T=new r.a(b,(function(e){return e.logMeetingMessageActionForInvite})),M=new r.a(b,(function(e){return e.logMeetingMessageActionForEvent}))},1662:function(e,t,n){"use strict";function r(e,t){var n=Math.pow(2,32);if(e>=n||t>=n){var r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1680:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="IPM.Note.SMIME"},1689:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",(function(){return s})),n.d(r,"remove",(function(){return d})),n.d(r,"removeAll",(function(){return f})),n.d(r,"getCount",(function(){return l})),n.d(r,"getTombstonedReasons",(function(){return b})),n.d(r,"clearMapForFolder",(function(){return m})),n.d(r,"removeRowsFromTombstone",(function(){return O}));var i=n(0),o=n(3),u=Object(o.createStore)("tombstone",{folderTombstoneMap:{}}),c=(u(),n(269)),a=n(275),s=Object(a.action)("tombstoneOperations.add")((function(e,t,n){if(1!=t.tableQuery.type&&"spotlight"!==t.tableQuery.scenarioType){var r=t.serverFolderId,i=u().folderTombstoneMap;r in i||(i[r]={});var o=i[r];e.forEach((function(e){var t=o[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):o[e]=[3]:o[e]=[n]}))}})),d=Object(a.action)("tombstoneOperations.remove")((function(e,t,n){var r=u().folderTombstoneMap;if(t in r){var i=r[t],o=i[e],c=o?o.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");o.splice(c,1),0==o.length&&delete i[e],0==Object.keys(i).length&&delete r[t]}})),f=Object(a.action)("tombstoneOperations.removeAll")((function(){u().folderTombstoneMap={},Object(c.q)("TnS_RemoveAllFromTombstone")})),l=function(e,t){var n=u().folderTombstoneMap;if(!(e in n))return 0;var r=0,i=n[e];return Object.values(i).forEach((function(e){e==t&&r++})),r},b=function(e,t){var n=u().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},m=Object(a.action)("tombstoneOperations.clearMapForFolder")((function(e){var t=u().folderTombstoneMap;t[e]&&(Object(c.q)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),O=Object(a.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){var n,r,o=u().folderTombstoneMap;if(t in o){var c=o[t];try{for(var a=Object(i.__values)(e),s=a.next();!s.done;s=a.next()){var d=s.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete o[t]}}));t.a=r},1742:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r=1,i=16},1772:function(e,t,n){"use strict";var r=n(3),i=n(287),o=n(1185),u=n(18),c=Object(r.createStore)("mailboxInfoStore",new u.ObservableMap);function a(e,t){if(!e)return Object(i.d)();if(!c().has(e)){var n=Object(o.u)(e,t);s(e,n)}return c().get(e)}n.d(t,"a",(function(){return a}));var s=Object(r.mutatorAction)("addMailboxInfoToStore",(function(e,t){c().set(e,t)}))},1781:function(e,t,n){"use strict";var r;!function(e){e[e.Off=0]="Off",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom"}(r||(r={})),t.a=r},1784:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},1804:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(function(e,t){return{itemIdToRemove:e,removeItemSource:t}}))},1835:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var r=n(1432),i=n(1680);function o(e){return e&&0===e.indexOf(r.e)}function u(e){return e&&0===e.indexOf(i.a)&&!o(e)}function c(e){return e&&0===e.indexOf(i.a)}function a(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1853:function(e,t,n){"use strict";var r=n(740),i=n(687),o=n(0);var u=n(741),c=n(350),a=n(52),s=n(1390);function d(e,t,n,d,f,l,b){var m,O=Object(c.a)();if(d&&(O.RequestServerVersion=d),l){var v=(m={UserRoles:["MailboxSearch"]},Object(o.__assign)({__type:"ManagementRoleType:#Exchange"},m));O.ManagementRole=v}return Object(u.a)({Header:O,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map((function(e){return Object(i.a)({Id:e})})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:b})},f).then((function(e){var t,n,r;return null===(r=null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===r?void 0:r[0]})).then((function(e){return Object(s.a)(e).then((function(){return e}))})).then((function(t){return(null==t?void 0:t.Items.length)?Array.isArray(e)||void 0!==b?t.Items:t.Items[0]:null})).catch((function(e){return a.g.warn("GetItem:"+e.message),e}))}n.d(t,"a",(function(){return d}))},1863:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},1914:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("deleteMeetingMessage",(function(e,t){return{item:e,issueDeleteItemCall:t}}))},1915:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},1916:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},1985:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(function(e,t){return{status:e,sxsId:t}}))},1986:function(e,t,n){"use strict";function r(e){var t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},2051:function(e,t,n){"use strict";var r=n(1183),i=n(1185);function o(){var e=Object(r.H)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)}function u(){var e=Object(r.H)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(3),a=n(287),s=n(1626),d=n(1424),f=n(18),l=Object(c.createStore)("publicFolderUtilsStore",new f.ObservableMap),b=n(98);function m(e){if(!l().has(e)){var t=d.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(b.h)().SessionSettings.DefaultPublicFolderMailbox,r={type:"PublicMailbox",userIdentity:Object(a.d)().userIdentity,mailboxSmtpAddress:n,requestOptions:Object(s.a)(n)};O(e,r)}return l().get(e)}var O=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",(function(e,t){l().set(e,t)}));n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return m}))},2052:function(e,t,n){"use strict";var r=n(0),i=n(1639),o=n(29),u=n(98),c="OWA.ViewStateConfiguration",a=1e4,s=null;var d=n(1183),f=n(293),l=n(1185),b=n(2397),m=n(1225),O=n(1200);function v(e){var t=Object(m.a)(e);return Object(b.a)(e)||Object(l.G)(e)?I.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?I.DateViewOnly:"deleteditems"==t||Object(O.k)(e)?I.DateView:I.ConversationView}function p(e){return"inbox"!=Object(m.a)(e)||Object(b.a)(e)?h.SearchRefinerScopeCurrentFolder:h.SearchRefinerScopeAll}var h,I,S=n(2186);function g(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?d.c.DESCENDING_SORT_DIR:d.c.ASCENDING_SORT_DIR}))}function j(){for(var e=Object(o.a)().ViewStateConfiguration.FolderViewState||[],t={},n=0;n<e.length;n++){var r=g(e[n]);t[r.FolderId.Id]=r}return t}function y(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==d.c.DESCENDING_SORT_DIR&&t!==d.c.ASCENDING_SORT_DIR?t:t===d.c.DESCENDING_SORT_DIR?1:0}))}function w(e){var t=!1;Object(f.a)((function(n){for(var u=n.ViewStateConfiguration.FolderViewState||[],c=Object(i.a)(e),a=null,s=-1,d=0;d<u.length;d++){var f=g(u[d]);if(f.FolderId.Id===e){a=f,s=d;break}}var b=function(e,t,n){var i=n.sortOrder,u=n.sortColumn,c=n.isExpanded;if(t)return Object(r.__assign)(Object(r.__assign)({},t),{SortOrder:i,SortColumn:u,IsExpanded:c});var a=l.d.folderTable.get(e);return a?{FolderId:a.FolderId,View:v(a.FolderId.Id),Width:S.b,SortOrder:i,SortColumn:u,IsExpanded:c,ReadingPanePosition:Object(o.a)().UserOptions.GlobalReadingPanePositionReact,SearchScope:p(a.FolderId.Id)}:null}(e,a,c);b&&(-1!==s?(t=a!==b)&&(u[s]=y(b)):(t=!0,u.push(y(b))))})),t&&function(){var e=Object(o.a)().ViewStateConfiguration.FolderViewState;if(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);s||(s=setTimeout((function(){s=null,u.v.importAndExecute([{key:"FolderViewState",valuetype:"StringArray",value:t}],c)}),a))}}()}n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return w})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(h||(h={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(I||(I={}))},2107:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2855);function i(){var e=Object(r.b)();return e&&(e.MajorVersion>15||e.MinorVersion>20||e.MajorBuildNumber>=1807)}},2186:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var r=350,i=270,o=418},2327:function(e,t,n){"use strict";var r=n(29);function i(){return Object(r.a)().UserOptions.IsFocusedInboxEnabled}n.d(t,"a",(function(){return i}))},2397:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1185),i=n(1193);function o(e){return Object(r.C)(e,i.k)}},2462:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2052),i=n(1183),o=n(2902),u=n(2107);function c(e){if(Object(u.a)()){var t=Object(r.c)()[e];if(t){var n=Object(o.getSupportedSortColumns)(e),c=t.SortColumn,a=t.SortOrder;if(n.includes(c))return{sortColumn:c,sortDirection:a}}}return i.c.getDefaultSortBy()}},2525:function(e,t,n){"use strict";var r=n(1573),i=n(275);t.a=Object(i.action)("setFolderViewState")((function(e,t){r.a.folderNodeViewStates.set(e,t)}))},2526:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("UPDATE_FOLDER_COUNTS",(function(e,t,n,r){return{unreadCount:e,totalCount:t,folderId:n,isDeltaChange:r}}))},3451:function(e,t,n){"use strict";var r=n(69),i=n(1183),o=n(1402),u=n(1200),c=n(1225),a=n(1680);var s=n(1495),d=n(275);function f(e,t){if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if(Object(s.a)(e))return!1;var n=u.u.items.get(e.ItemId.Id);return!(null==n||!n.shouldShowAttachmentPreviews)||!(!e.HasAttachments&&!e.HasProcessedSharepointLink)&&(O.importAndExecute(Object(o.d)(t),e.ConversationId,e.ItemId.Id),!0)}var l=Object(d.select)({listViewStore:function(){return i.Y}})((function(e,t,n){var r,i,u,s=1==t.type,d=e.ConversationId,f=n.listViewStore.conversationItems.get(d.Id),l=e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(c.a)(t.folderId))return!1;if((null==(r=e)?void 0:r.ItemClasses)&&r.ItemClasses.length>0&&r.ItemClasses.some((function(e){return 0===e.indexOf(a.a)})))return!1;if(s){if(f)return f.shouldShowAttachmentPreviews;i=u=!!e.HasAttachments}else{if(!e.HasAttachmentPreviews&&!l)return!1;f&&!l?(i=f.globalItemIds.length!=e.GlobalItemIds.length,u=f.shouldShowAttachmentPreviews):(i=!0,u=!0)}return i&&O.importAndExecute(Object(o.d)(t),e.ConversationId,null),u}));n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return f}));var b=new r.c((function(){return n.e(425).then(n.bind(null,16502))})),m=new r.a(b,(function(e){return e.getPreviews})),O=new r.a(b,(function(e){return e.add})),v=new r.a(b,(function(e){return e.getAttachmentsForConversationWell})),p=new r.a(b,(function(e){return e.removeAttachmentPreviewsForRow}))},3767:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2227),i=n(638),o=n(1183),u=n(1190);function c(e){var t=Object(i.k)(e,Object(i.o)());return Object(r.a)(Object(u.a)("msgfolderroot"),Object(o.B)(null),"category",-1,"UserCategory",t)}},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},687:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemId:#Exchange"},e)}},725:function(e,t,n){"use strict";var r=n(0),i=n(275),o=n(52),u=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(this.store){var u=new Error("MruCache cannot be initialized twice.");u.diagnosticInfo=this.firstCs,o.d(u)}else{this.store=e,this.deleteCallback=t;try{for(var c=Object(r.__values)(e.keys()),a=c.next();!a.done;a=c.next()){var s=a.value;this.mruList.push(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}this.firstCs=(new Error).stack}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return u}))},740:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetItemRequest:#Exchange"},e)}},741:function(e,t,n){"use strict";var r=n(31),i=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=owa.MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFavoritesStore~MailFolderTreesParent~MailFolderTreesParent~38b2abc6.js.map
self.scriptsLoaded['owa.MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFavoritesStore~MailFolderTreesParent~MailFolderTreesParent~38b2abc6.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFavoritesStore~MailFolderTreesParent~MailFolderTreesParent~38b2abc6.js'] = (new Date()).getTime();