self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarBoot~CalendarCard~CalendarItemContextMenu~CalendarItemModal~CalendarModuleLazy~Cale~be089034.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[54],{1306:function(e,t,n){"use strict";var r=n(3),i=n(61),a=Object(r.action)("UserInteractionAction",(function(e,t,n,r,a){var c=a&&a.length>0?a.join():"";return Object(i.c)({name:"userInteractionAction",customData:{interactionType:e,viewType:t,propertyNamesList:c,isOrganizer:n,isMeeting:r},options:{isCore:!0}},{interactionType:e,viewType:t,isOrganizer:n,propertyNames:a})})),c=Object(r.action)("setItemUnavailable"),o=n(1829),s=Object(r.action)("dismissUndoNotification");n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o.a})),n.d(t,"a",(function(){return s}))},1386:function(e,t,n){"use strict";var r=n(0),i=n(5083),a=n(3966),c=n(431),o=n(763);function s(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)({ItemId:t?(s=e,Object(o.a)({ChangeKey:s.ChangeKey,OccurrenceId:s.Id})):e}),[4,Object(i.a)({request:n},Object(c.a)(e.mailboxInfo))];case 1:return[2,r.sent()]}var s}))}))}var u=n(3),d=n(61);function l(e){switch(e){case 0:return"Default";case 1:return"ThisInstanceOnly";case 2:return"ThisAndFollowingInstances";case 3:return"AllInstancesInSeries"}}function b(e){var t,n={containsLocation:!1,containsRichLocation:!1};return null===(t=e.Locations)||void 0===t||t.forEach((function(e){var t,r;n.containsLocation=!0,null!=(null===(t=e.PostalAddress)||void 0===t?void 0:t.Latitude)&&null!=(null===(r=e.PostalAddress)||void 0===r?void 0:r.Longitude)&&(n.containsRichLocation=!0)})),n}var v=Object(u.action)("ADD_CALENDAR_EVENT_TO_MY_CALENDAR",(function(e,t,n){return void 0===n&&(n=!1),Object(d.c)({name:"addToMyCalendar",customData:{ActionSource:t}},{itemId:e,actionSource:t,addSeries:n})})),f=Object(u.action)("CANCEL_CALENDAR_EVENT",(function(e,t,n,r,i){return Object(d.c)({name:"CancelEvent",customData:{actionSource:t,eventScope:l(n)}},{itemId:e,actionSource:t,eventScope:n,cancellationMessage:r,onCancel:i})})),O=Object(u.action)("DELETE_CALENDAR_EVENT",(function(e,t,n,r){return void 0===n&&(n=0),Object(d.c)({name:"DeleteEvent",customData:{actionSource:t,eventScope:l(n),isFocusTimeEvent_2:e.IsBookedFreeBlocks},options:{isCore:!0}},{item:e,actionSource:t,eventScope:n,onDelete:r})})),j=Object(u.action)("RESPOND_TO_CALENDAR_EVENT",(function(e,t,n,r,i,a,c,o,s,u,l,b){var v={itemId:e,currentResponseType:t,newResponseType:n,currentFreeBusyType:r,eventScope:i,sendResponse:a,actionSource:c,responseMessage:o,proposeNewTime:s,showingDeclinedEvents:u,meetingMessageId:l,skipLoggingDatapoint:b};return b?v:Object(d.c)({name:"RespondToEvent",options:{isCore:!0}},v)})),_=Object(u.action)("UPDATE_CALENDAR_EVENT",(function(e,t,n,r,i,a,c,o){return void 0===r&&(r=0),void 0===i&&(i=function(){}),void 0===a&&(a=function(){}),void 0===c&&(c=!1),void 0===o&&(o=!1),Object(d.c)({name:"UpdateEvent"},{event:e,calendarItemUpdates:t,actionSource:n,eventScope:r,onSuccess:i,onError:a,showNotification:c,updateAsCoOrganizer:o})})),p=Object(u.action)("NEW_CALENDAR_EVENT",(function(e,t,n,r){return void 0===n&&(n=function(){}),void 0===r&&(r=function(){}),Object(d.c)({name:"CreateEvent",customData:b(e)},{event:e,actionSource:t,onSuccess:n,onError:r})})),m=Object(u.action)("SHARE_TXP_CALENDAR_EVENT",(function(e,t,n,r,i,a,c){return void 0===a&&(a=function(){}),void 0===c&&(c=function(){}),{itemId:e,requestBody:t,actionSource:n,isOrganizer:r,isMeeting:i,onSuccess:a,onError:c}})),I=Object(u.action)("selectCalendarFromEvent",(function(e){return{parentFolderId:e}}));Object(u.orchestrator)(v,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.itemId,n=e.addSeries,[4,s(t,n)];case 1:return r.sent(),[2]}}))}))}));var g=n(4598),h=n(11),E=n(1584),y=n(4246),S=n(3967),R=n(350);var w=n(269),C=n(1306),T=n(1229),x=n(2016),D=n(685),A=n(1415),B=n(5562);function M(e){A.f.import().then((function(t){t("instantCalendarEventCreate",e,Object(h.b)(B.a),{icon:"CheckMark"})}))}var P=n(1606);function F(e){var t=typeof e;return"object"===t&&e.message?e.message:"string"==t?e:null}function q(e,t,n){t&&A.g.import().then((function(r){r("instantCalendarEventDeleteFailed",n,function(e){var t=F(e);return t||Object(h.b)(g.a)}(e),Object(h.b)(P.a),(function(){return t()}),"Delete",A.a.Retry)}))}var N=n(4597);function U(e,t,n){A.g.import().then((function(r){r("instantCalendarEventCreateFailed",n,function(e){var t=F(e);return t||Object(h.b)(N.a)}(e),Object(h.b)(P.a),(function(){return null==t?void 0:t()}),"Error",A.a.Retry)}))}var k=n(3745);function L(e,t,n){t&&A.g.import().then((function(r){r("updateCalendarEventFailed",n,function(e){var t=F(e);return t||Object(h.b)(k.a)}(e),Object(h.b)(P.a),(function(){return t()}),"Error",A.a.Retry)}))}var H=n(5563);var V=n(5564),Z=n(233);function J(e,t,n){var r=function(e,t){var n;switch(e){case"Accept":n=Object(h.b)(V.a);break;case"Tentative":n=t?Object(h.b)(V.e):Object(h.b)(V.d);break;case"Decline":n=t?Object(h.b)(V.c):Object(h.b)(V.b);break;default:Object(Z.a)(e)}return n}(t,n);A.f.import().then((function(t){t("respondToEvent",e,r,{icon:"CalendarReply"})}))}var z=n(2238),W=n(5565);function G(e,t,n){var r=Object(h.b)(W.c);return e.IsMeeting&&t&&!e.IsCancelled&&(r=e.IsOrganizer?Object(h.b)(W.a):Object(h.b)(W.b)),new Promise((function(e,t){A.f.import().then((function(t){t("instantCalendarEventDelete",n,r,{icon:"Error",primaryActionHotKeyCommand:A.a.Undo},{primaryActionText:Object(h.b)(z.a),notificationCallback:function(t){t===A.b.PrimaryActionClicked?e(!0):e(!1)}})}))}))}function K(e,t,n,i,a,c,o,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u=this;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return i=i||0,s&&s.addCustomData({CancelSeries:i.toString(),CancellationMessageLength:o?o.length.toString():"n/a"}),[4,new Promise((function(o,d){Object(T.s)(e,i,s,(function(e){return Object(r.__awaiter)(u,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,t(e)];case 1:return i=r.sent(),(o="Success"==i.ResponseClass)&&Object(C.d)("Cancel",n,a,c),[2,{isSuccessful:o}]}}))}))}),o,(function(e,t,n){q(e,t,n),d(e)}),n,Object(h.b)(g.a),void 0,G)}))];case 1:return d.sent(),[2]}}))}))}Object(u.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,o,s,u,d,l;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:return t=e.itemId,n=e.actionSource,i=e.cancellationMessage,a=e.eventScope,o=e.onCancel,s=Object(w.r)(),[4,x.a.import()];case 1:return b.sent()("MeetingCanceled"),u=Object(T.k)(t.Id),d=u.IsOrganizer,l=u.IsMeeting,o&&o(),s&&s.addCustomData({CalendarItemType:u.CalendarItemType}),[4,K(t,(function(e){return function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return a={Header:Object(R.a)(),Body:Object(S.a)({EventId:e,EventScope:t})},i&&(a.Body.Notes=Object(E.a)({BodyType:"HTML",Value:i})),[4,Object(y.a)(a,Object(c.a)(n))];case 1:return[2,r.sent().Body]}}))}))}(e,a,t.mailboxInfo,i)}),n,a,d,l,i,s)];case 2:return b.sent(),Object(D.v)()&&window.opener&&window.close(),[2]}}))}))}));var Q=n(2588),$=n(2514);function X(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=t?Object($.a)({EventId:e,EventScope:t}):Object($.a)({EventId:e}),[4,Object(Q.a)({Header:Object(R.a)(),Body:i},Object(c.a)(n))];case 1:return[2,r.sent().Body]}}))}))}var Y=n(31),ee=n(687);function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,(r=e,i=Object(c.a)(t),void 0===r||r.__type||(r=Object(ee.a)(r)),Object(Y.a)("RemoveBirthdayEvent",r,i))];case 1:return n.sent().WasSuccessful?[2,{ResponseClass:"Success"}]:[2,{ResponseClass:"Error"}]}var r,i}))}))}var ne=n(1192),re=n(69),ie=new re.c((function(){return Promise.all([n.e(1),n.e(7),n.e(8),n.e(17),n.e(18),n.e(170),n.e(601)]).then(n.bind(null,16501))})),ae=new re.a(ie,(function(e){return e.deleteEventTravelBookends})),ce=new re.a(ie,(function(e){return e.updateEventTravelBookends})),oe=(Object(re.d)(ie,(function(e){return e.MobilityDropdown})),n(84));Object(u.orchestrator)(O,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,c,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return t=e.item,n=e.eventScope,i=e.actionSource,a=e.onDelete,(c=Object(w.r)())&&c.addCustomData({isGroupMailbox:"GroupMailbox"==t.ItemId.mailboxInfo.type,CalendarItemType:t.CalendarItemType}),o=Object(ne.w)(t)?function(e){return te(e,t.ItemId.mailboxInfo)}:function(e){return X(e,n,t.ItemId.mailboxInfo)},a&&a(),[4,new Promise((function(e,a){Object(T.s)(t.ItemId,n,c,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,o(e)];case 1:return a=r.sent(),(c="Success"==a.ResponseClass)&&(Object(C.d)("Delete",i,t.IsOrganizer,t.IsMeeting),!Object(oe.i)("cal-mf-mobility")||1!=n&&0!=n||ae.importAndExecute(t)),[2,{isSuccessful:c}]}}))}))}),e,(function(e,t,n){q(e,t,n),a(e)}),i,void 0,void 0,G)}))];case 1:return s.sent(),Object(D.v)()&&window.opener&&window.close(),[2]}}))}))}));var se=n(2337);var ue=n(2338),de=n(532),le=n(603),be=n(1267),ve=n(1854),fe=n(1942);function Oe(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,a,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return t=Object(le.a)({BaseShape:"IdOnly"}),(n=Object(ve.c)(e)).InstanceKey=void 0,i=Object(be.a)({BaseFolderId:Object(de.a)({Id:e.ParentFolderId.Id})}),a=Object(ue.a)(Object(r.__assign)({Items:[n],SavedItemFolderId:i,ClientSupportsIrm:!0,UnpromotedInlineImageCount:0,ItemShape:t,SendMeetingInvitations:"SendToNone"},Object(fe.a)())),(o=Object(R.a)()).TimeZoneContext.TimeZoneDefinition.Id=e.StartTimeZoneId,[4,(u={Header:o,Body:a},d=Object(c.a)(e.ParentFolderId.mailboxInfo),void 0===u||u.__type||(u=Object(se.a)(u)),Object(Y.a)("CreateCalendarEvent",u,d))];case 1:return[2,s.sent().Body.ResponseMessages.Items[0]]}var u,d}))}))}function je(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"RespondToCalendarEventJsonRequest:#Exchange"},n)),Object(Y.a)("RespondToCalendarEvent",e,t)}Object(u.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,c,o,s,u,d,l;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:t=e.event,n=e.actionSource,i=e.onSuccess,a=e.onError,(c=Object(w.r)())&&c.addCustomData({isRecurrence:!!t.Recurrence}),b.label=1;case 1:return b.trys.push([1,3,,4]),o=function(e){var t={};t.FreeBusyType=e.FreeBusyType,t.ParentFolderId=e.ParentFolderId,t.Sensitivity=e.Sensitivity,t.Subject=e.Subject,t.Body=e.Body,t.Start=e.Start,t.End=e.End,t.IsAllDayEvent=e.IsAllDayEvent,t.IsRoomRequested=e.IsRoomRequested,t.ReminderMinutesBeforeStart=e.ReminderMinutesBeforeStart,t.ReminderIsSet=e.ReminderIsSet,t.CharmId=e.CharmId,t.Resources=e.Resources,t.Locations=e.Locations,t.IsDraft=e.IsDraft,t.DoNotForwardMeeting=e.DoNotForwardMeeting,t.IsResponseRequested=e.IsResponseRequested,t.StartTimeZoneId=e.StartTimeZoneId,t.EndTimeZoneId=e.EndTimeZoneId,t.HideAttendees=e.HideAttendees,t.MeetingNotesWebUrl=e.MeetingNotesWebUrl,t.SkypeTeamsProperties=e.SkypeTeamsProperties,t.AppendOnSend=e.AppendOnSend,t.IsBookedFreeBlocks=e.IsBookedFreeBlocks,t.AssociatedTasks=e.AssociatedTasks,t.CollabSpace=e.CollabSpace,e.Recurrence&&(t.Recurrence=e.Recurrence);e.IsOnlineMeeting&&(t.IsOnlineMeeting=e.IsOnlineMeeting);e.OnlineMeetingProvider&&(t.OnlineMeetingProvider=e.OnlineMeetingProvider);e.DocLinks&&(t.DocLinks=e.DocLinks);e.RequiredAttendees&&e.RequiredAttendees.length>0&&(t.RequiredAttendees=e.RequiredAttendees);e.OptionalAttendees&&e.OptionalAttendees.length>0&&(t.OptionalAttendees=e.OptionalAttendees);e.InboxReminders&&e.InboxReminders.length>0&&(t.InboxReminders=e.InboxReminders);e.Categories&&e.Categories.length>0&&(t.Categories=e.Categories);return t}(t),[4,new Promise((function(e,r){Object(T.r)(o,(function(e){var n=Oe(e);return c&&c.markUserPerceivedTime(),n.then((function(n){var r="Success"==n.ResponseClass&&n.Items&&n.Items.length>0;return r&&I(e.ParentFolderId.Id),{isSuccessful:r,createdItem:r?Object(ve.a)(n.Items[0],t.ParentFolderId.mailboxInfo):null}}))}),e,(function(e,t,n){U(e,t,n),r(e)}),n,Object(h.b)(N.a),M)}))];case 2:return s=b.sent(),u=s.ItemId.Id,d=Object(r.__assign)(Object(r.__assign)({},t),{ItemId:{Id:u,mailboxInfo:s.ParentFolderId.mailboxInfo}}),i(d),[3,4];case 3:throw l=b.sent(),a(l),l;case 4:return[2]}}))}))}));var _e=n(726);function pe(e,t,n,i,a,o,s,u){return void 0===a&&(a=""),void 0===o&&(o=""),void 0===s&&(s=""),void 0===u&&(u=""),Object(r.__awaiter)(this,void 0,void 0,(function(){var d,l;return Object(r.__generator)(this,(function(b){switch(b.label){case 0:d={Header:Object(R.a)(),Body:(v={EventId:e,Response:n,SendResponse:i,Notes:Object(E.a)({BodyType:"HTML",Value:a}),ProposedStartTime:o,ProposedEndTime:s,MeetingRequestIdToBeDeleted:u},Object(r.__assign)({__type:"RespondToCalendarEventRequest:#Exchange"},v))},b.label=1;case 1:return b.trys.push([1,,3,4]),[4,je(d,Object(c.a)(t))];case 2:return l=b.sent(),[3,4];case 3:return Object(oe.i)("cal-mf-diagnostics")&&Object(_e.a)({action:"RespondToCalendarEvent",status:l?l.Body.ResponseCode:"Error",response:null==l?void 0:l.Body,request:d}),[7];case 4:return[2,null==l?void 0:l.Body]}var v}))}))}var me=n(9),Ie="Accept",ge="Decline";function he(e,t,n,i,a,c,o,s,u,d,l,b,v,f){return Object(r.__awaiter)(this,void 0,void 0,(function(){var O,j=this;return Object(r.__generator)(this,(function(_){switch(_.label){case 0:return f&&f.addCustomData({ResponseType:n,SendResponse:o.toString(),ResponseMessageLength:b?b.length:"n/a",ShowingDeclinedEvents:v,IsEditRSVP:["Accept","Tentative","Decline"].includes(t),IsProposeNewTime:!!l}),n!=ge||Object(oe.i)("cal-surface-declinedMeetings")?[3,2]:[4,new Promise((function(t,i){Object(T.s)(e,a,f,(function(e){return Object(r.__awaiter)(j,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Ee(e,c,null)];case 1:return(t=r.sent()).isSuccessful&&(l?Object(C.d)("ProposeNewTime",s,u,d,[n]):Object(C.d)("Decline",s,u,d),J(s,n,!!l)),[2,t]}}))}))}),t,(function(e,t,n){q(e,t,n),i(e)}),s,Object(h.b)(k.a),o,G)}))];case 1:return _.sent(),[3,4];case 2:return O=Object(T.j)(i,t,n),[4,new Promise((function(t,i){Object(T.t)(e,O,a,(function(e){return Object(r.__awaiter)(j,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Ee(e,c,f)];case 1:return(t=r.sent()).isSuccessful&&(l?Object(C.d)("ProposeNewTime",s,u,d,[n]):n==Ie?Object(C.d)("Accept",s,u,d):n==ge?Object(C.d)("Decline",s,u,d):Object(C.d)("Tentative",s,u,d),J(s,n,!!l)),[2,t]}}))}))}),t,(function(e,t,n){L(e,t,n),i(e)}),s)}))];case 3:_.sent(),_.label=4;case 4:return[2]}}))}))}function Ee(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=t(e),n&&n.markUserPerceivedTime(),[4,i];case 1:return[2,{isSuccessful:"Success"==r.sent().ResponseClass}]}}))}))}Object(u.orchestrator)(j,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,c,o,s,u,d,l,b,v,f,O,j,_,p;return Object(r.__generator)(this,(function(r){return t=e.actionSource,n=e.itemId,i=e.proposeNewTime,a=e.eventScope,c=e.responseMessage,o=e.currentResponseType,s=e.newResponseType,u=e.currentFreeBusyType,d=e.sendResponse,l=e.showingDeclinedEvents,b=e.meetingMessageId,v=Object(w.r)((function(e){return"RespondToEvent"==e.eventName})),f=Object(T.k)(n.Id),O=f.IsOrganizer,j=f.IsMeeting,_="Exception"==f.CalendarItemType,(p=[]).push(he(n,o,s,u,a,(function(e){return pe(e,n.mailboxInfo,s,d,c,i?Object(me.qb)(i.Start):"",i?Object(me.qb)(i.End):"",b)}),d,t,O,j,i,c,l,v)),!_||3!==a||s!=Ie&&"Tentative"!=s||p.push(he(n,o,s,u,0,(function(e){return pe(e,n.mailboxInfo,s,!1,null,i?Object(me.qb)(i.Start):"",i?Object(me.qb)(i.End):"",b)}),!1,t,O,j,i,null,l,null)),Promise.all(p).then((function(e){Object(D.v)()&&window.opener&&window.close()})),[2]}))}))}));function ye(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ShareTailoredExperienceEventJsonRequest:#Exchange"},n)),Object(Y.a)("ShareTailoredExperienceEvent",e,t)}function Se(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){var i;return[2,ye({Header:Object(R.a)(),Body:(i=Object(r.__assign)({EventId:Object(T.o)(e.Id,0)},t),Object(r.__assign)({__type:"ShareTailoredExperienceEventRequest:#Exchange"},i))},Object(c.a)(e.mailboxInfo)).catch((function(e){return null}))]}))}))}Object(u.orchestrator)(m,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,c,o,s,u,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:t=e.itemId,n=e.requestBody,i=e.actionSource,a=e.isOrganizer,c=e.isMeeting,o=e.onSuccess,s=e.onError,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Se(t,n)];case 2:return(null==(u=r.sent())?void 0:u.Body)&&"Success"===u.Body.ResponseClass?(Object(C.d)("TxpEventShared",i,a,c),o()):s(new Error('Failure response from server for shareTxtCalendarEvent for item "'+t.Id+'"')),[3,4];case 3:return d=r.sent(),s(d),[3,4];case 4:return[2]}}))}))}));var Re=n(4281),we=n(2890),Ce=n(1207),Te=n(417),xe=n(1720),De=n(1943),Ae=n(1575),Be=n(18),Me={Start:{getEwsValue:Pe},End:{getEwsValue:Pe},Subject:{},Body:{},IsAllDayEvent:{},IsRoomRequested:{},IsDraft:{},Locations:{},Recurrence:{getEwsValue:function(e,t){var n=Object(Be.toJS)(e);if(n){var r=n.RecurrenceRange,i=r.StartDate,a=r.EndDate;i&&(r.StartDate=Object(me.mb)(Object(me.Qb)(t,i))),a&&(r.EndDate=Object(me.mb)(Object(me.Qb)(t,a)))}return n},useDeleteItemField:!0},FreeBusyType:{fieldUri:"LegacyFreeBusyStatus"},ReminderMinutesBeforeStart:{},ReminderIsSet:{},CharmId:{fieldUri:"Charm",useDeleteItemField:!0},Sensitivity:{},Categories:{fieldUri:"Categories"},IsResponseRequested:{fieldUri:"CalendarIsResponseRequested"},DoNotForwardMeeting:{},RequiredAttendees:{},IsOnlineMeeting:{},OnlineMeetingProvider:{},OptionalAttendees:{},InboxReminders:{getEwsValue:function(e){return e&&0!==e.length?e:null},useDeleteItemField:!0},Resources:{},StartTimeZoneId:{},EndTimeZoneId:{},InReplyTo:{},HideAttendees:{},MeetingNotesWebUrl:{useDeleteItemField:!0},SkypeTeamsProperties:{},DocLinks:{},CollabSpace:{extendedPropertyUri:{DistinguishedPropertySetId:"PublicStrings",PropertyName:"MeetingAgenda",PropertyType:"String"}}};function Pe(e,t){return e?Object(me.qb)(Object(me.Qb)(t,e)):null}var Fe=n(98),qe=n(3919),Ne=n(3746);function Ue(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(qe.a)({Header:Object(R.a)(),Body:Object(Ne.a)({ToFolderId:Object(be.a)({BaseFolderId:Object(de.a)({Id:t.Id})}),ItemIds:[Object(ee.a)({Id:e.Id})]})},Object(c.a)(t.mailboxInfo))];case 1:return[2,n.sent().Body.ResponseMessages.Items[0]]}}))}))}function ke(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"UpdateBirthdayEventJsonRequest:#Exchange"},n)),Object(Y.a)("UpdateBirthdayEvent",e,t)}var Le=n(3968);function He(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a;return Object(r.__generator)(this,(function(o){switch(o.label){case 0:return i&&(i=i.map((function(e){return Object(Le.a)(e)}))),a=function(e){return Object(r.__assign)({__type:"UpdateBirthdayEventRequest:#Exchange"},e)}({PopupReminderSettings:n?[(s=n,Object(r.__assign)({__type:"PopupReminderSetting:#Exchange"},s))]:void 0,EmailReminderSettings:i,Id:e}),[4,ke({Header:Object(R.a)(),Body:a},Object(c.a)(t))];case 1:return[2,o.sent().Body]}var s}))}))}function Ve(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"UpdateCalendarEventJsonRequest:#Exchange"},n)),Object(Y.a)("UpdateCalendarEvent",e,t)}function Ze(e,t,n,i,a,o,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,d;return Object(r.__generator)(this,(function(l){switch(l.label){case 0:return b={EventId:t,ItemChange:i,EventScope:a},u=Object(r.__assign)({__type:"UpdateCalendarEventRequest:#Exchange"},b),o&&(u.ShouldSendUpdateToAttendees=!0),s&&(u.UpdateAsCoOrganizer=s),(d=Object(R.a)()).TimeZoneContext.TimeZoneDefinition.Id=e,[4,Ve({Header:d,Body:u},Object(c.a)(n))];case 1:return[2,l.sent().Body.ResponseMessages.Items[0]]}var b}))}))}var Je=n(1263),ze=n(1800);function We(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ForwardCalendarEventJsonRequest:#Exchange"},n)),Object(Y.a)("ForwardCalendarEvent",e,t)}function Ge(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(r.__generator)(this,(function(s){switch(s.label){case 0:return a={Header:Object(R.a)(),Body:(u={Forwardees:t.map((function(e){return Object(r.__assign)(Object(r.__assign)({},e.Mailbox),{RelevanceScore:0})})),Importance:"Normal",EventId:Object(T.o)(e.Id,i)},Object(r.__assign)({__type:"ForwardCalendarEventRequest:#Exchange"},u))},n&&(a.Body.Notes=Object(E.a)({BodyType:"HTML",Value:n})),[4,We(a,Object(c.a)(e.mailboxInfo))];case 1:return[2,"Success"===(o=s.sent()).Body.ResponseClass?o:null]}var u}))}))}Object(u.orchestrator)(_,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,a,c,o,s,u,d,l,b,v,f,O,j,_;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:if(t=e.event,n=e.calendarItemUpdates,i=e.actionSource,a=e.eventScope,c=e.onSuccess,o=e.onError,s=e.showNotification,u=e.updateAsCoOrganizer,!n)return c(),[2];d=Object(ne.w)(t),(l=Object(w.r)())&&l.addCustomData({updateRecurrence:a&&(!!n.Start||!!n.End)||!!n.Recurrence,isBirthdayEvent:d}),p.label=1;case 1:return p.trys.push([1,3,,4]),b=n.StartTimeZoneId||t.StartTimeZoneId,v=n.EndTimeZoneId||t.EndTimeZoneId,f=d?Object(Fe.p)():b,O=Object.keys(n).map((function(e){return function(e,t,n){var r,i=Me[e];if(i){if(i.extendedPropertyUri){var a={ExtendedFieldURI:i.extendedPropertyUri,Value:t};return Object(De.a)({Path:Object(Te.a)(a.ExtendedFieldURI),Item:Object(Ae.a)({ExtendedProperty:[Object(xe.a)(a)]})})}var c=i.fieldUri,o=void 0===c?e:c,s=i.getEwsValue,u=i.useDeleteItemField,d=Object(Ce.a)({FieldURI:o}),l=s?s(t,n):t;return!u||l?Object(De.a)({Path:d,Item:Object(Re.a)((r={},r[e]=l,r))}):Object(we.a)({Path:d})}return null}(e,n[e],"End"===e?v:f)})).filter((function(e){return!!e})),Object(C.d)("EventEdited",i,t.IsOrganizer,t.IsMeeting,O.map((function(e){return e.Path.FieldURI}))),j=d?function(e,t,n){var i=this;return function(a){return Object(r.__awaiter)(i,void 0,void 0,(function(){var i,c,o,s,u,d,l,b,v,f,O;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i="Success",e&&e.markUserPerceivedTime(),(c=Object(Je.a)(n,(function(e){return"ReminderIsSet"==e.Path.FieldURI})))&&(o=n[c.index].Item.ReminderIsSet),(s=Object(Je.a)(n,(function(e){return"ReminderMinutesBeforeStart"==e.Path.FieldURI})))&&(u=n[s.index].Item.ReminderMinutesBeforeStart),(d=Object(Je.a)(n,(function(e){return"InboxReminders"==e.Path.FieldURI})))&&(l=null!==(O=null===(f=null===(v=d.item)||void 0===v?void 0:v.Item)||void 0===f?void 0:f.InboxReminders)&&void 0!==O?O:null),n.length>0&&(c&&s||d)?[4,He(a,t.mailboxInfo,c&&s?{IsReminderSet:o,ReminderMinutesBeforeStart:u}:void 0,l)]:[3,2];case 1:return[2,{isSuccessful:(b=r.sent()).ResponseClass==i&&null!=b.BirthdayEvent}];case 2:return[2,{isSuccessful:!0}]}}))}))}}(l,t.ItemId,O):function(e,t,n,i,a,c,o){var s=this,u=!!a.Attachments;return function(d){return Object(r.__awaiter)(s,void 0,void 0,(function(){var s,l,b,v,f,O,j;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s="Success",l=d,t&&t.markUserPerceivedTime(),a.ParentFolderId?[4,Ue(n,a.ParentFolderId)]:[3,2];case 1:if((null==(b=r.sent())?void 0:b.ResponseClass)!=s||0==(null===(O=null==b?void 0:b.Items)||void 0===O?void 0:O.length))return[2,{isSuccessful:!1}];l=(null==b?void 0:b.Items)?null===(j=null==b?void 0:b.Items[0])||void 0===j?void 0:j.ItemId:d,r.label=2;case 2:return c.length||u?(v=u,[4,Ze(e,l,n.mailboxInfo,Object(ze.a)({Updates:c,ItemId:l}),i,v,o)]):[3,4];case 3:return[2,{isSuccessful:(f=r.sent()).ResponseClass==s&&f.Items.length>0}];case 4:return[2,{isSuccessful:!0}]}}))}))}}(f,l,t.ItemId,a,n,O,u),[4,new Promise((function(e,r){Object(T.t)(t.ItemId,n,a,j,e,(function(e,t,n){L(e,t,n),r(e)}),i,Object(h.b)(k.a),s?function(){return function(e,t){var n=e.IsMeeting||e.RequiredAttendees.length>0||e.OptionalAttendees.length>0,r=n?Object(h.b)(H.b):Object(h.b)(H.a),i={icon:n?"Send":"Save"};setTimeout((function(){A.f.import().then((function(e){e("instantCalendarEventUpdate",t,r,i)}))}),0)}(t,i)}:function(){})}))];case 2:return p.sent(),Object(oe.i)("cal-mf-mobility")&&ce.importAndExecute(t,n),c(),[3,4];case 3:throw _=p.sent(),o(_),_;case 4:return[2]}}))}))})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return O})),n.d(t,"j",(function(){return j})),n.d(t,"k",(function(){return _})),n.d(t,"f",(function(){return p})),n.d(t,"g",(function(){return I})),n.d(t,"h",(function(){return Oe})),n.d(t,"e",(function(){return Ge})),n.d(t,"d",(function(){return X})),n.d(t,"i",(function(){return te}))},1575:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"Message:#Exchange"},e)}},1800:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemChange:#Exchange"},e)}},1829:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("setIsDeepLinkAction",(function(e){return{isDeepLink:e}}))},1942:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(29);function i(){var e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},1943:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"SetItemField:#Exchange"},e)}},2016:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(69),i=new r.c((function(){return Promise.all([n.e(17),n.e(1027)]).then(n.bind(null,3440))})),a=new r.b(i,(function(e){return e.logFloodgateActivity}))},2337:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemJsonRequest:#Exchange"},e)}},2338:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CreateItemRequest:#Exchange"},e)}},2890:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteItemField:#Exchange"},e)}},3746:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"MoveItemRequest:#Exchange"},e)}},3919:function(e,t,n){"use strict";var r=n(31),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"MoveItemJsonRequest:#Exchange"},n)),Object(r.a)("MoveItem",e,t)}n.d(t,"a",(function(){return a}))},3966:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"AddEventToMyCalendarRequest:#Exchange"},e)}},3967:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CancelCalendarEventRequest:#Exchange"},e)}},3968:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"InboxReminderType:#Exchange"},e)}},4246:function(e,t,n){"use strict";var r=n(31),i=n(0);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"CancelCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("CancelCalendarEvent",e,t)}n.d(t,"a",(function(){return a}))},4281:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"CalendarItem:#Exchange"},e)}},5083:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(31),i=n(3966);function a(e,t){return void 0===e.request||e.request.__type||(e.request=Object(i.a)(e.request)),Object(r.a)("AddEventToMyCalendar",e,t)}},5562:function(e){e.exports=JSON.parse('{"a":"kxa"}')},5563:function(e){e.exports=JSON.parse('{"b":"_xa","a":"$xa"}')},5564:function(e){e.exports=JSON.parse('{"a":"pxa","d":"qxa","e":"rxa","b":"sxa","c":"txa"}')},5565:function(e){e.exports=JSON.parse('{"c":"lxa","a":"mxa","b":"nxa"}')}}]);
//# sourceMappingURL=owa.MailBoot~CalendarBoot~CalendarCard~CalendarItemContextMenu~CalendarItemModal~CalendarModuleLazy~Cale~be089034.js.map
self.scriptsLoaded['owa.MailBoot~CalendarBoot~CalendarCard~CalendarItemContextMenu~CalendarItemModal~CalendarModuleLazy~Cale~be089034.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarBoot~CalendarCard~CalendarItemContextMenu~CalendarItemModal~CalendarModuleLazy~Cale~be089034.js'] = (new Date()).getTime();