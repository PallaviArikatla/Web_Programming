self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupEditV2Opx~MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFo~78df965d.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[37],{1214:function(e,t,r){"use strict";r.r(t);var n=r(69),o=r(3),a=r(2614),i=r(9188),u=r(9189),c=r(9190);Object(o.mutator)(a.a,(function(e){var t=e.temporaryData,r=e.favoriteData;Object(u.a)(t),Object(c.b)(t),Object(i.a)(r)})),Object(o.mutator)(a.c,(function(e){var t=e.favoriteData;Object(i.a)(t),Object(c.a)(t)})),Object(o.mutator)(a.d,(function(e){var t=e.favoriteData;Object(i.a)(t)})),Object(o.mutator)(a.b,(function(e){var t=e.favoriteData;Object(c.b)(t),Object(u.a)(t)})),Object(o.mutator)(a.e,(function(e){var t=e.temporaryFavorites,r=e.favoritesData;t.forEach((function(e){Object(u.a)(e)})),r.forEach((function(e){Object(i.a)(e)}))})),Object(o.mutator)(a.f,(function(e){e.favoritesData.forEach((function(e){Object(i.a)(e)}))}));var s=r(2022),d=Object(o.action)("ADD_TO_ORDERED_FAVORITE_ID_LIST",(function(e){return{favoriteId:e}})),l=(Object(o.mutator)(d,(function(e){s.a.orderedOutlookFavoritesIds.push(e.favoriteId)})),r(7467)),f=(Object(o.mutator)(l.a,(function(e){s.a.favoritesLoaded=!0})),r(0)),v=Object(o.action)("ADD_NEW_MAILBOX_DEFAULT_FAVORITES"),b=r(1190),p=r(1185),O=r(3333);function F(e,t,r){return{folderId:t.FolderId.Id,treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(p.i)(t),client:r?"MigrateDefault":"OWA"}}function y(e,t){return{Type:"folder",DisplayName:Object(p.i)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(le.a)(e.FolderId.Id)}],Client:t?"MigrateDefault":"OWA"}}var m=r(351),j=r(5109),g=r(311),I=r(5596);function h(e){return Object(I.a)((function(){return Object(g.d)(j.a+"/Create",e,void 0,!0,null,!0)}))}Object(o.orchestrator)(v,(function(e){return Object(f.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,n,o,i,u,c,s,d,l,v,j,g,I;return Object(f.__generator)(this,(function(S){switch(S.label){case 0:e=[Object(b.a)("inbox"),Object(b.a)("drafts"),Object(b.a)("archive")],t=[],r=[];try{for(n=Object(f.__values)(e),o=n.next();!o.done;o=n.next())i=o.value,u=Object(m.a)(),c=p.d.folderTable.get(i),s=y(c,!0),d=F(u,c,!0),t.push(s),r.push(d)}catch(e){g={error:e}}finally{try{o&&!o.done&&(I=n.return)&&I.call(n)}finally{if(g)throw g.error}}S.label=1;case 1:return S.trys.push([1,3,,4]),[4,h(t)];case 2:return l=S.sent(),v=(l.value||[]).map((function(e){return Object(O.a)(e,"folder")})),Object(a.e)(r,v),[3,4];case 3:return j=S.sent(),r.forEach((function(e){return Object(a.b)(j,e)})),[3,4];case 4:return[2]}}))}))}));var S=r(2247),w=r(9191),A=r(29),N=r(2796),D=r(7468),_=r(61),C=Object(o.action)("MIGRATE_OUTLOOK_FAVORITES",(function(){return Object(_.c)(D.a.MigrateOutlookFavorites)})),T=r(638),E=r(84),V=r(269),k=r(4663);var M=r(76),P=r(1274),L=["en-us","en-ca","en-in","en-au","pt-br","es-mx"];function R(){var e,t=Object(A.a)(),r=null===(e=null==t?void 0:t.SessionSettings)||void 0===e?void 0:e.UserCulture,n=L.some((function(e){return e===(null==r?void 0:r.toLowerCase())}));return Object(E.i)("tri-newsDev")||(Object(E.i)("tri-news")||Object(E.i)("tri-newsCompact"))&&!t.SessionSettings.IsPremiumConsumerMailbox&&!t.IsConsumerChild&&!Object(M.g)()&&!Object(P.a)(1024)&&n}var z=36e5;function K(){return Object(f.__awaiter)(this,void 0,void 0,(function(){var e,t,r;return Object(f.__generator)(this,(function(n){switch(n.label){case 0:return s.a.favoritesLoaded?[2]:(0===p.d.folderTable.size&&Object(p.w)(),[4,U()]);case 1:return n.sent(),e=Object(k.a)(2),t=Object(k.a)(16),r=R()&&!Object(k.a)(32),t||C(),e||(0==s.a.orderedOutlookFavoritesIds.length&&(y=new Date(Object(A.a)().MailboxCreateDate),Date.now()-y.getTime()<z)&&v(),Le.importAndExecute(2)),r&&(Me.importAndExecute("Auto"),Le.importAndExecute(32)),Object(l.a)(),o=Object(f.__spread)(s.a.outlookFavorites.values()),a=o.filter((function(e){return"folder"===e.type})),i=a.filter((function(e){return"Migration"===e.client})),u=o.filter((function(e){return"category"===e.type})),c=u.filter((function(e){return"Migration"==e.client})),d=o.filter((function(e){return"persona"===e.type})),b=d.filter((function(e){return"Migration"==e.client})),O=o.filter((function(e){return"group"===e.type})),F=o.filter((function(e){return"privatedistributionlist"===e.type})),Object(V.p)("LoadOutlookFavorites",[a.length,O.length,u.length,d.length,F.length,i.length,c.length,b.length]),[2]}var o,a,i,u,c,d,b,O,F,y}))}))}function U(){var e,t;return Object(f.__awaiter)(this,void 0,void 0,(function(){var r,n,o,i,u;return Object(f.__generator)(this,(function(c){switch(c.label){case 0:if(r=Object(A.a)(),n=null===(e=Object(N.a)())||void 0===e?void 0:e.value,o=null===(t=null==r?void 0:r.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon,n||o)return[3,5];i=void 0,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Object(g.b)(j.a,void 0,!1,void 0,!0)];case 2:return i=c.sent(),[3,4];case 3:return u=c.sent(),Object(V.p)("GetOutlookFavoritesRetryFailed",{errorMessage:u.toString()}),[2];case 4:if(!(n=null==i?void 0:i.value))return[2];Object(V.p)("FavoritesRetrySuccess"),c.label=5;case 5:return null==n||n.forEach((function(e){var t=e.Type.toLocaleLowerCase(),r=null;try{switch(r=Object(O.a)(e,t),t){case"folder":!function(e,t){(function(e,t){if(0===p.d.folderTable.size)return!1;return!s.a.outlookFavorites.has(e)&&p.d.folderTable.has(t)})(t,e.folderId)&&Object(a.d)(e)}(r,e.SingleValueSettings[0].Value);break;case"persona":Object(a.d)(r);break;case"group":!function(e){Object(W.d)(e.groupId)||Object(a.d)(e)}(r);break;case"category":!function(e){(function(e){return Object(T.q)(e.categoryId)&&!s.a.outlookFavorites.has(e.favoriteId)})(e)&&(Object(a.d)(e),T.z.importAndExecute())}(r);break;case"privatedistributionlist":Object(E.i)("peo-favoritePdls")&&Object(a.d)(r);break;case"news":R()&&Object(a.d)(r);break;default:d(r.favoriteId)}}catch(e){Object(V.p)("AddFavoriteToStoreInitialFailed",{favoriteType:t,errorMessage:e.toString()})}})),[2]}}))}))}Object(o.orchestrator)(S.a,(function(e){Object(E.i)("tri-favorites-roaming")?K():Object(w.a)()}));var x=r(3183),W=r(3026),G=r(3334);function B(){var e=Object(s.b)();return Object(E.i)("tri-favorites-roaming")?Object(f.__spread)(e.outlookFavorites.entries()).filter((function(e){var t=Object(f.__read)(e,2);t[0];return"persona"===t[1].type})).map((function(e){var t=Object(f.__read)(e,2),r=t[0];t[1];return r})):Object(f.__spread)(e.favoritesPersonaNodes.keys())}function J(e){var t=Object(s.b)();return Object(E.i)("tri-favorites-roaming")?t.outlookFavorites.get(e):t.favoritesPersonaNodes.get(e)}function q(e){var t=J(e);return t?t.mainEmailAddress:null}function Y(e){var t=J(e);return t?t.displayName:null}var $=r(5110),Q=r(4307),X=r(11),H=r(2188),Z=r(47),ee=r(1),te=Object(Z.a)((function(e){var t,r=e.isInFavorites,n=e.isClickDisabled,o=e.animate,a=e.iconStyles,i=e.buttonStyles,u=e.spinnerStyles,c=e.tooltipStyles,s=e.onClick,d=Object(A.a)();return(null===(t=null==d?void 0:d.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)?null:ee.createElement(H.a,{isStarred:r,onClick:s,isClickDisabled:n,animate:o,iconStyles:a,buttonStyles:i,spinnerStyles:u,tooltipStyles:c,ariaLabelText:r?Object(X.b)(Q.a):Object(X.b)($.a),tooltip:{starred:Object(X.b)(Q.a),unstarred:Object(X.b)($.a)}})})),re=r(5597),ne=r(5510),oe=r(6713),ae=r(7469),ie=r(4308),ue=r(4309),ce=r(6715);function se(e){return Object(E.i)("tri-favorites-roaming")?Object(f.__spread)(s.a.outlookFavorites.values()).filter((function(e){return"persona"===e.type})).some((function(t){return t.searchFolderId&&t.searchFolderId===e})):Object(f.__spread)(s.a.favoritesPersonaNodes.values()).some((function(t){return t.searchFolderId&&t.searchFolderId===e}))}function de(e){return!!Object(E.i)("tri-favorites-roaming")&&Object(f.__spread)(s.a.outlookFavorites.values()).filter((function(e){return"privatedistributionlist"===e.type})).some((function(t){return t.searchFolderId&&t.searchFolderId===e}))}var le=r(5108),fe=r(6714),ve=r(6716),be=r(7470),pe=r(5598),Oe=r(7472),Fe=r(6717),ye=r(9192);function me(e,t){return function(e){var t=Object(f.__spread)(s.a.outlookFavorites.values()).filter((function(t){return"privatedistributionlist"===t.type&&t.pdlId===e}));return t.length>0?t[0].favoriteId:void 0}(e)||function(e){var t=Object(f.__spread)(s.a.outlookFavorites.values()).filter((function(t){return"privatedistributionlist"===t.type&&Object(ye.a)(t.members,e)}));return t.length>0?t[0].favoriteId:void 0}(t)}r.d(t,"lazyMigrateFavorites",(function(){return ge})),r.d(t,"lazyMoveFavoriteUpDown",(function(){return Ie})),r.d(t,"lazyUpdateFavoritePosition",(function(){return he})),r.d(t,"lazyAddFavoriteCategory",(function(){return Se})),r.d(t,"lazyRemoveFavoriteCategory",(function(){return we})),r.d(t,"lazyRemoveFavoritePersonaV2",(function(){return Ae})),r.d(t,"lazyAddFavoritePersonaV2",(function(){return Ne})),r.d(t,"lazyRemoveFavoriteGroup",(function(){return De})),r.d(t,"lazyAddFavoriteGroup",(function(){return _e})),r.d(t,"lazyRemoveFavoriteFolderV2",(function(){return Ce})),r.d(t,"lazyAddFavoriteFolderV2",(function(){return Te})),r.d(t,"lazyRemoveFavoritePrivateDistributionList",(function(){return Ee})),r.d(t,"lazyAddFavoritePrivateDistributionList",(function(){return Ve})),r.d(t,"lazyEditFavoritePrivateDistributionList",(function(){return ke})),r.d(t,"lazyAddNewsFavorite",(function(){return Me})),r.d(t,"lazyRemoveNewsFavorite",(function(){return Pe})),r.d(t,"lazySetOutlookFavoritesBitFlag",(function(){return Le})),r.d(t,"lazyAddFavoriteToStore",(function(){return Re})),r.d(t,"lazyAddFavoriteCompleted",(function(){return ze})),r.d(t,"lazyAddFavoriteFailed",(function(){return Ke})),r.d(t,"lazyAddMultipleFavoritesToStore",(function(){return Ue})),r.d(t,"lazyAddMultipleFavoritesCompleted",(function(){return xe})),r.d(t,"lazyRemoveFavoriteFromStore",(function(){return We})),r.d(t,"lazyRemoveFavoriteCompleted",(function(){return Ge})),r.d(t,"lazyRemoveFavoriteFailed",(function(){return Be})),r.d(t,"addFavoriteFailed",(function(){return a.b})),r.d(t,"addFavoriteToStoreInitial",(function(){return a.d})),r.d(t,"removeFavoriteFailed",(function(){return x.b})),r.d(t,"getStore",(function(){return s.b})),r.d(t,"favoritesStore",(function(){return s.a})),r.d(t,"loadFavorites",(function(){return S.a})),r.d(t,"isFolderInFavorites",(function(){return W.c})),r.d(t,"isGroupInFavorites",(function(){return W.d})),r.d(t,"isPersonaInFavorites",(function(){return W.f})),r.d(t,"isSearchInFavorites",(function(){return W.i})),r.d(t,"isCategoryInFavorites",(function(){return W.b})),r.d(t,"isPublicFolderInFavorites",(function(){return W.h})),r.d(t,"isPrivateDLInFavorites",(function(){return W.g})),r.d(t,"getPersonaFromPersonIdOrEmailAddress",(function(){return W.a})),r.d(t,"isNewsInFavorites",(function(){return W.e})),r.d(t,"isNewsEnabled",(function(){return R})),r.d(t,"isOutlookFavoritingInProgress",(function(){return G.a})),r.d(t,"getFavoriteIdsForPersonaFavorites",(function(){return B})),r.d(t,"getFavoritePersonaEmail",(function(){return q})),r.d(t,"getFavoritePersonaDisplayName",(function(){return Y})),r.d(t,"ToggleFavoriteButton",(function(){return te})),r.d(t,"parseFavoriteNode",(function(){return re.a})),r.d(t,"updateFavoritesUserOption",(function(){return ne.a})),r.d(t,"getIsBitEnabled",(function(){return k.a})),r.d(t,"getFavoriteIdFromGroupId",(function(){return oe.a})),r.d(t,"editOutlookFavoriteService",(function(){return ae.a})),r.d(t,"createOutlookFavoriteService",(function(){return ie.a})),r.d(t,"deleteOutlookFavoriteService",(function(){return ue.a})),r.d(t,"getFavoriteIdFromFolderId",(function(){return ce.a})),r.d(t,"isFolderPersonaFavoriteSearchFolder",(function(){return se})),r.d(t,"isFolderPrivateDLFavoriteSearchFolder",(function(){return de})),r.d(t,"convertEWSFolderIdToRestFolderId",(function(){return le.a})),r.d(t,"convertRestFolderIdToEWSFolderId",(function(){return le.b})),r.d(t,"getFavoriteIdFromCategoryId",(function(){return fe.a})),r.d(t,"createMultipleOutlookFavoritesService",(function(){return h})),r.d(t,"createClientFavoriteCategoryData",(function(){return ve.a})),r.d(t,"createOwsFavoriteCategoryData",(function(){return ve.b})),r.d(t,"createOwsFavoriteFolderData",(function(){return be.a})),r.d(t,"migrateOutlookFavorites",(function(){return C})),r.d(t,"onCategoryFavorited",(function(){return pe.a})),r.d(t,"onCategoryUnfavorited",(function(){return pe.b})),r.d(t,"convertFavoritePersonaDataToFavoritePersonaNode",(function(){return Oe.a})),r.d(t,"convertFavoritePdlDataToFavoritePdlNode",(function(){return Fe.a})),r.d(t,"convertServiceResponseToFavoriteData",(function(){return O.a})),r.d(t,"getSingleValueSettingValueForKey",(function(){return O.b})),r.d(t,"getFavoriteIdForPDL",(function(){return me}));var je=new n.c((function(){return r.e(505).then(r.bind(null,16277))})),ge=new n.a(je,(function(e){return e.migrateFavorites})),Ie=new n.b(je,(function(e){return e.moveFavoriteUpDown})),he=new n.b(je,(function(e){return e.updateFavoritePosition})),Se=new n.b(je,(function(e){return e.addFavoriteCategory})),we=new n.b(je,(function(e){return e.removeFavoriteCategory})),Ae=new n.b(je,(function(e){return e.removeFavoritePersonaV2})),Ne=new n.b(je,(function(e){return e.addFavoritePersonaV2})),De=new n.b(je,(function(e){return e.removeFavoriteGroup})),_e=new n.b(je,(function(e){return e.addFavoriteGroup})),Ce=new n.b(je,(function(e){return e.removeFavoriteFolderV2})),Te=new n.b(je,(function(e){return e.addFavoriteFolderV2})),Ee=new n.b(je,(function(e){return e.removeFavoritePrivateDistributionList})),Ve=new n.b(je,(function(e){return e.addFavoritePrivateDistributionList})),ke=new n.b(je,(function(e){return e.editFavoritePrivateDistributionList})),Me=new n.a(je,(function(e){return e.addNewsFavorite})),Pe=new n.a(je,(function(e){return e.removeNewsFavorite})),Le=new n.a(je,(function(e){return e.setOutlookFavoritesBitFlag})),Re=new n.b(je,(function(e){return e.addFavoriteToStore})),ze=new n.b(je,(function(e){return e.addFavoriteCompleted})),Ke=new n.b(je,(function(e){return e.addFavoriteFailed})),Ue=new n.b(je,(function(e){return e.addMultipleFavoritesToStore})),xe=new n.b(je,(function(e){return e.addMultipleFavoritesCompleted})),We=new n.b(je,(function(e){return e.removeFavoriteFromStore})),Ge=new n.b(je,(function(e){return e.removeFavoriteCompleted})),Be=new n.b(je,(function(e){return e.removeFavoriteFailed}))},2022:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(18),o=r(3),a={favoritesFolderNodes:new n.ObservableMap,favoritesPersonaNodes:new n.ObservableMap,favoriteSearches:new n.ObservableMap,favoriteCategories:new n.ObservableMap,orderedFavoritesNodeIds:[],orderedOutlookFavoritesIds:[],outlookFavorites:new n.ObservableMap,favoriteSecondaryKeyMap:new n.ObservableMap,favoritingInProgressMap:new n.ObservableMap,favoritesLoaded:!1},i=Object(o.createStore)("favorites",a);t.a=i()},2614:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return d}));var n=r(3),o=r(61),a=Object(n.action)("addFavoriteCompleted",(function(e,t){return Object(o.c)({name:"AddFavoriteCompleted",customData:{temporaryFavoriteId:e.favoriteId,favoriteId:t.favoriteId,favoriteKind:t.type}},{temporaryData:e,favoriteData:t})})),i=Object(n.action)("addMultipleFavoritesCompleted",(function(e,t){return Object(o.c)({name:"AddMultipleFavoritesCompleted"},{temporaryFavorites:e,favoritesData:t})})),u=Object(n.action)("addFavoriteFailed",(function(e,t){return Object(o.c)({name:"AddFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})})),c=Object(n.action)("addFavoriteToStore",(function(e){return Object(o.c)({name:"AddFavoriteToStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),s=Object(n.action)("addFavoriteToStoreInitial",(function(e){return Object(o.c)({name:"AddFavoriteToStoreInitial",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),d=Object(n.action)("addMultipleFavoritesToStore",(function(e){return Object(o.c)({name:"AddMultipleFavoritesToStore"},{favoritesData:e})}))},3026:function(e,t,r){"use strict";r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return f})),r.d(t,"i",(function(){return v})),r.d(t,"b",(function(){return b})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return O})),r.d(t,"h",(function(){return F})),r.d(t,"e",(function(){return y})),r.d(t,"a",(function(){return m}));var n=r(0),o=r(2022),a=r(84),i=r(9192),u=r(6713),c=r(6714),s=r(6715),d=r(5107);function l(e){return Object(a.i)("tri-favorites-roaming")?!!Object(s.a)(e):Object(o.b)().favoritesFolderNodes.has(e)}function f(e){return!!Object(u.a)(e)}function v(e){return Object(a.i)("tri-favorites-roaming")?Object(n.__spread)(Object(o.b)().outlookFavorites.values()).filter((function(e){return"search"===e.type})).some((function(t){return t.searchQuery===e})):Object(o.b)().favoriteSearches.has(e)}function b(e){return Object(a.i)("tri-favorites-roaming")?!!Object(c.a)(e):Object(o.b)().favoriteCategories.has(e)}function p(e,t){return null!==m(e,t)}function O(e,t){return Object(n.__spread)(Object(o.b)().outlookFavorites.values()).filter((function(e){return"privatedistributionlist"===e.type})).some((function(r){return r.pdlId===e||Object(i.a)(r.members,t)}))}function F(e){return Object(o.b)().favoriteSecondaryKeyMap.has(e)}function y(){return Object(o.b)().favoriteSecondaryKeyMap.has(d.a)}function m(e,t){var r=Object(o.b)(),i=null;Object(a.i)("tri-favorites-roaming")?i=Object(n.__spread)(r.outlookFavorites.values()).filter((function(r){return"persona"===r.type&&j(r,e,t)})):i=Object(n.__spread)(r.favoritesPersonaNodes.values()).filter((function(r){return j(r,e,t)}));return i&&i.length>0?i[0]:null}function j(e,t,r){return t&&e.personaId===t||r&&e.allEmailAddresses&&e.allEmailAddresses.some((function(e){return e&&e.toLocaleLowerCase()===r.toLocaleLowerCase()}))}},3183:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return u}));var n=r(3),o=r(61),a=Object(n.action)("removeFavoriteCompleted",(function(e){return Object(o.c)({name:"RemoveFavoriteCompleted",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})})),i=Object(n.action)("removeFavoriteFailed",(function(e,t){return Object(o.c)({name:"RemoveFavoriteFailed",customData:{errorMessage:e?e.message:"Undefined error",cV:e?e.correlationVector:"Undefined error",favoriteId:t.favoriteId,favoriteKind:t.type}},{error:e,favoriteData:t,favoriteKind:t.type})})),u=Object(n.action)("removeFavoriteFromStore",(function(e){return Object(o.c)({name:"RemoveFavoriteFromStore",customData:{favoriteId:e.favoriteId,favoriteKind:e.type}},{favoriteData:e})}))},3333:function(e,t,r){"use strict";r.d(t,"b",(function(){return b})),r.d(t,"a",(function(){return O}));var n=r(5108),o="SearchFolderId",a="PersonaId",i="MainEmailAddress",u="EmailAddresses",c="ContactDisplayName",s="ContactMainEmailAddress",d="PdlId",l="MemberNames",f="EmailAddress",v="ExtDirId";function b(e,t){var r=e.SingleValueSettings&&e.SingleValueSettings.filter((function(e){return e.Key==t}));return r&&1===r.length?r[0].Value:void 0}function p(e,t){var r=e.MultiValueSettings&&e.MultiValueSettings.filter((function(e){return e.Key==t}));return r&&1===r.length?r[0].Values:[]}function O(e,t){var r;switch(t){case"folder":r={type:"folder",folderId:Object(n.b)(e.SingleValueSettings[0].Value)};break;case"persona":var O=b(e,o),F=O?Object(n.b)(O):null;r={type:"persona",searchFolderId:F,allEmailAddresses:p(e,u),mainEmailAddress:b(e,i),isSearchFolderPopulated:!!F,personaId:b(e,a),contactDisplayName:b(e,c),contactMainEmailAddress:b(e,s),isSyncUpdateDone:!1};break;case"privatedistributionlist":for(var y=b(e,o),m=y?Object(n.b)(y):null,j=b(e,d),g=b(e,"PersonaId"),I=g?Object(n.b)(g):null,h=p(e,u),S=p(e,l),w=[],A=0;A<h.length;A++)w.push({name:S[A],emailAddress:h[A]});r={type:"privatedistributionlist",searchFolderId:m,isSearchFolderPopulated:!!m,pdlId:j,members:w,owsPersonaId:I};break;case"group":r={type:"group",groupId:e.SingleValueSettings[0].Value.toLowerCase(),groupSmtp:b(e,f).toLowerCase(),groupExternalDirectoryObjectId:b(e,v)};break;case"category":r={type:"category",categoryId:e.SingleValueSettings[0].Value};break;case"search":r={type:"search",searchQuery:e.SingleValueSettings[0].Value};break;case"publicFolder":r={type:"publicFolder",publicFolderId:b(e,"FolderId")};break;case"news":r={type:"news",displayName:e.DisplayName};break;default:r={type:e.Type}}return r.treeType="favorites",r.favoriteId=e.Id,r.displayName=e.DisplayName,r.client=e.Client,r.lastModifiedTime=e.LastModifiedTime,r}},3334:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2022),o=r(5107);function a(e){if(!e)return!1;var t=n.a.favoritingInProgressMap;return"string"==typeof e?t.has(e):t.has(Object(o.b)(e))}},4307:function(e){e.exports=JSON.parse('{"a":"skc"}')},4308:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(5109),o=r(311),a=r(5596);function i(e){return Object(a.a)((function(){return Object(o.d)(n.a,e,void 0,!0,null,!0)}))}},4309:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(311),o=r(5109),a=r(5596);function i(e){return Object(a.a)((function(){return Object(n.a)(o.a+"/"+e,null,null,!0,null,!0)}))}},4663:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(29),o=r(293);function a(e){return!!(e&Object(n.a)().UserOptions.FavoritesBitFlags)}function i(e,t){Object(o.a)((function(r){e?r.UserOptions.FavoritesBitFlags|=t:r.UserOptions.FavoritesBitFlags&=~t}))}},5107:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n="newsFavorite";function o(e){switch(e.type){case"folder":return e.folderId;case"group":return e.groupId.toLowerCase();case"category":return e.categoryId;case"persona":var t=e;return t.personaId||t.mainEmailAddress;case"privatedistributionlist":return"FavoritePdl";case"publicFolder":return e.publicFolderId;case"news":return n;default:return}}},5108:function(e,t,r){"use strict";function n(e){return a(a(e,"/","-"),"+","_")}function o(e){return a(a(e,"-","/"),"_","+")}function a(e,t,r){return e.split(t).join(r)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},5109:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="ows/api/beta/outlookfavorites"},5110:function(e){e.exports=JSON.parse('{"a":"rkc"}')},5510:function(e,t,r){"use strict";var n=r(5597),o=r(98);var a=r(2022),i=r(275);t.a=Object(i.action)("updateFavoritesUserOption")(Object(i.select)({favoritesFolderNodes:function(){return a.a.favoritesFolderNodes},favoritesPersonaNodes:function(){return a.a.favoritesPersonaNodes},favoriteSearches:function(){return a.a.favoriteSearches},favoriteCategories:function(){return a.a.favoriteCategories},orderedFavoritesNodeIds:function(){return a.a.orderedFavoritesNodeIds}})((function(e){var t,r=n.b(e.orderedFavoritesNodeIds,e.favoritesFolderNodes,e.favoritesPersonaNodes,e.favoriteSearches,e.favoriteCategories);return Object(o.y)((function(e){e.UserOptions.FavoriteNodes=r})),t=r,o.v.importAndExecute([{key:"FavoriteNodes",valuetype:"StringArray",value:t}]).then((function(e){var t=e.Body.ResponseMessages.Items[0];return"Success"==t.ResponseClass?Promise.resolve():Promise.reject("updateUserConfiguration failed: "+t.ResponseClass)}))})))},5596:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),o=r(325),a=/cv=([^&]+)&?.*$/;function i(e){var t;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i,u,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r=!1,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,e()];case 2:return[4,(i=n.sent()).text().then((function(e){return e?JSON.parse(e):{}}))];case 3:if(u=n.sent(),Object(o.a)(i.status))return[2,u];throw r=!0,f=i.status,v=i.url,b=null===(t=null==u?void 0:u.error)||void 0===t?void 0:t.code,F=(O=v)&&O.match(a),p=F&&2===F.length?decodeURIComponent(F[1]):"No CV was found",{message:"Request failed with Status Code: "+f+" - Error Code: "+b+" --- cV: "+p,statusCode:f,correlationVector:p};case 4:if(c=n.sent(),r)throw c;throw d=(s=c)?s.message:"No error message",l=s?s.stack:"No error stack",{message:"Request failed with a network error - ErrorMessage: "+d+" - ErrorStack: "+l,statusCode:void 0,correlationVector:s.correlationVector};case 5:return[2]}var s,d,l,f,v,b,p,O,F}))}))}},5597:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(1226),o=r(52);function a(e){var t;try{t=JSON.parse(e)}catch(t){return void o.g.warn("Cannot parse folderForestNode: "+e)}if(void 0!==t.id)switch(t.type){case 6:case 0:return{id:t.id,type:t.type,treeType:"favorites"};case 3:case 4:return{id:t.id,type:t.type,treeType:"favorites",dropViewState:Object(n.a)()};case 1:var r={id:t.id,type:t.type,treeType:"favorites",displayName:t.displayName,mainEmailAddress:t.personaEmail,allEmailAddresses:t.personaAllEmails||[],searchFolderId:t.personaSearchFolderId,isJustAdded:!1,isSearchFolderPopulated:!0,isSyncUpdateDone:!1,dropViewState:Object(n.a)()};return t.personaId&&(r.personaId=t.personaId),r;default:return void o.g.warn("Non supported FolderForestNodeType: "+t.type)}}function i(e,t,r,n,a){return e.map((function(e){var i;return t.has(e)?i=t.get(e):r.has(e)?i=r.get(e):n.has(e)?i=n.get(e):a.has(e)?i=a.get(e):o.g.warn("Favorites not found. favoriteType: "+i.type),function(e){var t={id:e.id,type:e.type};if(1===e.type){var r=e;t.displayName=r.displayName,t.personaSearchFolderId=r.searchFolderId,t.personaEmail=r.mainEmailAddress,t.personaAllEmails=r.allEmailAddresses,t.personaId=r.personaId}return JSON.stringify(t)}(i)}))}},5598:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n=r(3),o=Object(n.action)("ON_CATEGORY_FAVORITED",(function(e){return{categoryId:e}})),a=Object(n.action)("ON_CATEGORY_UNFAVORITED",(function(e){return{categoryId:e}}))},6713:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1214);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e.toLowerCase())}},6714:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1214);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e)}},6715:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1214);function o(e){return Object(n.getStore)().favoriteSecondaryKeyMap.get(e)}},6716:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return b}));var n=r(0),o=r(3),a=r(9193),i=r(2614),u=r(3026),c=r(4308),s=r(638),d=r(351),l=r(3333),f=r(3334);Object(o.orchestrator)(a.a,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,a,p,O,F,y;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(t=e.categoryId,r=Object(s.o)().filter((function(e){return e.Id===t}))[0],o=Object(d.a)(),a=b(o,r,!1),Object(f.a)(t))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),Object(u.b)(t)?[2]:(Object(i.c)(a),p=v(r,!1),[4,Object(c.a)(p)]);case 2:return O=n.sent(),F=Object(l.a)(O,"category"),s.z.importAndExecute(),Object(i.a)(a,F),[3,4];case 3:return y=n.sent(),Object(i.b)(y,a),[3,4];case 4:return[2]}}))}))}));function v(e,t){return{Type:"category",DisplayName:e.Name,SingleValueSettings:[{Key:"CategoryId",Value:e.Id}],Client:t?"Migration":"OWA"}}function b(e,t,r){return{treeType:"favorites",type:"category",favoriteId:e,displayName:t.Name,categoryId:t.Id,client:r?"Migration":"OWA"}}},6717:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return c}));var n=r(5108);function o(e){return{id:e.favoriteId,treeType:"favorites",type:5,data:e}}function a(e,t,r,n,o){return{treeType:"favorites",type:"privatedistributionlist",favoriteId:e,displayName:t,members:r,pdlId:n,searchFolderId:void 0,client:"OWA",isSearchFolderPopulated:!1,owsPersonaId:o}}function i(e,t){return{Type:"privatedistributionlist",DisplayName:e,MultiValueSettings:[{Key:"EmailAddresses",Values:t.map((function(e){return e.emailAddress}))},{Key:"MemberNames",Values:t.map((function(e){return e.name}))}],Client:"OWA"}}function u(e,t,r){return{Type:"privatedistributionlist",DisplayName:e,SingleValueSettings:[{Key:"PdlId",Value:Object(n.a)(t)},{Key:"PersonaId",Value:r}],Client:"OWA"}}function c(e,t){var r={Type:"privatedistributionlist",Client:"OWA"};if(e&&(r.DisplayName=e),t){var n=[{Key:"EmailAddresses",Values:t.map((function(e){return e.emailAddress}))},{Key:"MemberNames",Values:t.map((function(e){return e.name}))}];r.MultiValueSettings=n}return r}},7467:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("SET_FAVORITES_LOADED")},7468:function(e,t,r){"use strict";t.a={MigrateOutlookFavorites:{name:"MigrateOutlookFavorites",options:{isCore:!0}},UpdateFavoriteNode:{name:"UpdateFavoriteNode"}}},7469:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(5109),o=r(311),a=r(5596);function i(e,t){return Object(a.a)((function(){return Object(o.c)(n.a+"/"+e,t,void 0,!0,null,!0)}))}},7470:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(0),o=r(7471),a=r(1185),i=r(351),u=r(3),c=r(4308),s=r(5108),d=r(3333),l=r(2614),f=r(3334);Object(u.orchestrator)(o.a,(function(e){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var t,r,o,u,s;return Object(n.__generator)(this,(function(n){return t=e.folderIdToAdd,r=a.d.folderTable.get(t),o=Object(i.a)(),u=function(e,t,r){return{treeType:"favorites",type:"folder",favoriteId:e,displayName:Object(a.i)(t),folderId:t.FolderId.Id,client:r?"Migration":"OWA"}}(o,r,!1),Object(f.a)(t)?[2]:(Object(l.c)(u),s=v(r,!1),Object(c.a)(s).then((function(e){var t=Object(d.a)(e,"folder");Object(l.a)(u,t)})).catch((function(e){Object(l.b)(e,u)})),[2])}))}))}));function v(e,t){return{Type:"folder",DisplayName:Object(a.i)(e),SingleValueSettings:[{Key:"FolderId",Value:Object(s.a)(e.FolderId.Id)},{Key:"ChangeKey",Value:e.FolderId.ChangeKey}],Client:t?"Migration":"OWA"}}},7471:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("ADD_FAVORITE_FOLDER_V2",(function(e){return{folderIdToAdd:e}}))},7472:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a}));r(1214);function n(e){return{id:e.favoriteId,treeType:"favorites",type:1,allEmailAddresses:e.allEmailAddresses,displayName:e.displayName,mainEmailAddress:e.mainEmailAddress,searchFolderId:e.searchFolderId,isSyncUpdateDone:!0,isJustAdded:!1,isSearchFolderPopulated:e.isSearchFolderPopulated,markedForDeletion:!1,dropViewState:null,personaId:e.personaId}}function o(e,t,r){return{treeType:"favorites",type:"persona",favoriteId:e,displayName:t,searchFolderId:void 0,client:"OWA",allEmailAddresses:[r],personaId:void 0,mainEmailAddress:r,isSearchFolderPopulated:!1,isSyncUpdateDone:!0}}function a(e,t){return{Type:"persona",DisplayName:e,SingleValueSettings:[{Key:"MainEmailAddress",Value:t}],Client:"OWA"}}},9188:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),o=r(2022),a=r(5107);function i(e){var t=o.a.favoriteSecondaryKeyMap,r=o.a.orderedOutlookFavoritesIds,i=o.a.outlookFavorites;r.some((function(t){return t===e.favoriteId}))||(r.push(e.favoriteId),i.set(e.favoriteId,Object(n.__assign)({treeType:"favorites"},e)),t.set(Object(a.b)(e),e.favoriteId))}},9189:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(5107),o=r(2022);function a(e){var t=o.a.favoriteSecondaryKeyMap,r=o.a.orderedOutlookFavoritesIds,a=o.a.outlookFavorites;o.a.orderedOutlookFavoritesIds=r.filter((function(t){return t!==e.favoriteId})),a.delete(e.favoriteId),t.delete(Object(n.b)(e))}},9190:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(2022),o=r(5107);function a(e){n.a.favoritingInProgressMap.set(Object(o.b)(e),!0)}function i(e){n.a.favoritingInProgressMap.delete(Object(o.b)(e))}},9191:function(e,t,r){"use strict";r.d(t,"c",(function(){return O})),r.d(t,"b",(function(){return y}));var n=r(0),o=r(5597),a=r(4663),i=r(2022),u=r(269),c=r(638),s=r(1214),d=r(1185),l=r(29),f=r(52),v=r(275),b=r(7467),p=Object(v.select)({favoritesStore:function(){return i.a},folderTable:function(){return d.d.folderTable}})((function(e,t){return!(t.folderTable.size>0)||!t.favoritesStore.favoritesFolderNodes.has(e)&&t.folderTable.has(e)}));function O(e){p(e.id)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoritesFolderNodes.set(e.id,e))}function F(e){var t;t=e.id,Object(c.q)(t)&&!i.a.favoriteCategories.get(t)&&(i.a.orderedFavoritesNodeIds.push(e.id),i.a.favoriteCategories.set(e.id,e))}var y=Object(v.action)("loadFavoriteNodesToStore")((function(e,t){var r=Object(l.a)().UserOptions;if(r.FavoriteNodes){r.FavoriteNodes.forEach((function(t){var r,n,a=o.a(t);if(a)switch(a.type){case 0:O(a);break;case 3:n=a,i.a.orderedFavoritesNodeIds.push(n.id),i.a.favoriteSearches.set(n.id,n);break;case 1:r=a.id,i.a.favoritesPersonaNodes.has(r)||(e.orderedFavoritesNodeIds.push(a.id),e.favoritesPersonaNodes.set(a.id,a));break;case 4:F(a);break;default:f.g.warn("Non supported FolderForestNodeType: "+a.id)}}));var a=Object(n.__spread)(e.favoritesPersonaNodes.values()).filter((function(e){return e.personaId}));Object(u.p)("LoadFavorites",[e.favoritesFolderNodes.size,e.favoritesPersonaNodes.size,e.favoriteSearches.size,e.favoriteCategories.size,a.length])}}));t.a=Object(v.action)("loadFavoritesV1")(Object(v.select)({favoritesStore:function(){return i.a}})((function(e){i.a.favoritesLoaded||(0===d.d.folderTable.size&&Object(d.w)(),Object(a.a)(2)?y(e.favoritesStore):s.lazyMigrateFavorites.importAndExecute(),Object(b.a)())})))},9192:function(e,t,r){"use strict";function n(e,t){if(e.length!==t.length)return!1;var r=e.map((function(e){return e.emailAddress.toLocaleLowerCase()})),n=t.map((function(e){return e.emailAddress.toLocaleLowerCase()}));return r.filter((function(e){return n.includes(e)})).length===r.length}r.d(t,"a",(function(){return n}))},9193:function(e,t,r){"use strict";var n=r(3);t.a=Object(n.action)("ADD_FAVORITE_CATEGORY_V2",(function(e){return{categoryId:e}}))}}]);
//# sourceMappingURL=owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupEditV2Opx~MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFo~78df965d.js.map
self.scriptsLoaded['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupEditV2Opx~MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFo~78df965d.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~AddinsExpUI~FilesHubPersonaList~GroupEditV2Opx~MailBoot~MailDeepBoot~MailDeepOpxBoot~MailFo~78df965d.js'] = (new Date()).getTime();