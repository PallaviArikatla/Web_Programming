self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.30.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[30],{1192:function(e,t,n){"use strict";var r=n(3133),a=n(179),o=n(2053),i=n(526);function c(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(a.J)(e.ParentFolderId.Id)&&!Object(o.c)(e)&&("Private"!==e.Sensitivity||(t=e.ParentFolderId.Id,n=Object(a.o)(t),Object(i.c)(n)));var t,n}var u=function(e){return W(e)&&c(e)&&!e.IsCancelled},d=function(e){var t;return(null===(t=null==e?void 0:e.ParentFolderId)||void 0===t?void 0:t.mailboxInfo)&&"GroupMailbox"==e.ParentFolderId.mailboxInfo.type};function s(e,t){if(!e)return!1;var n=!d(e),r=function(t){return t?n?t.filter((function(t){return!e.Organizer||t.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress})):t:[]},a=r(e.RequiredAttendees).length,o=r(e.OptionalAttendees).length;return t?a+o>0:a+o+r(e.Resources).length>0}function l(e){return!!e&&(e.IsDraft?s(e):e.IsMeeting||s(e))}var f=function(e){return!l(e)&&!e.IsOrganizer&&c(e)&&!e.IsCancelled},v=function(e){return!(!e.IsOrganizer||l(e)&&e.MeetingRequestWasSent||!c(e))},b=n(98),O=n(1854);function I(e){var t=Object(a.o)(e.ParentFolderId.Id),n=Object(O.c)(e);return c(e)&&l(e)&&!!t&&!!n&&!([3,6,7].includes(t.CalendarFolderType)||n.IsMeetingPollEvent)}function j(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&c(e))}var m=function(e){return v(e)||u(e)||f(e)};function p(e){return!d(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&c(e)}function E(e){return 0==Object(b.h)().SessionSettings.WebSessionType&&p(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||h(e))}function y(e){return!e.IsOrganizer&&e.IsCancelled&&c(e)}function g(e){return!Object(r.a)(e.EntityNamesMap)&&e.IsOrganizer&&c(e)}function h(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function _(e){return"RecurringMaster"===e.CalendarItemType}function R(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function S(e){return d(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function T(e){if(e){var t=Object(a.o)(e.ParentFolderId.Id);if(t)return t.IsSharedWithMe||Object(i.d)(t)}return!1}var C=n(84);function P(e){return!!d(e)||(!T(e)||Object(C.i)("cal-mf-enableFTDFOnSharedCalendar"))}var A=function(e){var t=Object(a.o)(e.ParentFolderId.Id),n=t?t.CalendarFolderType:void 0;return(Object(o.c)(e)||c(e))&&(!n||1==n||3==n||5==n)};function F(e){var t;return!!(null===(t=e.EffectiveRights)||void 0===t?void 0:t.Read)}var N=n(351);function w(e){return e&&F(e)&&M(e.ItemId)}function M(e){return(null==e?void 0:e.Id)&&!Object(N.b)(e.Id)}var x=n(373);function D(e){return e.IsMeeting&&!Object(x.r)(e.ParentFolderId.mailboxInfo.userIdentity)}var L=n(2134);function k(e,t){var n,r;return!(t&&t.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(t.toLowerCase())||(null===(n=e.Location)||void 0===n?void 0:n.DisplayName)&&-1!=Object(L.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(t.toLowerCase())||(null===(r=e.Organizer)||void 0===r?void 0:r.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(t.toLowerCase()))}var K=function(e){if(!e)return!1;var t=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return U(e.RequiredAttendees,t)||U(e.OptionalAttendees,t)};function U(e,t){return e&&e.some((function(e){return e.Mailbox.EmailAddress.toLowerCase()==t}))}var q=n(1365);function B(e){if(!e)return!1;var t=!1;return e.forEach((function(e){var n;n=e.Mailbox,Object(q.a)(n.EmailAddress)||n.ItemId&&"PrivateDL"==n.MailboxType||(t=!0)})),t}function V(e){if(!e)return!1;var t=Object(a.o)(e.ParentFolderId.Id);return t&&3==t.CalendarFolderType}function z(e){return"Exception"===e}function H(e){return"Occurrence"===e}function G(e){return H(e.CalendarItemType)||z(e.CalendarItemType)}function W(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function J(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Z(e){return Object(o.c)(e)&&l(e)}var Q=n(9);function Y(e,t){return e&&t&&!Object(o.c)(e)&&Object(Q.Hb)(t.Start,e.Start)&&Object(Q.Hb)(t.End,e.End)&&t.IsAllDayEvent==e.IsAllDayEvent}function $(e){return"RecurringMaster"===e}function X(e){return!(!e.IsMeeting||!e.IsOrganizer||!e.IsDraft&&e.MeetingRequestWasSent)}function ee(e){return!(!e.ItemId||!e.IsDraft||function(e){return!!(e.ItemId&&e.IsDraft&&e.IsMeeting&&e.IsOrganizer)}(e))}n.d(t,"j",(function(){return I})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return m})),n.d(t,"q",(function(){return p})),n.d(t,"n",(function(){return E})),n.d(t,"o",(function(){return y})),n.d(t,"h",(function(){return g})),n.d(t,"K",(function(){return h})),n.d(t,"L",(function(){return _})),n.d(t,"A",(function(){return R})),n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return P})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return v})),n.d(t,"i",(function(){return A})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return w})),n.d(t,"m",(function(){return M})),n.d(t,"p",(function(){return D})),n.d(t,"r",(function(){return k})),n.d(t,"s",(function(){return s})),n.d(t,"t",(function(){return K})),n.d(t,"u",(function(){return B})),n.d(t,"v",(function(){return F})),n.d(t,"w",(function(){return V})),n.d(t,"x",(function(){return l})),n.d(t,"y",(function(){return G})),n.d(t,"z",(function(){return z})),n.d(t,"B",(function(){return W})),n.d(t,"C",(function(){return T})),n.d(t,"D",(function(){return J})),n.d(t,"E",(function(){return Z})),n.d(t,"G",(function(){return H})),n.d(t,"H",(function(){return d})),n.d(t,"I",(function(){return Y})),n.d(t,"J",(function(){return $})),n.d(t,"M",(function(){return X})),n.d(t,"F",(function(){return ee}))},1229:function(e,t,n){"use strict";var r=n(2784),a=n(6688),o=n(3),i=Object(o.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(function(e,t,n,r,a){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,partialCalendarEvent:a}})),c=Object(o.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(function(e,t,n,r){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r}})),u=Object(o.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(function(e,t,n,r,a,o,i){return{lockId:e,folderId:t,eventKey:n,itemResponseShapeType:r,event:a,hasEventChanged:o,forceOverrideAllPropertiesForEventIfAvailable:i}})),d=Object(o.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(function(e,t,n,r){return{folderId:e,eventKey:t,itemResponseShapeType:n,event:r}})),s=Object(o.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",(function(e){return{partialCalendarEvent:e}})),l=Object(o.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",(function(e){return{partialCalendarEvent:e}})),f=Object(o.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",(function(e){return{event:e}})),v=Object(o.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(function(e,t){return{folderId:e,eventKey:t}})),b=Object(o.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",(function(e){return{folderId:e}})),O=Object(o.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(function(e,t,n,r){return void 0===r&&(r=!1),{folderId:e,calendarEvents:t,dateRanges:n,forceReplace:r}})),I=Object(o.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(function(e,t){return{folderId:e,calendarEvents:t}})),j=Object(o.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t){return{folderId:e,instanceKey:t}})),m=Object(o.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(function(e,t,n){return{folderId:e,instanceKey:t,onEventsRemoved:n}})),p=Object(o.action)("REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t){return{folderId:e,predicate:t}})),E=Object(o.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(function(e,t,n){return{folderId:e,predicate:t,onEventsRemoved:n}})),y=Object(o.action)("CALENDAR_EVENTS_RELEASE_LOCK",(function(e){return{lockId:e}})),g=Object(o.action)("RELEASE_LOCK",(function(e){return{lockId:e}})),h=Object(o.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(function(e,t,n,r){return void 0===r&&(r=!1),{folderId:e,eventsReloaded:t,dateRanges:n,forceReplace:r}})),_=Object(o.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),R=Object(o.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(function(e,t,n,r){return{lockId:e,folderId:t,dateRange:n,calendarEvents:r}})),S=Object(o.action)("INTERNAL_DELETE_EVENTS_CACHE",(function(e){return{folderId:e}})),T=Object(o.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(function(e,t){return{lockId:e,eventKey:t}})),C=Object(o.action)("UpdateItem",(function(e,t){return{existingItem:e,updatedItem:t}})),P=n(3745),A=n(4597),F=n(4598),N=n(11),w=n(61),M=Object(o.action)("calendarEventsRemoved",(function(e){return{eventsRemoved:e}})),x=Object(o.action)("calendarEventsAdded",(function(e){return{eventsAdded:e}})),D=Object(o.action)("calendarEventUpdated",(function(e){return{eventUpdated:e}})),L=Object(o.action)("calendarEventsRemovedMatchedFilter",(function(e){return{removePredicate:e}})),k=Object(o.action)("cacheReloaded",(function(e,t){return{previousEvents:e,reloadedEvents:t}})),K=Object(o.action)("deleteEventsCache",(function(e){return{folderId:e}})),U=Object(o.action)("loadingCalendarEvents",(function(e,t,n){return Object(w.c)({name:"CalendarLoadState",customData:{loadingState:n},options:{isVerbose:!0}},{lockId:e,calendarId:t,loadingState:n})})),q=Object(o.action)("instantCalendarEventCreate",(function(e,t,n,r,a,o,i){return void 0===r&&(r=function(){}),void 0===a&&(a=void 0),void 0===o&&(o=Object(N.b)(A.a)),void 0===i&&(i=function(){}),{eventToCreate:e,actionToExecute:t,onEventCreatedSuccess:n,onEventCreatedFailed:r,actionSource:a,errorMessage:o,onEventCreatedLocally:i}})),B=Object(o.action)("instantCalendarEventUpdate",(function(e,t,n,r,a,o,i,c,u){return void 0===o&&(o=function(){}),void 0===i&&(i=void 0),void 0===c&&(c=Object(N.b)(P.a)),void 0===u&&(u=function(){}),{eventId:e,eventChanges:t,eventScope:n,actionToExecute:r,onEventUpdateSuccess:a,onEventUpdateFailed:o,actionSource:i,errorMessage:c,onEventUpdatedLocally:u}})),V=Object(o.action)("instantCalendarEventDelete",(function(e,t,n,r,a,o,i,c,u,d){return void 0===o&&(o=function(){}),void 0===i&&(i=void 0),void 0===c&&(c=Object(N.b)(F.a)),void 0===u&&(u=!1),void 0===d&&(d=function(){return Promise.resolve(!1)}),{eventId:e,eventScope:t,dataPoint:n,actionToExecute:r,onEventDeleteSuccess:a,onEventDeleteFailed:o,actionSource:i,errorMessage:c,responseSent:u,asyncUndoAction:d}})),z=n(0),H=n(521);function G(e){if(0===e.length)return[];var t=[];return e.forEach((function(e){return function(e,t){for(var n=!1,r=0;r<t.length&&!n;r++){var a=t[r];0===Object(H.j)(a,e,!0)&&(t[r]=Object(H.f)(a,e),n=!0)}n||t.push(e)}(e,t)})),t}var W=n(3316),J=n(269),Z=n(179),Q=n(1192),Y=n(1854),$=n(431),X=n(84),ee=n(9);var te=n(687),ne=n(31);function re(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(z.__assign)({__type:"ExpandCalendarEventJsonRequest:#Exchange"},n)),Object(ne.a)("ExpandCalendarEvent",e,t)}var ae=n(350);function oe(e,t){return Object(z.__awaiter)(this,void 0,void 0,(function(){return Object(z.__generator)(this,(function(n){switch(n.label){case 0:return[4,re({Header:Object(ae.a)(),Body:(r={EventId:Object(te.a)({Id:e.Id}),WindowStart:Object(ee.qb)(t.start),WindowEnd:Object(ee.qb)(t.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(X.i)("cal-surface-declinedMeetings")},Object(z.__assign)({__type:"ExpandCalendarEventRequest:#Exchange"},r))},Object($.a)(e.mailboxInfo))];case 1:return[2,n.sent().Body]}var r}))}))}var ie=n(5560),ce=function(e){Object(X.i)("cal-notificationDiagnostics")&&setTimeout((function(){return Object(ie.a)(e)}),0)},ue=n(2053),de=n(1360),se=n(4999);function le(e,t,n){var a=Object(se.k)(n,e,Object(r.f)(t));return(a||[]).filter((function(e){return!Object(Q.J)(e.CalendarItemType)}))}var fe=3,ve=1,be=n(4242),Oe=n(9166);function Ie(e,t,n){return function(r){if(!je(r)||r.ParentFolderId.Id!==e)return!1;var a=function(e,t){return function(n){return je(n)&&n.ParentFolderId.Id===e&&n.ItemId.Id===t}}(r.ParentFolderId.Id,r.ItemId.Id);return n?t.some(a):!t.some(a)}}function je(e){var t;return(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var me=n(646);function pe(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(z.__assign)({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},n)),Object(ne.a)("GetBirthdayCalendarView",e,t)}function Ee(e,t,n){return Object(z.__awaiter)(this,void 0,void 0,(function(){return Object(z.__generator)(this,(function(r){switch(r.label){case 0:return[4,pe({Header:Object(ae.a)(),Body:(a={StartRange:Object(ee.qb)(e),EndRange:Object(ee.qb)(t)},Object(z.__assign)({__type:"GetBirthdayCalendarViewRequest:#Exchange"},a))},Object($.a)(n.mailboxInfo))];case 1:return[2,r.sent().Body]}var a}))}))}var ye=n(2093),ge=n(382),he=n(98);function _e(e,t,n,r){return Object(z.__awaiter)(this,void 0,void 0,(function(){var a,o;return Object(z.__generator)(this,(function(i){return a=Object(he.h)().UserOptions.TimeZone,o="ows/api/beta/TeamsCalendarEvents/items?id="+encodeURIComponent(n)+"&rangeStart="+encodeURIComponent(Object(ee.qb)(e))+"&rangeEnd="+encodeURIComponent(Object(ee.qb)(t))+"&channelId="+r+"&timeZone="+a,[2,Object(ge.b)("getTeamsCalendarView",null,o)]}))}))}var Re=n(52),Se=n(526),Te=n(4596),Ce=Object(o.mutatorAction)("updateCalendarWorkingHours",(function(e,t){Object(Te.a)().calendarFolderWorkingHours.set(e,t)}));function Pe(e,t,n,r){var a;return void 0===r&&(r=0),{fetchPromise:function(e,t,n,r){void 0===r&&(r=0);return Object(z.__awaiter)(this,void 0,void 0,(function(){var a,o,i,c;return Object(z.__generator)(this,(function(u){switch(u.label){case 0:return(a=Object(J.r)())&&a.addCustomData({outOfCacheRange:!0}),o=Object(Z.u)(t),n(o,"Loading"),Object(Z.I)(t)?3!=(i=Object(Z.o)(t)).CalendarFolderType?[3,2]:[4,Ne(e,o,t,n,r)]:[3,5];case 1:return[2,u.sent()];case 2:return[4,Fe(e,o,t,n,null,r)];case 3:return[2,u.sent()];case 4:return[3,8];case 5:return i=Object(Z.l)({id:o}),Object(Z.M)(i)?(c=Object(Z.p)({id:{id:i.ItemId.Id,mailboxInfo:o.mailboxInfo}}),[4,Ae(t,c,i,e,o,n,r)]):[3,7];case 6:return[2,u.sent()];case 7:return n(o,"Failed"),[2,null];case 8:return[2]}}))}))}(e,t,n,r),enhancedFetchPromise:Object(X.i)("cal-mf-noPeekJump")&&t==(null===(a=Object(Z.w)())||void 0===a?void 0:a.calculatedFolderId)?Cn.importAndExecute(e):null}}function Ae(e,t,n,o,i,c,u){return void 0===u&&(u=0),Object(z.__awaiter)(this,void 0,void 0,(function(){var d,s,l,f,v,b;return Object(z.__generator)(this,(function(O){switch(O.label){case 0:if(!(!t&&Object(Se.d)(n)||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&t&&!t.EffectiveRights||t&&(!t.EffectiveRights||!t.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar))return[3,7];O.label=1;case 1:if(!(u>=0))return[3,6];O.label=2;case 2:return O.trys.push([2,4,,5]),[4,Object(me.b)(o.start,o.end,[n.OwnerEmailAddress],"DetailedMerged",null,i.mailboxInfo)];case 3:return"NoError"==(d=O.sent()).ResponseCode?(c(i,"Loaded"),function(e,t){var n=Object(r.a)(e);if(null==n?void 0:n.length){var o=Object(a.a)(n,[t]).eventsOverlapping;p(e,Ie(e,o,!0))}}(e,o),function(e){var t=Object(r.f)(e),n=t?Object(z.__spread)(t.events.values()):[];L(Ie(e,n,!1))}(e),s=d.Responses[0].CalendarView,l=s.WorkingHours,f=s.Items,Ce(e,l),[2,f.map((function(e){return Object(Y.a)(e,i.mailboxInfo)}))]):(u--,[3,5]);case 4:return v=O.sent(),Re.g.warn("[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: "+v),v.message&&(v.message.indexOf("ErrorApiQuarantined")>=0||v.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(c(i,"Throttled"),[2,null]):(u--,[3,5]);case 5:return[3,1];case 6:return c(i,"Failed"),[2,null];case 7:return b=t?t.FolderId.Id:n.SharedFolderId.Id,[4,Fe(o,i,b,c,n.IsGroupMailboxCalendar?null:n.OwnerEmailAddress,u)];case 8:return[2,O.sent()]}}))}))}function Fe(e,t,n,r,a,o){return void 0===o&&(o=0),Object(z.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(z.__generator)(this,(function(u){switch(u.label){case 0:if(!(o>=0))return[3,8];u.label=1;case 1:return u.trys.push([1,6,,7]),i=void 0,t.mailboxInfo&&"TeamsMailbox"==t.mailboxInfo.type?[4,_e(e.start,e.end,Object(Z.f)(n),t.id)]:[3,3];case 2:return(i=u.sent())&&(i=i.Body),[3,5];case 3:return[4,Object(ye.a)(e.start,e.end,n,t,a,Object(X.i)("cal-surface-declinedMeetings"))];case 4:i=u.sent(),u.label=5;case 5:return"NoError"==i.ResponseCode?(r(t,"Loaded"),[2,i.Items.map((function(e){return t.mailboxInfo&&"TeamsMailbox"==t.mailboxInfo.type&&(e.ParentFolderId.Id=n),Object(Y.a)(e,t.mailboxInfo)}))]):(o--,[3,7]);case 6:return c=u.sent(),Re.g.warn("[loadCalendarEventsInDateRange:getCalendarView: Exception occured: "+c),c.message&&(c.message.indexOf("ErrorApiQuarantined")>=0||c.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(o--,[3,7]);case 7:return[3,0];case 8:return r(t,"Failed"),[2,null]}}))}))}function Ne(e,t,n,r,a){return void 0===a&&(a=0),Object(z.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(z.__generator)(this,(function(c){switch(c.label){case 0:if(!(a>=0))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Ee(e.start,e.end,t)];case 2:return"NoError"==(o=c.sent()).ResponseCode?(r(t,"Loaded"),[2,o.BirthdayEvents.map((function(r){return Object(Oe.a)(r,n,e,t.mailboxInfo)}))]):(a--,[3,4]);case 3:return i=c.sent(),Re.g.warn("[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: "+i),i.message&&(i.message.indexOf("ErrorApiQuarantined")>=0||i.message.indexOf("ErrorTooManyObjectsOpened")>=0)?(r(t,"Throttled"),[2,null]):(a--,[3,4]);case 4:return[3,0];case 5:return r(t,"Failed"),[2,null]}}))}))}var we={};function Me(e,t){return function(e,t){xe(e);for(var n=we[e],r=0;r<n.length;r++)if(Object(H.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}(e,t).index>=0}function xe(e){we[e]||(we[e]=[])}var De={};function Le(e){De[e]||(De[e]=[])}function ke(e,t){Le(e);for(var n=De[e],r=0;r<n.length;r++)if(Object(H.c)(n[r].dateRange,t,!0))return{index:r,info:n[r]};return{index:-1,info:null}}function Ke(e,t,n){var a=Object(r.g)(e,t),o=ke(t,n).info;if(a&&a.lockedDateRange&&Object(H.c)(a.lockedDateRange,n,!0)){var i=Object(Z.u)(t);U(e,i,"Loaded");var c=le(e,t,n);O=Ue(c,t,n,o);return{fetchPromise:Promise.resolve(c),enhancedFetchPromise:O,events:c}}var u=function(e,t){var n=Object(r.d)(e),a=Object(r.f)(e);return n.some((function(e){return Object(H.c)(e,t,!0)}))&&a?Object(se.j)(t,a.events).map((function(e){return Object(z.__assign)({},e)})):null}(t,n);if(u){var d=qe(e,t,n,Promise.resolve(u),"existing"),s=Ue(u,t,n,o);return null==d||d.then((function(n){var r=Object(Z.u)(t);U(e,r,"Loaded")})),{fetchPromise:d,enhancedFetchPromise:s,events:u}}if(null==o?void 0:o.requestPromises){var l=o.requestPromises,v=l.fetchPromise,b=l.enhancedFetchPromise;return o.lockIds.push(e),{fetchPromise:qe(e,t,n,null==v?void 0:v.then((function(e){return e?e.filter((function(e){var t=e.Start,r=e.End;return 0==Object(H.j)(n,{start:t,end:r},!0)})):[]})),"new"),enhancedFetchPromise:null==b?void 0:b.then((function(e){return Be(n)(e)})),events:null}}!function(e,t,n){Le(t),De[t].push({dateRange:n,requestPromises:null,lockIds:[e]})}(e,t,n);var O,I=function(e,t,n){var r=this,a=Pe(t,e,n,ve);return{fetchPromise:Object(z.__awaiter)(r,void 0,void 0,(function(){return Object(z.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,2,3]),[4,null==a?void 0:a.fetchPromise];case 1:return[2,n.sent()];case 2:return function(e,t){var n=ke(e,t).index;-1!==n&&De[e].splice(n,1)}(e,t),[7];case 3:return[2]}}))})),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(t,n,function(e,t){return function(n,r){var a=ke(e,t),o=a.index,i=a.info;-1!==o&&i.lockIds.forEach((function(e){U(e,n,r)}))}}(t,n)),j=null==I?void 0:I.fetchPromise,m=null==I?void 0:I.enhancedFetchPromise;return function(e,t,n){var r=ke(e,t),a=r.index,o=r.info;-1!==a&&(o.requestPromises=n)}(t,n,I),{fetchPromise:qe(e,t,n,j,"new"),enhancedFetchPromise:O=function(e,t,n){return Object(z.__awaiter)(this,void 0,void 0,(function(){var r;return Object(z.__generator)(this,(function(a){switch(a.label){case 0:return[4,n];case 1:return(r=a.sent())&&(!function(e,t){xe(e),we[e].push({dateRange:t})}(e,t),r.forEach((function(e){return f(e)}))),[2,r]}}))}))}(t,n,m),events:null}}function Ue(e,t,n,r){var a,o,i=null;if(t===(null===(a=Object(Z.w)())||void 0===a?void 0:a.calculatedFolderId))if(Me(t,n))i=Promise.resolve(e);else if(null===(o=null==r?void 0:r.requestPromises)||void 0===o?void 0:o.enhancedFetchPromise){i=r.requestPromises.enhancedFetchPromise.then(Be(n))}else Re.g.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return i}function qe(e,t,n,r,a){return Object(z.__awaiter)(this,void 0,void 0,(function(){var o,i;return Object(z.__generator)(this,(function(c){switch(c.label){case 0:return[4,r];case 1:return o=c.sent(),i=o?o.length:"no",Object(be.a)({lockId:e,updateMessage:"Fetched "+i+" "+a+" items for date range: "+n.start+" - "+n.end}),o&&_(e,t,n,o),[2,o]}}))}))}function Be(e){return function(t){return t?t.filter((function(t){var n=t.Start,r=t.End;return 0==Object(H.j)(e,{start:n,end:r},!0)})):[]}}function Ve(e,t){var n,a;return void 0===t&&(t=!1),Object(z.__awaiter)(this,void 0,void 0,(function(){var o,i,c,u,d,l;return Object(z.__generator)(this,(function(f){switch(f.label){case 0:o=function(e){var t=function(e){return Le(e),De[e].map((function(e){return e.dateRange}))}(e),n=null==t?void 0:t.filter((function(e){return null!==e})),a=Object(r.d)(e);return G(Object(z.__spread)(n,a))}(e),i=o.map((function(t){return Pe(t,e,function(e,t){return function(n,a){"Loading"!==a&&Object(r.c)(e,t).forEach((function(e){U(e,n,a)}))}}(e,t),ve)})),c=[],u=0,f.label=1;case 1:return u<i.length?[4,Promise.all([null===(n=i[u])||void 0===n?void 0:n.fetchPromise,null===(a=i[u])||void 0===a?void 0:a.enhancedFetchPromise]).then((function(e){var t=e[0],n=e[1];if(t&&n)for(var r=function(e){var r=t[e].ItemId.Id,a=null===(o=t[e].ParentFolderId)||void 0===o?void 0:o.Id,o=Object(z.__read)(n.filter((function(e){var t;return e.ItemId.Id===r&&(null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id)===a})),1),i=o[0];i&&C(t[e],i),c.push(t[e])},a=0;a<t.length;a++)r(a);else t&&c.push.apply(c,Object(z.__spread)(t))}))]:[3,4];case 2:f.sent(),f.label=3;case 3:return u++,[3,1];case 4:return c.length>0?(c.forEach((function(e){return s(e)})),d=c.reduce((function(e,t){return t&&e.push(t),e}),[]),v=function(e){return e.ItemId.Id},b={},O=[],d.forEach((function(e){var t=v(e);b.hasOwnProperty(t)||(O.push(e),b[t]=!0)})),h(e,l=O,o,t),[2,l]):[2,null]}var v,b,O}))}))}function ze(e,t,n,r){void 0===r&&(r=!1);var a=e.ParentFolderId.Id,o=!1,i=function(e,t,n){var r,a,o=null;if(n)o=Object(W.b)(t.ItemId.Id,e);else{r=Object(z.__read)(Object(W.a)(e,(function(e){return e.InstanceKey==t.InstanceKey})),1),o=r[0]}if(!o){var i=t.ClientSeriesId;if(i){a=Object(z.__read)(Object(W.a)(e,(function(e){return e.ClientSeriesId==i})),1),o=a[0]}}return o}(a,e,t);i?i.IsRecurring&&!t?r?M([i]):o=!0:(null==e.IsOnlineMeeting&&null!=i.IsOnlineMeeting&&(e.IsOnlineMeeting=i.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=i.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=i.OnlineMeetingJoinUrl),M([i])):Re.g.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!i&&n||(o||(O(a,[e],[{start:e.Start,end:e.End}]),x([e])),r?s(e):l(e))}function He(e,t){return void 0===t&&(t=!1),Object(z.__awaiter)(this,void 0,void 0,(function(){return Object(z.__generator)(this,(function(n){switch(n.label){case 0:return[4,Ve(e,t)];case 1:return n.sent(),[2]}}))}))}var Ge=Object(o.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",(function(){return{}}));function We(){Ge(),Object(r.b)().map((function(e){return Ve(e,!0)}))}var Je=n(4219),Ze=864e5;var Qe,Ye={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},$e=2e3,Xe={},et={},tt=[],nt=!0,rt=!0;function at(e,t){if(rt&&(Object(Je.b)(We,"RELOAD_CALENDAR_SUBSCRIPTIONS",Ze),rt=!1),Xe[e])return Xe[e].locks[t]=!0,void ce({message:"Already subscribed to calendar item notifications for folder",folderId:e});var n=Object(Z.o)(e);if(n){var r=Object(Z.C)(n);if(r){var a=Object(X.i)("cal-surface-declinedMeetings");de.b.import().then((function(n){var o,i=Object(z.__assign)(Object(z.__assign)({},r),{ChannelId:n(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:a}),c={subscriptionId:""+i.NotificationType+e+(a?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:i},u={folderId:e,subscription:c,locks:(o={},o[t]=!0,o)};ce({message:"Subscribing to calendar item notifications for folder with includeDeclinedMeetings = "+a,folderId:e}),de.f.importAndExecute(c,ot),Xe[e]=u}))}}else ce({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e})}function ot(e){ut(e,!0),function(e){if(tt.some((function(e){return dt(e.NotificationPayload)})))ce({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(dt(e.NotificationPayload))ce({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),(tt=[])[0]=e;else{for(var t=tt.length-1;t>=0;t--){var n=tt[t].NotificationPayload.Item,r=void 0,a=void 0,o=void 0;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,r=n.InstanceKey,o="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,r=n.ItemId.Id,o="ItemId"),a===r){ce({message:"Found an existing notification in the queue for the same "+o+". Old notification will be removed.",notificationPayload:e.NotificationPayload}),tt[t].InstanceKeyToDelete&&(e.InstanceKeyToDelete=tt[t].InstanceKeyToDelete),tt.splice(t,1);break}}var i=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==Ye.RowModified&&Object(Q.J)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(et[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===Ye.RowAdded||e.NotificationPayload.EventType===Ye.RowModified){for(t=tt.length-1;t>=0;t--)if(tt[t].NotificationPayload.EventType===Ye.RowDeleted&&tt[t].OriginalUID==e.NotificationPayload.Item.UID){ce({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=tt[t].NotificationPayload.Item.InstanceKey,tt.splice(t,1);break}}else if(e.NotificationPayload.EventType===Ye.RowDeleted){var c=et[e.NotificationPayload.Item.InstanceKey];if(delete et[e.NotificationPayload.Item.InstanceKey],c){e.OriginalUID=c;for(t=tt.length-1;t>=0;t--){var u=tt[t].NotificationPayload.Item.UID;if((tt[t].NotificationPayload.EventType===Ye.RowAdded||tt[t].NotificationPayload.EventType===Ye.RowModified)&&u==c){ce({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),tt[t].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,i=!0;break}}}}i?ce({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(ce({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),tt.push(e))}ce({message:"Notification queue length is "+tt.length})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),nt?(Qe&&(ce({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(Qe)),Qe=setTimeout(ct,$e),ce({message:"Timer to drain queue has started"})):ce({message:"The notification was received while notification processing was suspended"})}function it(e){var t,n;if(ut(e.NotificationPayload,!1),dt(e.NotificationPayload))st();else{var a=e.NotificationPayload.FolderId,o=null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.SkypeTeamsProperties;Object(X.i)("cal-showAddTeamsCalendars")&&o&&!Object(Z.o)(a)&&(a=function(e,t){var n=JSON.parse(t);if(null==n?void 0:n.cid){var r=n.cid.split("@")[0];e=r?Object(Z.O)(e,r):e}return e}(a,o),(null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=a));var i=Object(r.h)(a),c=Object(r.d)(a),u=Object(r.e)(a),d=Object(Z.o)(a),l=Object(Z.y)(a);d&&3==d.CalendarFolderType?st(a):i&&(c.length>0||Object.keys(u).length>0)?e.NotificationPayload.EventType==Ye.RowDeleted?function(e,t){var n=t.Item.InstanceKey;j(e,n)}(a,e.NotificationPayload):Object(Q.J)(e.NotificationPayload.Item.CalendarItemType)?function(e,t,n){var r=Object(Y.a)(n.NotificationPayload.Item,t);if(r.UID){Ot(e).forEach((function(a){var o=oe(r.ItemId,a);o.then((function(i){i&&"Success"==i.ResponseClass?function(e,t,n,r,a,o,i){if(ce({message:"Action to expand series completed successfully. Retrieved "+(a?a.length:0)+" items for dates: "+n.start.toString()+" - "+n.end.toString()+" ",folderId:r,notificationItem:e}),Ot(r).some((function(e){return Object(H.b)(n,e)}))){ce({message:"Updating all cached items for the series and removing nonexistant ones",folderId:r});var c=[];a&&c.push.apply(c,Object(z.__spread)(a)),o&&c.push(o);var u=c.map((function(e){return e.UID}));ft(n,e.ItemId.Id,e.InstanceKey,i,r,(function(e){return!u.includes(e.UID)})),s(o),I(r,a),a.forEach((function(e){s(e)}))}else ce({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:r}),He(r,!0)}(r,0,a,e,i.Occurrences.map((function(e){return Object(Y.a)(e,t)})),Object(Y.a)(i.RecurrenceMaster,t),n.InstanceKeyToDelete):lt(r,o,a,e,n.InstanceKeyToDelete,i)})).catch((function(t){lt(r,o,a,e,n.InstanceKeyToDelete,null,t.message)}))}))}}(a,l,e):function(e,t,n){var r=Object(Y.a)(n.Item,t),a=!1;switch(n.EventType){case Ye.RowAdded:a=!0;break;case Ye.RowModified:a=null==r.InstanceKey||Object(Q.G)(r.CalendarItemType)||Object(Q.z)(r.CalendarItemType)}ze(r,a,!1,!0)}(0,l,e.NotificationPayload):ce({message:i?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function ct(){var e=tt.length;if(e>=8||tt.some((function(e){return dt(e.NotificationPayload)})))st();else for(var t=0;t<e;t++){it(tt[t])}tt=[],et={},clearTimeout(Qe)}function ut(e,t){var n,r=(null===(n=e.Item)||void 0===n?void 0:n.ItemId)?e.Item.ItemId.Id:"<null>";if(ce({message:(t?"Got calendar notification":"Processing calendar notification")+" for event type "+e.EventType,folderId:e.FolderId,notificationPayload:e}),t){var a=e.Item?e.Item.CalendarItemType:"<null>";Object(J.p)("IncomingNotification",{NotificationType:e.EventType,ItemType:a,ItemId:r},{isCosmosDatapoint:!0})}}function dt(e){return e.EventType==Ye.Reload||e.Reload}function st(e){var t,n,r=e?[e]:Object.keys(Xe);try{for(var a=Object(z.__values)(r),o=a.next();!o.done;o=a.next()){He(o.value,!0)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function lt(e,t,n,r,a,o,i){if(void 0===i&&(i=null),o&&"ErrorItemNotFound"==o.ResponseCode)ce({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:r,notificationItem:e}),ft(n,e.ItemId.Id,e.InstanceKey,a,r);else{var c=o?o.ResponseCode+": "+o.MessageText:i;ce({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:r,notificationItem:e,errorMessage:c}),He(r,!0)}}function ft(e,t,n,r,a,o){var i=function(a){var i,c={start:a.Start,end:a.End},u=0==Object(H.j)(e,c,!0),d=a.InstanceKey==n||r&&a.InstanceKey==r||t&&t===(null===(i=a.SeriesMasterItemId)||void 0===i?void 0:i.Id);return u&&(Object(ue.c)(a)||d&&(!o||o(a)))};p(a,i);var c=Object(W.a)(a,i);M(c)}function vt(){nt&&(clearTimeout(Qe),ce({message:"Processing of notifications will be suspended"}),nt=!1)}function bt(){nt||(nt=!0,ce({message:"Processing of notifications will be resumed"}),Qe=setTimeout(ct,$e))}function Ot(e){return G(Object(r.d)(e))}Object(o.orchestrator)(k,(function(e){var t=e.previousEvents,n=e.reloadedEvents;n&&(t&&M(t),x(n))})),Object(o.orchestrator)(p,(function(e){var t=e.folderId,n=e.predicate,r=null;E(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return v(t,e.Key)})),M(r))})),Object(o.orchestrator)(j,(function(e){var t=e.folderId,n=e.instanceKey,r=null;m(t,n,(function(e){r=e})),r&&(r.forEach((function(e){return v(t,e.Key)})),M(r))})),Object(o.orchestrator)(_,(function(e){var t=e.lockId,n=e.folderId,r=e.dateRange,a=e.calendarEvents;R(t,n,r,a),a&&x(a)})),Object(o.orchestrator)(I,(function(e){var t=e.folderId,n=e.calendarEvents,o=Object(r.d)(t),i=Object(a.a)(n,o).eventsOverlapping;i.length>0&&(O(t,i,o),x(i))})),Object(o.orchestrator)(h,(function(e){var t=e.folderId,n=e.eventsReloaded,o=e.dateRanges,i=e.forceReplace,c=Object(r.a)(t),u=Object(a.a)(c,o).eventsOverlapping;O(t,n,o,i),k(u,n)})),Object(o.orchestrator)(K,(function(e){var t=e.folderId;!function(e){var t=Xe[e];t?(ce({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),de.g.importAndExecute(t.subscription,ot),delete Xe[e]):ce({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}(t),b(t),S(t)}));var It=n(3958),jt=n(1621),mt=n(347);function pt(e,t){var n=function(e){return Object(jt.d)(e)?Et:Object(jt.h)(e)?yt:Object(jt.e)(e)?gt:(Object(jt.i)(e),null)}(e.Recurrence);if(!n)return[Object(z.__assign)({},e)];var r=G(t),a=[],o=e.Recurrence.RecurrencePattern.Interval;r.forEach((function(t){var r=function(e,t){var n=Object(ee.Wb)(e.Start),r=Object(It.a)(n.tz,e.Recurrence),a={start:n,end:r};return function(e,t){e.start=Object(ee.p)(e.start,t.start)>0?e.start:t.start,e.end=null!=e.end&&Object(ee.p)(e.end,t.end)<0?e.end:t.end}(a,t),a}(e,t),i=n(e,r,o);a.push.apply(a,Object(z.__spread)(i))}));var i=Object(ee.x)(e.Start,Object(ee.Wb)(e.Start)),c=Object(ee.x)(e.End,Object(ee.Wb)(e.Start));return function(e,t,n,r){var a=[];return r.forEach((function(r){var o={};mt(o,e),o.Start=Object(ee.h)(r,t),o.End=Object(ee.h)(r,n),o.CalendarItemType="Occurrence",a.push(o)})),a}(e,i,c,a)}function Et(e,t,n){for(var r=[],a=Object(ee.s)(t.end,t.start),o=0;o<=a;o+=n){var i=Object(ee.e)(t.start,o);r.push(i)}return r}function yt(e,t,n){for(var r=[],a=e.Recurrence.RecurrencePattern,o=a.DaysOfWeek.split(" ").map((function(e){return ht(e)})),i=Math.max(ht(a.FirstDayOfWeek),0),c=t.start;Object(ee.p)(c,t.end)<=0;){for(var u=c,d=Object(ee.C)(u,i);Object(ee.p)(u,d)<=0;)o.includes(Object(ee.nb)(u))&&Object(H.t)(t,u)&&r.push(u),u=Object(ee.e)(u,1);c=Object(ee.ac)(Object(ee.e)(c,7*n),i)}return r}function gt(e,t,n){var r=[];if(Object(jt.b)(e.Recurrence))for(var a=(u=e.Recurrence.RecurrencePattern).DayOfMonth,o=t.start;Object(ee.p)(o,t.end)<=0;){for(var i=o,c=Object(ee.B)(i);Object(ee.p)(i,c)<=0;)Object(ee.lb)(i)==a&&Object(H.t)(t,i)&&r.push(i),i=Object(ee.e)(i,1);o=Object(ee.Zb)(Object(ee.i)(o,n))}else{var u,d=ht((u=e.Recurrence.RecurrencePattern).DaysOfWeek),s=-1;switch(u.DayOfWeekIndex){case"First":s=1;break;case"Second":s=2;break;case"Third":s=3;break;case"Fourth":s=4}for(o=t.start;Object(ee.p)(o,t.end)<=0;){var l=void 0;l=s>0?_t(d,s,o):Rt(d,o),Object(H.t)(t,l)&&r.push(l),o=Object(ee.Zb)(Object(ee.i)(o,n))}}return r}function ht(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function _t(e,t,n){var r=Object(ee.Zb)(n),a=(e-Object(ee.nb)(r)+7)%7+7*(t-1);return Object(ee.e)(r,a)}function Rt(e,t){var n=_t(e,5,t);return Object(ee.xb)(n)==Object(ee.xb)(t)?n:_t(e,4,t)}function St(e,t){if(t){var n=e.ParentFolderId.Id;e.Recurrence&&p(n,(function(t){return t.InstanceKey==e.InstanceKey})),p(n,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}Object(o.orchestrator)(q,(function(e){return Object(z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,d,s,l,f,v;return Object(z.__generator)(this,(function(b){switch(b.label){case 0:t=e.eventToCreate,n=e.actionToExecute,a=e.actionSource,o=e.onEventCreatedFailed,i=e.onEventCreatedSuccess,c=e.errorMessage,u=e.onEventCreatedLocally,O=t,d=Object(r.h)(O.ParentFolderId.Id),function(e,t,n,a){if(t){var o=e.ParentFolderId.Id;if(e.Recurrence){var i=Object(r.d)(o),c=pt(e,i);Object(ue.a)(c,!1);var u=c.map((function(e){return Object(z.__assign)(Object(z.__assign)({},e),{CalendarItemType:"Occurrence"})}));I(o,u)}Object(ue.b)(e);var d=e.Recurrence?Object(z.__assign)(Object(z.__assign)({},e),{CalendarItemType:"RecurringMaster"}):e;I(o,[d])}n(a)}(t,d,u,a),s=function(){return q(t,n,(function(){return o(c,null,a)}),i,a,c)},l=null,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,n(t)];case 2:return l=b.sent(),[3,4];case 3:throw f=b.sent(),St(t,d),o(f,s,a),f;case 4:if(v=null,!l.isSuccessful)throw St(t,d),o(c,s,a),c;return v=l.createdItem,function(e,t,n){t.ParentFolderId||(t.ParentFolderId=Object(z.__assign)({},e.ParentFolderId));if(n){var r=t.ParentFolderId.Id;p(r,(function(t){return t.ItemId.Id===e.ItemId.Id})),ze(t,!0,!1)}}(t,v,d),i(v),[2]}var O}))}))}));var Tt=n(347);function Ct(e,t){var n={Key:e,Start:t.Start,End:t.End};return Tt(t,n),t}var Pt=n(5082);var At=n(156),Ft=n(1760);function Nt(e,t){return void 0===t&&(t=!1),t?wt(e):Object(Ft.c)(e)}function wt(e){var t;return null===(t=e.SeriesMasterItemId)||void 0===t?void 0:t.Id}var Mt=n(347);function xt(e){if(e){var t=Object(Te.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(se.f)())}}function Dt(e){var t,n;if((n=e).Key&&void 0!==n.Start&&void 0!==n.End){e.Key;e=Object(z.__rest)(e,["Key"])}var r=Nt(e),a=null===(t=e.ParentFolderId)||void 0===t?void 0:t.Id;if(a){var o=Object(W.c)(r,a);o&&Object(se.q)(o,e)}}Object(o.mutator)(y,(function(e){var t=e.lockId,n=Object(Te.a)();Object(z.__spread)(n.calendarFolderEvents.keys()).forEach((function(e){n.calendarFolderEvents.get(e).locksInfo.get(t)&&Object(se.n)(t,n.calendarFolderEvents.get(e))})),n.fullItemsMruMap.delete(t)})),Object(o.mutator)(d,(function(e){var t=e.folderId,n=e.eventKey,r=e.event,a=Object(W.c)(n,t);a&&Object(se.q)(a,r,!0)})),Object(o.mutator)(l,(function(e){Dt(e.partialCalendarEvent)})),Object(o.mutator)(f,(function(e){Dt(e.event)})),Object(o.mutator)(R,(function(e){var t=e.lockId,n=e.folderId,a=e.dateRange,o=e.calendarEvents;xt(n);var i=Object(r.f)(n),c=Object(Pt.a)(),u=o.filter((function(e){return!Object(Q.J)(e.CalendarItemType)})).map((function(e){return Ct(e.ItemId.Id,e)})).filter((function(e){return!c[e.Key]}));Object(se.b)(a,u,t,i);var d=i.locksInfo.get(t).lockedDateRange,s=Object(ee.s)(d.end,d.start),l=Object(At.d)()?42:110;if(s>l){var f=function(e,t,n){var r=Object(ee.s)(t.end,t.start);if(r===n)return t;if(r>n)return{start:t.start,end:Object(ee.e)(t.start,n)};var a=n-r,o=Math.abs(Object(ee.s)(t.end,e.end)),i=Math.abs(Object(ee.s)(e.start,t.start)),c=t.start,u=t.end;if(o>0){var d=Math.min(a,o);u=Object(ee.e)(u,d),a-=d}if(a>0&&i>0){var s=Math.min(a,i);c=Object(ee.e)(c,-1*s)}return{start:c,end:u}}(d,a,l);Object(se.h)(f,t,i)}})),Object(o.mutator)(m,(function(e){var t=e.folderId,n=e.instanceKey,a=e.onEventsRemoved;xt(t);var o=Object(r.f)(t);a(Object(se.o)((function(e){return e.InstanceKey===n}),o))})),Object(o.mutator)(E,(function(e){var t=e.folderId,n=e.predicate,a=e.onEventsRemoved;xt(t);var o=Object(r.f)(t);a(Object(se.o)(n,o))})),Object(o.mutator)(S,(function(e){var t=e.folderId;Object(Te.a)().calendarFolderEvents.delete(t)})),Object(o.mutator)(O,(function(e){var t=e.folderId,n=e.calendarEvents,a=e.dateRanges,o=e.forceReplace;xt(t);var i=n.map((function(e){return Ct(e.ItemId.Id,e)})),c=Object(r.f)(t);o?Object(se.p)(i,c,a):Object(se.r)(i,c.events)})),Object(o.mutator)(C,(function(e){Mt(e.existingItem,e.updatedItem)}));var Lt=new Map;var kt=5;function Kt(e,t,n,r){qt(t,n);var a=e.eventKey,o=n.get(t),i=o.eventInfos,c=Object(z.__read)(i.filter((function(e){return e.eventKey===a})),1)[0];c?Bt(o.eventInfos.indexOf(c),e,o):(i.push(e),function(e,t){!function(e,t,n){for(;e.eventInfos.length>t&&0<e.eventInfos.length;)Vt(0,e,n)}(e,e.maxSize||kt,t)}(o,r));Object(z.__spread)(n.keys()).forEach((function(t){n.get(t).eventInfos.forEach((function(t){e.eventKey===t.eventKey&&(t.itemResponseShapeType=e.itemResponseShapeType)}))}))}function Ut(e,t,n,r){void 0===r&&(r=function(){}),qt(t,n);var a=n.get(t),o=Object(z.__read)(a.eventInfos.filter((function(t){return t.eventKey===e})),1)[0],i=a.eventInfos.indexOf(o);return-1!==i&&Vt(i,a,r),-1!==i}function qt(e,t){if(!t.get(e)){var n=function(e){return Lt.get(e)}(e);t.set(e,{eventInfos:[],maxSize:n})}}function Bt(e,t,n){if(-1===e)throw new Error("Item with eventKey "+t.eventKey+" does not exist in the MRU");n.eventInfos.splice(e,1),n.eventInfos.push(t)}function Vt(e,t,n){if(e<0||e>=t.eventInfos.length)throw new Error("Invalid index to remove "+e);var r=t.eventInfos[e];t.eventInfos.splice(e,1),n(r.eventKey)}function zt(e){if(e){var t=Object(Te.a)();t.calendarFolderEvents.get(e)||t.calendarFolderEvents.set(e,Object(se.f)())}}function Ht(e,t){return function(n){Object(se.i)([n],e,Object(Te.a)().calendarFolderEvents.get(t))}}Object(o.mutator)(i,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.partialCalendarEvent,o=e.itemResponseShapeType;zt(n);var i=Object(Te.a)();if(a){var c=Ct(t,a);Object(se.a)(c,r,i.calendarFolderEvents.get(n))}Kt({eventKey:t,itemResponseShapeType:o,folderId:n,loadState:0},r,i.fullItemsMruMap,Ht(r,n))})),Object(o.mutator)(c,(function(e){var t=e.eventKey,n=e.folderId,r=e.lockId,a=e.itemResponseShapeType;zt(n),Kt({eventKey:t,itemResponseShapeType:a,folderId:n,loadState:2},r,Object(Te.a)().fullItemsMruMap,Ht(r,n))})),Object(o.mutator)(u,(function(e){var t=e.lockId,n=e.eventKey,r=e.folderId,a=e.event,o=e.hasEventChanged,i=e.itemResponseShapeType,c=e.forceOverrideAllPropertiesForEventIfAvailable;zt(r);var u=Object(Te.a)(),d=Ct(n,a);Object(se.a)(d,t,u.calendarFolderEvents.get(r),o,c),Kt({eventKey:n,itemResponseShapeType:i,folderId:r,loadState:1},t,u.fullItemsMruMap,Ht(t,r))})),Object(o.mutator)(v,(function(e){var t=e.folderId,n=e.eventKey,r=Object(Te.a)();r.calendarFolderEvents.get(t)&&Object(z.__spread)(r.fullItemsMruMap.keys()).forEach((function(e){Ut(n,e,r.fullItemsMruMap)}))})),Object(o.mutator)(b,(function(e){var t=e.folderId,n=Object(Te.a)(),r=n.calendarFolderEvents.get(t);if(r){var a=Object(z.__spread)(r.locksInfo.entries()).reduce(Object(se.d)(),{}),o=Object.keys(a);Object(z.__spread)(n.fullItemsMruMap.keys()).forEach((function(e){o.forEach((function(t){return Ut(t,e,n.fullItemsMruMap)}))}))}})),Object(o.mutator)(Ge,(function(){var e=Object(Te.a)();Object(z.__spread)(e.fullItemsMruMap.keys()).forEach((function(t){!function(e,t){qt(e,t),t.get(e).eventInfos=[]}(t,e.fullItemsMruMap)}))})),Object(o.mutator)(T,(function(e){var t=Object(Te.a)(),n=e.lockId;!function(e,t,n){qt(t,n);var r=n.get(t),a=r.eventInfos,o=Object(z.__read)(a.filter((function(t){return t.eventKey===e})),1)[0];o&&Bt(r.eventInfos.indexOf(o),o,r)}(e.eventKey,n,t.fullItemsMruMap)}));var Gt=n(763);function Wt(e,t){var n;if(3==t){var r=Object(W.b)(e);n=(null==r?void 0:r.SeriesMasterItemId)?Object(te.a)({Id:r.SeriesMasterItemId.Id}):n=Object(Gt.a)({OccurrenceId:e})}else n=Object(te.a)({Id:e});return n}function Jt(e,t){t&&He(e.ParentFolderId.Id)}Object(o.orchestrator)(V,(function(e){return Object(z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,d,s,l,f,v,b,O,I;return Object(z.__generator)(this,(function(j){switch(j.label){case 0:t=e.eventId,n=e.eventScope,a=e.dataPoint,o=e.actionToExecute,i=e.onEventDeleteSuccess,c=e.onEventDeleteFailed,u=e.responseSent,d=e.actionSource,s=e.errorMessage,l=e.asyncUndoAction,f=Object(W.b)(t.Id),v=(m=f)&&Object(r.h)(m.ParentFolderId.Id),function(e,t,n){if(n){var r=e.ParentFolderId.Id;if(3==t||2==t){var a=e.Start;p(r,(function(n){return n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(ee.Gb)(n.Start,a))}))}else p(r,(function(t){return t.ItemId.Id===e.ItemId.Id}))}}(f,n,v),a&&a.markUserPerceivedTime(),b=Wt(t.Id,n),null,j.label=1;case 1:return j.trys.push([1,4,,5]),[4,l(f,u,d)];case 2:return j.sent()?(Jt(f,v),[2]):[4,o(b)];case 3:if(!j.sent().isSuccessful)throw new Error(s);return[3,5];case 4:throw O=j.sent(),Jt(f,v),I=function(){return V(t,n,null,o,i,(function(){return c(O,null,d)}),d,s,u)},c(O,I,d),O;case 5:return i(),[2]}var m}))}))}));var Zt=n(9013),Qt=n(9100),Yt=(Object(o.orchestrator)(s,(function(e){return Object(z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,a,o,i;return Object(z.__generator)(this,(function(c){switch(c.label){case 0:return t=e.partialCalendarEvent,n=Nt(t),r=t.ParentFolderId.Id,null===Object(Pt.f)(t.ItemId.Id)?[3,2]:(a=Object(Pt.b)(t.ItemId.Id),o=Object(Qt.a)(a),[4,Object(Zt.a)(t.ItemId,r,o)]);case 1:(i=c.sent().calendarEvent)&&d(r,n,a,i),c.label=2;case 2:return[2]}}))}))})),n(373));Object(o.orchestrator)(B,(function(e){return Object(z.__awaiter)(void 0,void 0,void 0,(function(){var t,n,a,o,i,c,u,d,s,l,f,v,b,O,j,m;return Object(z.__generator)(this,(function(E){switch(E.label){case 0:t=e.eventId,n=e.eventChanges,a=e.errorMessage,o=e.actionToExecute,i=e.onEventUpdateFailed,c=e.onEventUpdateSuccess,u=e.onEventUpdatedLocally,d=e.actionSource,s=e.eventScope,l=Object(W.b)(t.Id),f=Wt(t.Id,e.eventScope),l&&Object(Q.J)(l.CalendarItemType)&&(s=3),(v=function(e,t){if(!e)return!1;var n=e.ParentFolderId.Id;if(!Object(r.h)(n))return!1;var a=t.ParentFolderId;if(a&&a.Id!=n)return!1;return!0}(l,n))&&function(e,t,n,a,o){var i,c,u=e.ParentFolderId.Id;!Object(Q.G)(e.CalendarItemType)||0!=n&&1!=n||(t.CalendarItemType="Exception");var d=Object(z.__assign)(Object(z.__assign)({},e),t);if(3==n||2==n)if(t.Recurrence||t.Start||t.StartTimeZoneId||t.End||t.EndTimeZoneId||2==n){var s=e.Start;if(p(u,(function(t){return(Object(Q.G)(t.CalendarItemType)||Object(Q.z)(t.CalendarItemType))&&t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(ee.Gb)(t.Start,s))})),3===n||2===n){var l=Object(r.d)(u);2===n&&(l=l.map((function(e){return{start:Object(ee.Qb)(e.start.tz,e.start),end:Object(ee.Qb)(e.end.tz,e.end)}})),y=l,g=e.Start,h=[],y.forEach((function(e,t){Object(ee.p)(e.start,g)<=0&&Object(ee.p)(e.end,g)<=0&&h.push(t),Object(ee.p)(e.start,g)<=0&&Object(ee.p)(e.end,g)>0&&(e.start=Object(ee.Wb)(g))})),h.reverse().forEach((function(e){y.splice(e,1)})));var f=d;"Occurrence"!=d.CalendarItemType||d.Recurrence||(f=Object(W.b)(d.SeriesMasterItemId.Id))||(f=d);var v=pt(f,l);Object(ue.a)(v.concat(d),!0),delete t.Start,delete t.End;var b=v.map((function(e){return Object(z.__assign)(Object(z.__assign)(Object(z.__assign)({},e),t),{CalendarItemType:"Occurrence"})}));I(d.ParentFolderId.Id,b)}}else{var O=Object(W.a)(u,(function(t){return t.InstanceKey==e.InstanceKey&&Object(Q.G)(t.CalendarItemType)}));try{for(var j=Object(z.__values)(O),m=j.next();!m.done;m=j.next()){var E=m.value;C(E,t),D(E)}}catch(e){i={error:e}}finally{try{m&&!m.done&&(c=j.return)&&c.call(j)}finally{if(i)throw i.error}}}var y,g,h;if(!Object(Q.z)(e.CalendarItemType)||3!=n){var _=null==e.InstanceKey||Object(Q.G)(e.CalendarItemType)||Object(Q.z)(e.CalendarItemType);ze(d,_,!0)}a(d,o)}(l,n,s,u,d),b=function(){return B(t,n,s,o,c,(function(){return i(a,null,d)}),d,a)},O=null,E.label=1;case 1:return E.trys.push([1,3,,4]),[4,o(f)];case 2:return O=E.sent(),[3,4];case 3:throw j=E.sent(),v&&He(l.ParentFolderId.Id),i(j,b,d),j;case 4:if(!O.isSuccessful)throw v&&He(l.ParentFolderId.Id),i(a,b,d),a;return(null===(m=n.ParentFolderId)||void 0===m?void 0:m.mailboxInfo)&&Object(Yt.r)(n.ParentFolderId.mailboxInfo.userIdentity)&&(He(n.ParentFolderId.Id,!0),He(l.ParentFolderId.Id,!0)),c(),[2]}}))}))}));var $t=n(123),Xt=(Object(o.orchestrator)($t.l,We),n(69));function en(e){var t=Object(Z.u)(e),n=t&&Object(Z.p)({id:t});return n?n.CharmId:null}function tn(e){return(null==e?void 0:e.CharmId)||en(e.ParentFolderId.Id)}function nn(){Object(r.b)().map((function(e){Object(Se.e)(Object(Z.o)(e))&&Ve(e,!0)}))}var rn=3e5;function an(e){e?Object(Je.b)(nn,"RELOAD_LINKEDCALENDAR_ENTRIES",rn):Object(Je.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function on(e,t,n){return{FreeBusyType:"Decline"===n?"Free":"Free"===e&&"Decline"!==t?"Free":"Accept"===n?"Busy":"Tentative",AppointmentReplyTime:Object(ee.Pb)(),ResponseType:n}}var cn=n(7377),un=n(233),dn=n(4599),sn=n(18),ln={};function fn(e,t){return e+t}function vn(e,t){var n=fn(e,t);return ln[n]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function bn(e,t,n,r,a,o){var i,c,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d=In(n,r);o||(o=Object(Pt.b)(t.Id));var s,l=Object(Pt.e)(t.Id,o);if(l)s=function(e,t,n,r,a,o){var i=a(t);switch(n.loadState){case 1:return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2};case 0:return{event:i,fullEventPromise:vn(t.Id,o),promiseSource:0};case 2:var c=mn(i,t,r,e,o);return Object(z.__assign)({event:i},c);default:return Object(un.a)(n.loadState)}}(n=n||l.folderId,t,l,!1,d,o);else{var f=d(t),v=mn(f,t,!1,n||(null===(i=null==f?void 0:f.ParentFolderId)||void 0===i?void 0:i.Id)||null,o);s=Object(z.__assign)({event:f},v)}var b=null;return s&&(n=n||(null===(u=null===(c=s.event)||void 0===c?void 0:c.ParentFolderId)||void 0===u?void 0:u.Id)||null,b={event:s.event,fullEventPromise:pn(s.fullEventPromise,s.promiseSource,s.event,e,n,a,t.Id,!1,o)}),b}function On(e,t,n,r,a,o){var i,c,u;void 0===n&&(n=null),void 0===a&&(a={fetchSource:"unknown"});var d,s=In(n,r)(t);n=n||(null===(i=null==s?void 0:s.ParentFolderId)||void 0===i?void 0:i.Id);var l=s&&wt(s);o||(o=l?Object(Pt.b)(l):Object(Pt.c)());var f=null;return(d=function(e,t,n,r,a){var o=r&&Object(Pt.e)(r,n);if(o&&1===o.loadState){var i=Object(W.c)(r,e);return{event:i,fullEventPromise:Promise.resolve({calendarEvent:i,error:null}),promiseSource:2}}return o&&0===o.loadState?{event:Object(W.c)(r,e)||jn(a),fullEventPromise:vn(r,n),promiseSource:0}:{event:jn(a),fullEventPromise:En(t,!0,e,n),promiseSource:0}}(n,t,o,l,s))&&(n=n||(null===(u=null===(c=d.event)||void 0===c?void 0:c.ParentFolderId)||void 0===u?void 0:u.Id)||null,f={event:d.event,fullEventPromise:pn(d.fullEventPromise,d.promiseSource,d.event,e,n,a,l,!0,o)}),f}function In(e,t){return function(n){return Object(W.b)(n.Id,e)||(null==t?void 0:t(n))}}function jn(e){return e&&Object(z.__assign)(Object(z.__assign)({},Object(dn.a)(Object(sn.toJS)(e))),{ItemId:Object(z.__assign)({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function mn(e,t,n,r,a){return e&&e.EffectiveRights&&!Object(Q.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:En(t,n,r,a),promiseSource:0}}function pn(e,t,n,r,a,o,d,s,l){return Object(z.__awaiter)(this,void 0,void 0,(function(){var f,v,b,O,I,j,m,p,E,y;return Object(z.__generator)(this,(function(g){switch(g.label){case 0:f=Object(Pt.d)(r,d,l),v=null,b=null,O=null,g.label=1;case 1:return g.trys.push([1,5,6,7]),Re.g.info("[fetchFullCalendarEvent] Handling loading full calendar event Key: "+d+", Lock: "+r),!a||f&&1===f.loadState||d&&(Re.g.info("[fetchFullCalendarEvent] Loading full calendar event Key: "+d+", Lock: "+r),function(e,t,n){var r=fn(e,t);ln[r]=n}(d,l,e),i(r,a,d,l,n)),2!=t?[3,2]:(v=n,[3,4]);case 2:return[4,e];case 3:I=g.sent(),v=null==I?void 0:I.calendarEvent,b=null==I?void 0:I.error,O=null==I?void 0:I.responseCode,void 0===d&&(d=Nt(I.calendarEvent)),g.label=4;case 4:if(!v)throw j=new Error("[fetchFullCalendarEvent] Action source:"+o.fetchSource+" with response code: "+(null!=O?O:"<null>")+" and error: "+b),O&&(j.responseCode=O,j.fetchErrorType="ServerFailure"),j.diagnosticInfo=JSON.stringify({responseCode:O,eventKey:d}),j;return m=a||v.ParentFolderId.Id,y=f,f=Object(Pt.d)(r,d,l),!m||f&&1===f.loadState?(Re.g.info('[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "'+d+'", Lock: "'+r+'", FolderId: "'+m+'"'),T(r,d)):(Re.g.info('[fetchFullCalendarEvent] Loaded full calendar event Key: "'+d+'", Lock: "'+r+'", FolderId: "'+m+'"'),Object(J.p)("FullCalendarEventLoaded",Object(z.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:y?y.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:void 0!==v.RequiredAttendees,isSameAsExistingEvent:n===v,eventScope:s?3:0,errorMessage:null},o)),u(r,m,d,l,v,s,0===t)),(p=Object(W.c)(d,a))&&D(p),[2,p];case 5:throw E=g.sent(),y=f,f=Object(Pt.d)(r,d,l),Object(J.p)("FullCalendarEventLoaded",Object(z.__assign)({eventKey:d,lockId:r,prevFullItemLoadState:y?y.loadState:null,fullItemLoadState:f?f.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:s?3:0,errorMessage:E.toString()},o)),a&&c(r,a,d,l),E;case 6:return function(e,t){var n=fn(e,t);delete ln[n]}(d,l),[7];case 7:return[2]}}))}))}function En(e,t,n,r){var a=this;return Object(z.__awaiter)(a,void 0,void 0,(function(){return Object(z.__generator)(this,(function(a){switch(a.label){case 0:return[4,yn(fe,e,t,n,r)];case 1:return[2,a.sent()]}}))}))}function yn(e,t,n,r,a){return Object(z.__awaiter)(this,void 0,void 0,(function(){var o,i,c;return Object(z.__generator)(this,(function(u){switch(u.label){case 0:o=0,u.label=1;case 1:if(!(o<e))return[3,6];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,Object(Zt.a)(t,r,Object(Qt.a)(a),n)];case 3:return i=u.sent(),o++,!i.error||o>=e?[2,i]:[3,5];case 4:if(c=u.sent(),Re.g.warn('[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "'+t.Id+'" with try '+o+": Error "+c.toString()),++o>=e)throw c;return[3,5];case 5:return[3,1];case 6:return[2,{calendarEvent:null,error:"Error: Unable to fetch event"}]}}))}))}function gn(e){var t=this;if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:function(t,n){var r=Ke(e,t,n);return{fetchPromise:r.fetchPromise,enhancedFetchPromise:r.enhancedFetchPromise,events:r.events}},subscribeNotifications:function(t){return at(t,e)},fetchFullCalendarEvent:function(n,r,a,o,i){var c=Object(W.b)(n.Id),u=hn(e,n,r,a,o,i,(null==c?void 0:c.IsOrganizer)?"WithBlockedExternalContent":null),d=u.event,s=u.fullEventPromise;return s=s.then((function(c){return Object(z.__awaiter)(t,void 0,void 0,(function(){return Object(z.__generator)(this,(function(t){switch(t.label){case 0:return c.IsOrganizer&&c.HasBlockedImages?[4,hn(e,n,r,a,o,i,"WithBlockedExternalContent").fullEventPromise]:[3,2];case 1:c=t.sent(),t.label=2;case 2:return[2,c]}}))}))})),{event:d,fullEventPromise:s}},fetchFullCalendarEventAndUpdateItemResponseShapeType:function(t,n,r,a,o,i){return hn(e,t,r,a,o,i,n)},getLockId:function(){return e},release:function(){return g(e)}}}function hn(e,t,n,r,a,o,i){return a?On(e,t,n,r,o,i):bn(e,t,n,r,o,i)}function _n(e,t){var n=Object(se.g)(e);return t&&function(e,t){t?Lt.set(e,t):Lt.delete(e)}(n,t.maxMruSize),gn(n)}function Rn(e){return{getCalendarEventsForDateRange:function(t,n){return le(e,t,n)},getEnhancedCalendarEventsForDateRange:function(t,n){return function(e,t,n){return Me(t,n)?le(e,t,n):null}(e,t,n)},getFullCalendarEvent:function(t,n){return Object(W.d)(t,n,e)}}}function Sn(e){return Object(Te.a)().calendarFolderWorkingHours.get(e)}n.d(t,"u",(function(){return Cn})),n.d(t,"k",(function(){return W.b})),n.d(t,"c",(function(){return M})),n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return D})),n.d(t,"d",(function(){return L})),n.d(t,"g",(function(){return K})),n.d(t,"v",(function(){return U})),n.d(t,"r",(function(){return q})),n.d(t,"t",(function(){return B})),n.d(t,"s",(function(){return V})),n.d(t,"x",(function(){return bt})),n.d(t,"y",(function(){return vt})),n.d(t,"i",(function(){return en})),n.d(t,"m",(function(){return tn})),n.d(t,"o",(function(){return Wt})),n.d(t,"n",(function(){return Pt.f})),n.d(t,"w",(function(){return an})),n.d(t,"j",(function(){return on})),n.d(t,"h",(function(){return oe})),n.d(t,"e",(function(){return cn.a})),n.d(t,"f",(function(){return _n})),n.d(t,"q",(function(){return gn})),n.d(t,"p",(function(){return Rn})),n.d(t,"l",(function(){return Sn}));var Tn=new Xt.c((function(){return Promise.all([n.e(1),n.e(359)]).then(n.bind(null,16653))})),Cn=new Xt.a(Tn,(function(e){return e.getCalendarEventsFromRest}))},1541:function(e,t,n){"use strict";n.d(t,"z",(function(){return r})),n.d(t,"p",(function(){return a})),n.d(t,"B",(function(){return o})),n.d(t,"C",(function(){return i})),n.d(t,"A",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"y",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"q",(function(){return l})),n.d(t,"s",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"D",(function(){return b})),n.d(t,"u",(function(){return O})),n.d(t,"a",(function(){return I})),n.d(t,"w",(function(){return j})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return E})),n.d(t,"E",(function(){return y})),n.d(t,"v",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return _})),n.d(t,"d",(function(){return R})),n.d(t,"r",(function(){return S})),n.d(t,"t",(function(){return T})),n.d(t,"l",(function(){return C})),n.d(t,"i",(function(){return P})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return F})),n.d(t,"o",(function(){return N})),n.d(t,"n",(function(){return w}));var r="Sunday",a="Monday",o="Tuesday",i="Wednesday",c="Thursday",u="Friday",d="Saturday",s=[r,a,o,i,c,u,d],l=["January","February","March","April","May","June","July","August","September","October","November","December"],f="None",v="DailyRecurrence",b="WeeklyRecurrence",O="RelativeMonthlyRecurrence",I="AbsoluteMonthlyRecurrence",j="RelativeYearlyRecurrence",m="AbsoluteYearlyRecurrence",p=["None","First","Second","Third","Fourth","Last"],E="DailyRecurrence:#Exchange",y="WeeklyRecurrence:#Exchange",g="RelativeMonthlyRecurrence:#Exchange",h="AbsoluteMonthlyRecurrence:#Exchange",_="RelativeYearlyRecurrence:#Exchange",R="AbsoluteYearlyRecurrence:#Exchange",S="NoEndRecurrence:#Exchange",T="NumberedRecurrence:#Exchange",C="EndDateRecurrence:#Exchange",P=3,A=25,F=1,N=1,w=99},1621:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f}));var r=n(1541);function a(e){return e?l(e)?r.e:f(e)?r.D:d(e)?r.u:c(e)?r.a:s(e)?r.w:u(e)?r.c:r.s:r.s}function o(e){return c(e)||d(e)}function i(e){return u(e)||s(e)}function c(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.b}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.d}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.v}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.x}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==r.E}},1720:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0);function a(e){return Object(r.__assign)({__type:"ExtendedPropertyType:#Exchange"},e)}},1760:function(e,t,n){"use strict";var r=n(2678),a=n(7375),o=(n(7376),n(9));var i=n(1824),c=function(e,t){return Object(o.zb)(e.Start)<Object(o.zb)(t.End)&&Object(o.zb)(e.End)>Object(o.zb)(t.Start)},u=function(e,t){return t.filter((function(t){return t!=e&&c(e,t)})).sort(r.a)};function d(e,t){var n,r,a,i,c;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,a=n.Start,i=Object(o.Qb)(r,a),c=Object(o.Wb)(i),Object(o.ub)(c))}var s=n(2596);function l(e){e.Start=Object(o.Qb)(e.StartTimeZoneId,e.Start),e.End=Object(o.Qb)(e.EndTimeZoneId,e.End)}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return l}))},1854:function(e,t,n){"use strict";var r=n(0),a=n(84),o=255,i=175,c="_____";function u(e){if(!e)return null;var t=e.indexOf(c);-1!=t&&(e=e.substring(0,t));var n=Object(a.i)("cal-mf-joinButton")?i:o;if((e=e.trim()).length<n)return e;var r=e.substr(0,n).trim();return r.length>0?r.concat("..."):null}var d=n(287),s=n(123),l=n(5),f=n(9),v=n(4276),b=n(4277),O=n(1720),I=n(4278),j=n(4279);n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return g}));var m=Object(v.a)(),p=[[Object(f.mc)("2019-11-03T00:00:00.000-03:00"),Object(f.mc)("2020-02-15T23:59:59.999-03:00")],[Object(f.mc)("2020-11-08T00:00:00.000-03:00"),Object(f.mc)("2021-02-20T23:59:59.999-03:00")],[Object(f.mc)("2021-11-07T00:00:00.000-03:00"),Object(f.mc)("2022-02-20T23:59:59.999-03:00")]];function E(e,t){t=t||Object(d.d)();var n=[],o=!1,i=null;if(null==e?void 0:e.ExtendedProperty){var c=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===b.a.PropertyName}))[0];if(null==c?void 0:c.Value)try{n=JSON.parse(c.Value)}catch(e){n=[]}e.ExtendedProperty.some((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===I.a.PropertyName&&!!e.Value}))&&(o=!0),(null==(c=e.ExtendedProperty.filter((function(e){var t;return(null===(t=e.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===j.a.PropertyName}))[0])?void 0:c.Value)&&(i=c.Value)}var l=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m),e),{ItemId:e.ItemId?Object(r.__assign)(Object(r.__assign)({},e.ItemId),{mailboxInfo:t}):e.ItemId,ParentFolderId:e.ParentFolderId?Object(r.__assign)(Object(r.__assign)({},e.ParentFolderId),{mailboxInfo:t}):e.ParentFolderId,Start:y(e.Start),End:y(e.End),StartTimeZoneId:Object(s.b)(e.StartTimeZoneId),EndTimeZoneId:Object(s.b)(e.EndTimeZoneId),LastModifiedTime:y(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:y(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object(r.__assign)(Object(r.__assign)({},e.SeriesMasterItemId),{mailboxInfo:t}):null,Sensitivity:"GroupMailbox"==t.type&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:u(e.Preview),AppendOnSend:n,IsBookedFreeBlocks:o,CollabSpace:i});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(a.i)("cal-killSwitch-63446")&&l.Start&&l.End&&p.some((function(e){var t=Object(r.__read)(e,2),n=t[0],a=t[1];return Object(f.Mb)(l.Start,n,a)}))){var v=Object(f.x)(l.End,l.Start);l.Start=Object(f.f)(l.Start,1),l.End=Object(f.h)(l.Start,v),l.StartTimeZoneId=l.EndTimeZoneId,l.__BrazilHack__=1}return l}function y(e){if(e){if(Object(a.i)("cal-assumeTzOffsetFromCalendarItem")){var t=Object(l.a)().timezone,n=!!t;return Object(f.Rb)(t,e,n)}return Object(f.pb)(e)}}function g(e){var t=[];return e.AppendOnSend&&e.AppendOnSend.length>0&&t.push(Object(O.a)({ExtendedFieldURI:b.a,Value:JSON.stringify(e.AppendOnSend)})),e.IsBookedFreeBlocks&&t.push(Object(O.a)({ExtendedFieldURI:I.a,Value:e.IsBookedFreeBlocks.toString()})),e.CollabSpace&&t.push(Object(O.a)({ExtendedFieldURI:j.a,Value:e.CollabSpace})),Object(r.__assign)(Object(r.__assign)({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(f.qb)(e.Start),End:e.End&&Object(f.qb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(f.qb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(f.qb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:t})}},2053:function(e,t,n){"use strict";function r(e){var t;if(null===(t=null==e?void 0:e.ItemId)||void 0===t?void 0:t.Id){var n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var a=n(0),o=n(687),i=n(351);function c(e,t){var n=Object(i.a)();e.forEach((function(e){var r=Object(i.a)();d(e,n,r,t),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!t?e.InstanceKey:n}))}function u(e){var t=Object(i.a)();d(e,t,t,!1)}function d(e,t,n,r){e.ItemId=Object(a.__assign)(Object(a.__assign)({},Object(o.a)({Id:n})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!r||(e.ClientSeriesId=t),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}))},2388:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l}));var r=2,a=4,o=8,i=32,c=64,u=128,d=4294967296,s=8589934592,l=17179869184},2596:function(e,t,n){"use strict";var r=n(9);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},2678:function(e,t,n){"use strict";var r=n(30),a=n(7375),o=n(2596),i=n(9),c=n(179);function u(e){var t=Object(c.w)();return e.ParentFolderId&&t&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(c.l)(Object(c.w)()).ParentGroupId,n=Object(c.o)(e.ParentFolderId.Id);return n&&n.ParentGroupId===t}function s(e,t){var n=Object(o.a)(e);if(n!=Object(o.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(i.w)(e.Start,t.Start)))return r;if(v(e)&&v(t)){var c=u(e);if(c!=u(t))return c?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(a.a)(e,t))?r:0!=(r=Object(i.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(i.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.e),1)}function v(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}n.d(t,"a",(function(){return s}))},3133:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(69),a=n(5021);n.d(t,"a",(function(){return a.a}));var o=new r.c((function(){return Promise.all([n.e(97),n.e(801)]).then(n.bind(null,9552))})),i=new r.a(o,(function(e){return e.getTxpObjectFromTxpEntities}))},3316:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s}));var r=n(0),a=n(4999),o=n(4596),i=n(4242);function c(e,t){var n=Object(o.a)().calendarFolderEvents.get(e);return n?Object(r.__spread)(n.events.values()).filter(t):[]}function u(e,t){return void 0===t&&(t=null),t?Object(r.__read)(c(t,(function(t){return t.ItemId.Id===e})),1)[0]||null:function(e){for(var t=Object(o.a)(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var i=n[a],c=t.calendarFolderEvents.get(i),u=Object(r.__read)(c?Object(r.__spread)(c.events.values()).filter(e):[null],1)[0];if(u)return u}return null}((function(t){return t.ItemId.Id===e}))}function d(e,t){void 0===t&&(t=null);var n=Object(o.a)();return t?n.calendarFolderEvents.get(t).events.get(e)||null:function(e){for(var t=Object(o.a)(),n=Object(r.__spread)(t.calendarFolderEvents.keys()),a=0;a<n.length;a++){var i=n[a],c=d(e,i);if(c)return c}return null}(e)}function s(e,t,n){var c=null,u=(c=e?function(e,t,n){var i=Object(o.a)().calendarFolderEvents.get(e);return i&&Object(r.__read)(Object(a.l)([t],n,i),1)[0]||null}(e,t,n):function(e,t){for(var n=Object(o.a)(),i=Object(r.__spread)(n.calendarFolderEvents.keys()),c=0;c<i.length;c++){var u=i[c],d=n.calendarFolderEvents.get(u),s=Object(r.__read)(d?Object(a.l)([e],t,d):[null],1)[0];if(s)return s}return null}(t,n))?"1":"no";return Object(i.a)({lockId:n,updateMessage:"Got "+u+" item from the cache for given folder and key"}),c}},3745:function(e){e.exports=JSON.parse('{"a":"Tfa"}')},3958:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9);function a(e,t){if(null==t?void 0:t.RecurrenceRange){var n=t.RecurrenceRange.EndDate;if(n)return Object(r.Qb)(e,n)}return null}},4219:function(e,t,n){"use strict";var r=n(3),a=Object(r.action)("poll",(function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}})),o=Object(r.action)("cancelPoll",(function(e){return{requestIdentifier:e}})),i={currentRequest:new(n(18).ObservableMap)},c=Object(r.createStore)("requestIdStore",i);Object(r.mutator)(o,(function(e){var t=c().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}}));var u=n(0),d=Object(r.mutatorAction)("setCurrentRequestId",(function(e,t){var n=c().currentRequest.get(e);n?n.requestId=t:c().currentRequest.set(e,{requestId:t,timer:null})}));function s(e,t){return c().currentRequest.get(e).requestId===t}function l(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,r,a;return Object(u.__generator)(this,(function(o){switch(o.label){case 0:return n=Math.random(),d(t,n),[4,e()];case 1:return r=o.sent(),a={isCurrent:s(t,n)},[2,Object(u.__assign)({response:r},a)]}}))}))}var f=Object(r.mutatorAction)("setPollTimer",(function(e,t){var n=c().currentRequest.get(e);n&&(n.timer=t)}));Object(r.orchestrator)(a,(function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;o(n);var i=setTimeout((function(){return function(e,t,n){return Object(u.__awaiter)(this,void 0,void 0,(function(){return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return[4,l((function(){return e()}),t)];case 1:return r.sent(),a(e,t,n),[2]}}))}))}(t,n,r)}),r);f(n,i)})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},4232:function(e,t,n){"use strict";var r=n(1662);var a=n(2388),o=n(84),i="cal-txp-invoice";function c(e){return function(e,t,n){return Object(r.a)(e,t)==t&&n}(e,a.c,Object(o.i)(i))}n.d(t,"a",(function(){return c}))},4276:function(e,t,n){"use strict";function r(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,MeetingNotesWebUrl:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0,CollabSpace:void 0}}n.d(t,"a",(function(){return r}))},4277:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(417),a=Object(r.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})},4278:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(524),a=Object(r.a)("6ed8da90-450b-101b-98da-00aa003f1305","IsBookedFreeBlocks","Boolean")},4279:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(417),a=Object(r.a)({DistinguishedPropertySetId:"PublicStrings",PropertyName:"MeetingAgenda",PropertyType:"String"})},4545:function(e,t,n){"use strict";var r=n(1572),a=n(1828),o=n(1403),i=n(1500),c=n(1302);var u=function(e,t){return e&&Object(i.a)(t,Object(c.a)(t),e)},d=n(1452);var s=function(e,t){return e&&Object(i.a)(t,Object(d.a)(t),e)},l=n(1826),f=n(1825),v=n(1317);var b=function(e,t){return Object(i.a)(e,Object(v.a)(e),t)},O=n(1530);var I=function(e,t){return Object(i.a)(e,Object(O.a)(e),t)},j=n(1647),m=n(1939),p=n(1509),E=Object.prototype.hasOwnProperty;var y=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&E.call(e,"index")&&(n.index=e.index,n.input=e.input),n},g=n(1482);var h=function(e,t){var n=t?Object(g.a)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},_=/\w*$/;var R=function(e){var t=new e.constructor(e.source,_.exec(e));return t.lastIndex=e.lastIndex,t},S=n(522),T=S.a?S.a.prototype:void 0,C=T?T.valueOf:void 0;var P=function(e){return C?Object(C.call(e)):{}},A=n(1827),F="[object Boolean]",N="[object Date]",w="[object Map]",M="[object Number]",x="[object RegExp]",D="[object Set]",L="[object String]",k="[object Symbol]",K="[object ArrayBuffer]",U="[object DataView]",q="[object Float32Array]",B="[object Float64Array]",V="[object Int8Array]",z="[object Int16Array]",H="[object Int32Array]",G="[object Uint8Array]",W="[object Uint8ClampedArray]",J="[object Uint16Array]",Z="[object Uint32Array]";var Q=function(e,t,n){var r=e.constructor;switch(t){case K:return Object(g.a)(e);case F:case N:return new r(+e);case U:return h(e,n);case q:case B:case V:case z:case H:case G:case W:case J:case Z:return Object(A.a)(e,n);case w:return new r;case M:case L:return new r(e);case x:return R(e);case D:return new r;case k:return P(e)}},Y=n(1855),$=n(1205),X=n(1294),ee=n(684),te="[object Map]";var ne=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==te},re=n(1324),ae=n(1338),oe=ae.a&&ae.a.isMap,ie=oe?Object(re.a)(oe):ne,ce=n(531),ue="[object Set]";var de=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==ue},se=ae.a&&ae.a.isSet,le=se?Object(re.a)(se):de,fe=1,ve=2,be=4,Oe="[object Arguments]",Ie="[object Function]",je="[object GeneratorFunction]",me="[object Object]",pe={};pe[Oe]=pe["[object Array]"]=pe["[object ArrayBuffer]"]=pe["[object DataView]"]=pe["[object Boolean]"]=pe["[object Date]"]=pe["[object Float32Array]"]=pe["[object Float64Array]"]=pe["[object Int8Array]"]=pe["[object Int16Array]"]=pe["[object Int32Array]"]=pe["[object Map]"]=pe["[object Number]"]=pe[me]=pe["[object RegExp]"]=pe["[object Set]"]=pe["[object String]"]=pe["[object Symbol]"]=pe["[object Uint8Array]"]=pe["[object Uint8ClampedArray]"]=pe["[object Uint16Array]"]=pe["[object Uint32Array]"]=!0,pe["[object Error]"]=pe[Ie]=pe["[object WeakMap]"]=!1;t.a=function e(t,n,i,d,v,O){var E,g=n&fe,h=n&ve,_=n&be;if(i&&(E=v?i(t,d,v,O):i(t)),void 0!==E)return E;if(!Object(ce.a)(t))return t;var R=Object($.a)(t);if(R){if(E=y(t),!g)return Object(f.a)(t,E)}else{var S=Object(p.a)(t),T=S==Ie||S==je;if(Object(X.a)(t))return Object(l.a)(t,g);if(S==me||S==Oe||T&&!v){if(E=h||T?{}:Object(Y.a)(t),!g)return h?I(t,s(E,t)):b(t,u(E,t))}else{if(!pe[S])return v?t:{};E=Q(t,S,g)}}O||(O=new r.a);var C=O.get(t);if(C)return C;O.set(t,E),le(t)?t.forEach((function(r){E.add(e(r,n,i,r,t,O))})):ie(t)&&t.forEach((function(r,a){E.set(a,e(r,n,i,a,t,O))}));var P=_?h?m.a:j.a:h?keysIn:c.a,A=R?void 0:P(t);return Object(a.a)(A||t,(function(r,a){A&&(r=t[a=r]),Object(o.a)(E,a,e(r,n,i,a,t,O))})),E}},4597:function(e){e.exports=JSON.parse('{"a":"Vfa"}')},4598:function(e){e.exports=JSON.parse('{"a":"Ufa"}')},4599:function(e,t,n){"use strict";var r=n(4545),a=1,o=4;t.a=function(e){return Object(r.a)(e,a|o)}},5021:function(e,t,n){"use strict";var r=n(2388),a=n(1742),o=n(1662);var i=n(4232);function c(e){return function(e){return!(e<=0)&&(Object(o.a)(e,a.a)==a.a||Object(o.a)(e,r.d)==r.d||Object(o.a)(e,r.e)==r.e||Object(o.a)(e,a.b)==a.b||Object(o.a)(e,r.a)==r.a||Object(o.a)(e,r.b)==r.b||Object(o.a)(e,r.f)==r.f)}(e)||function(e){return Object(o.a)(e,r.g)==r.g||Object(o.a)(e,r.h)==r.h||Object(o.a)(e,r.i)==r.i}(e)||Object(i.a)(e)}n.d(t,"a",(function(){return c}))},5082:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return f}));var r=n(0),a=n(18),o=n(4596);function i(){return v.get()}function c(e,t){var n=u(e);return n&&n.itemResponseShapeType===t?n:null}function u(e){var t=i()[e];return t||null}function d(e,t,n){var a=Object(o.a)().fullItemsMruMap.get(e);if(a){var i=Object(r.__read)(a.eventInfos.filter((function(e){return e.eventKey===t})),1)[0];if(i&&i.itemResponseShapeType===n)return i}return null}function s(e){var t=u(e);return t?t.loadState:null}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.itemResponseShapeType;return n||"Default"}function f(){return"Default"}var v=Object(a.computed)((function(){var e=Object(o.a)();return Object(r.__spread)(e.fullItemsMruMap.keys()).reduce((function(t,n){return e.fullItemsMruMap.get(n).eventInfos.forEach((function(e){return t[e.eventKey]=e})),t}),{})}))},5560:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3),a=Object(r.action)("logNotificationUpdateForDiagnostics",(function(e){return{notificationUpdateLog:e}}))},6688:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(521);function a(e,t){var n=[],a=[];return e.forEach((function(e){var o={start:e.Start,end:e.End};t.some((function(e){return 0===Object(r.j)(e,o,!0)}))?n.push(e):a.push(e)})),{eventsOverlapping:n,eventsNotOverlapping:a}}},7375:function(e,t,n){"use strict";var r=n(7376);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},7376:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},7377:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(3316),o=n(1519),i=n(1854),c=n(29);function u(e){for(var t,n,c=[],u=0;u<e.length;u++){var f=e[u],v=Object(a.b)(Object(o.b)(f.Id));if(v){var b=s(f.Attendees,v.RequiredAttendees,v.OptionalAttendees),O=b.requiredAttendees,I=b.optionalAttendees,j=Object(r.__assign)(Object(r.__assign)({},v),{ResponseType:d(null===(t=f.ResponseStatus)||void 0===t?void 0:t.Response),AppointmentReplyTime:Object(i.b)(l(f.Attendees)),IsOnlineMeeting:f.IsOnlineMeeting,OnlineMeetingProvider:f.OnlineMeetingProvider,OnlineMeetingJoinUrl:null===(n=f.OnlineMeeting)||void 0===n?void 0:n.JoinUrl,RequiredAttendees:O,OptionalAttendees:I});c.push(j)}}return c}function d(e){var t;switch(e){case"Accepted":t="Accept";break;case"TentativelyAccepted":t="Tentative";break;case"Organizer":t="Organizer";break;case"Declined":t="Decline";break;case"NotResponded":t="NoResponseReceived";break;default:t="Unknown"}return t}function s(e,t,n){if(t&&0!=t.length||n&&0!=n.length)return{requiredAttendees:t,optionalAttendees:n};var r=[],a=[];return null==e||e.forEach((function(e){var t,n,o,i,c={Mailbox:{Name:null===(t=e.EmailAddress)||void 0===t?void 0:t.Name,EmailAddress:null===(n=e.EmailAddress)||void 0===n?void 0:n.Address},ResponseType:d(null===(o=e.Status)||void 0===o?void 0:o.Response),LastResponseTime:null===(i=e.Status)||void 0===i?void 0:i.Time};"Required"==e.Type?r.push(c):"Optional"==e.Type&&a.push(c)})),{requiredAttendees:r,optionalAttendees:a}}function l(e){var t,n,r,a;if(!e)return null;for(var o=0;o<e.length;o++){var i=e[o];if((a=i.EmailAddress)&&(n=a.Address,r=Object(c.a)().SessionSettings.UserEmailAddress,n===r||n&&r&&n.toLowerCase()==r.toLowerCase()))return null===(t=i.Status)||void 0===t?void 0:t.Time}return null}},9013:function(e,t,n){"use strict";var r=n(687),a=n(763),o=n(0),i=n(431),c=n(84),u=n(1854),d=n(2139),s=n(2173),l=n(350),f=n(726),v=n(3959),b=n(1328);var O="X-RedirectToCalendarService";function I(e,t,n,r,a){return void 0===a&&(a=void 0),Object(o.__awaiter)(this,void 0,void 0,(function(){var I,j,m,p,E,y,g,h,_;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:I=e.Id,j=e.mailboxInfo,p=null,E=null,(y=Object(i.a)(j)||{}).datapoint={customData:{itemId:I,fetchingMasterItem:n},jsonCustomData:function(e){var t=e.Body.ResponseMessages.Items[0];return{responseClass:t.ResponseClass,responseCode:t.ResponseCode}}},Object(c.i)("platform-redirectToCalendarService")&&(y.headers||(y.headers=new Headers),y.headers.set(O,"true")),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,Object(s.a)({Header:Object(l.a)(),Body:Object(d.a)({EventIds:r,ItemShape:t,IncludeDeclinedMeetings:Object(c.i)("cal-surface-declinedMeetings")})},y)];case 2:return p=o.sent(),"Success"==(m=p.Body.ResponseMessages.Items[0]).ResponseClass?null!=m?null!=(g=m.Items[0])&&(!function(e){e.Locations?e.Locations=e.Locations.filter((function(e){return e})):e.Locations=[],e.Resources&&e.Resources.map((function(t){Object(v.c)(e.Locations,t.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter((function(e){return e.DisplayName!==t.Mailbox.Name||Object(b.r)(e.PostalAddress)})),e.Locations.push(Object(b.g)(t.Mailbox.Name,t.Mailbox.EmailAddress)))}))}(g),a&&(g.ParentFolderId.Id=a),E={calendarEvent:Object(u.a)(g,e.mailboxInfo),error:null,responseCode:m.ResponseCode}):E={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:m.ResponseCode}:(h="[getCalendarEventService] request failed. Message: "+m.MessageText+", ResponseCode: "+m.ResponseCode+", ResponseClass: "+m.ResponseClass,E={calendarEvent:null,error:h,responseCode:m.ResponseCode}),[3,5];case 3:return _=o.sent(),E={calendarEvent:null,error:_.message},[3,5];case 4:return Object(c.i)("cal-mf-diagnostics")&&Object(f.a)({action:"GetCalendarEvent",status:(null==m?void 0:m.ResponseClass)||"Error",response:null==p?void 0:p.Body}),[7];case 5:return[2,E]}}))}))}var j=n(31);function m(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(o.__assign)({__type:"GetBirthdayEventJsonRequest:#Exchange"},n)),Object(j.a)("GetBirthdayEvent",e,t)}var p=n(9166);var E=n(179);function y(e,t,n,c){void 0===c&&(c=!1);var u=Object(E.o)(t);return u&&3==u.CalendarFolderType?function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u,d;return Object(o.__generator)(this,(function(s){switch(s.label){case 0:return n=e.Id,a=e.mailboxInfo,(c=Object(i.a)(a)||{}).datapoint={customData:{itemId:n},jsonCustomData:function(e){var t,n;return{responseClass:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseClass,responseCode:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseCode}}},[4,m({Header:Object(l.a)(),Body:(f={CalendarItemId:Object(r.a)({Id:n})},Object(o.__assign)({__type:"GetBirthdayEventRequest:#Exchange"},f))},c)];case 1:return null!=(u=s.sent()).Body&&"Success"==u.Body.ResponseClass&&null!=(d=u.Body.BirthdayEvent)?[2,{calendarEvent:Object(p.a)(d,t,void 0,e.mailboxInfo),error:null}]:[2,{calendarEvent:null,error:"[getBirthdayEventService] request failed"}]}var f}))}))}(e,t):I(e,n,c,[c?Object(a.a)({OccurrenceId:e.Id}):Object(r.a)({Id:e.Id})],Object(E.L)(u)?t:void 0)}n.d(t,"a",(function(){return y}))},9100:function(e,t,n){"use strict";var r=n(0),a=n(1447),o=n(4277),i=n(1421),c=n(1878),u=n(84),d=n(233);var s=n(4278),l=n(4279);function f(e){var t=[o.a];Object(u.i)("cal-time-panel-focusTime")&&t.push(s.a),Object(u.i)("cal-cmp-fluidCollaborativeSpace")&&t.push(l.a);var n={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:a.e,InlineImageUrlTemplate:a.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:t,ImageProxyCapability:Object(u.i)("cal-bodyImageProxy")&&Object(i.a)()?c.a.OwaAndConnectorsProxy:c.a.None};if(!Object(u.i)("cal-mf-blockExternalContent"))return n;switch(e){case"Default":return Object(r.__assign)(Object(r.__assign)({},n),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return n;default:return Object(d.a)(e)}}n.d(t,"a",(function(){return f}))},9166:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),a=n(9),o=n(4276),i=n(287),c=n(521),u=n(2784),d=n(368);function s(e,t,n,d){if(d=d||Object(i.d)(),!n){var s=Object(u.d)(t);s&&s.length>0&&(n=s.sort((function(e,t){var n=Object(c.l)(e),r=Object(c.l)(t);return n>r?-1:n<r?1:0}))[0])}var f=Object(o.a)(),v=function(e,t){var n=Object(a.lc)(e),r=l(n,Object(a.Cb)(t.start));return Object(c.t)(t,r)?r:l(n,Object(a.Cb)(t.end))}(e.Birthday,n),b=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f),e),{Subject:e.Name,Start:v,End:Object(a.e)(v,1),IsAllDayEvent:!0,ParentFolderId:{Id:t,mailboxInfo:d},ItemId:{Id:e.Id.Id,mailboxInfo:d},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:e.EmailReminderSettings});return b||null}function l(e,t){var n=Object(a.xb)(e),r=Object(a.lb)(e),o=Object(d.a)(t,n),i=Math.min(r,o);return Object(a.lc)(t,n,i)}}}]);
//# sourceMappingURL=owa.30.js.map
self.scriptsLoaded['owa.30.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.30.js'] = (new Date()).getTime();