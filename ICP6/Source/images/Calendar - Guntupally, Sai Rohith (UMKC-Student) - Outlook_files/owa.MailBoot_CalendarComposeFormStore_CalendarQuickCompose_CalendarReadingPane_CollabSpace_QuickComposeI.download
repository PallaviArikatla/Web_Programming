self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarComposeFormStore~CalendarQuickCompose~CalendarReadingPane~CollabSpace~QuickComposeI~4af89946.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[89],{1194:function(t,e,n){"use strict";var o=n(4786),i=n(4086),a=n(1653),c=n(1760),r=n(9),u=n(1192),s=n(1235),l=n(0),m=n(1251),d=n(2488),b=n(1681);function f(t,e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a,c;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return(n=I().event)?[4,d.c.import()]:[2];case 1:return o=r.sent(),i=null,a=void 0,t===s.c.Added?(c=Object(m.a)(e.AttachmentId),Object(b.b)(c.model)&&(a=c.model.AttachLongPathName),(null==c?void 0:c.model)&&(i={id:e.AttachmentId.Id,name:c.model.Name,contentType:c.model.ContentType,size:c.model.Size,attachmentType:o(c.model.__type),isInline:c.model.IsInline,url:a})):t===s.c.Deleted&&(Object(b.b)(e)&&(a=e.AttachLongPathName),i={id:e.AttachmentId.Id,name:e.Name,contentType:e.ContentType,size:e.Size,attachmentType:o(e.__type),isInline:e.IsInline,url:a}),[4,s.J.import()];case 2:return r.sent()(n.ParentFolderId.Id,t,i),[2]}}))}))}var v=n(52),O=n(3),j=n(1187),g=n(1236),S=(n(1241),n(347));Object(O.mutator)(j.r,(function(t){var e=t.originalEvent,n=t.eventUpdates,i=I();i.event=Object(o.a)(e),n&&S(i.event,n),i.originalEvent=Object(o.a)(e),Object(c.h)(i.event),Object(c.h)(i.originalEvent)})),Object(O.mutator)(j.Qb,(function(t){var e=t.event,n=I();n.openedForm&&(n.event=Object(o.a)(e),n.originalEvent=Object(o.a)(e),Object(c.h)(n.event),Object(c.h)(n.originalEvent))})),Object(O.mutator)(j.ec,(function(t){var e=I();e&&(e.openedForm=t.openedForm)})),Object(O.mutator)(j.Rb,(function(t){var e=I().event;e&&(e.CharmId=t.iconId)})),Object(O.mutator)(j.cb,(function(t){var e=I().event;e&&(e.Locations=t.locations)})),Object(O.mutator)(j.Ub,(function(t){var e=Object(a.a)();e&&(e.charmSelection=t.charmSelectionType)})),Object(O.mutator)(j.Sb,(function(t){var e=I().event,n=Object(a.a)();e&&(e.CharmId=t.iconId,n.charmSelection=t.charmSelection)})),Object(O.mutator)(j.ac,(function(t){var e=I().event;e&&(e.FreeBusyType=t.busyType)})),Object(O.mutator)(j.ab,(function(t){var e=I().event;e&&(e.IsDraft=t.isDraftEvent)})),Object(O.mutator)(j.hb,(function(t){var e=I().event;e&&(-1!=t.reminderMinutesBeforeStart&&(e.ReminderMinutesBeforeStart=t.reminderMinutesBeforeStart),e.ReminderIsSet=null!=e.ReminderMinutesBeforeStart&&null!=e.ReminderMinutesBeforeStart&&-1!=t.reminderMinutesBeforeStart)})),Object(O.mutator)(j.nb,(function(t){var e=I().event;e&&(e.Sensitivity="Normal"===e.Sensitivity?"Private":"Normal")})),Object(O.mutator)(j.jc,(function(t){var e=I().event;e&&(e.Subject=t.subject)})),Object(O.mutator)(j.L,(function(t){var e=I().event;e&&(e.DoNotForwardMeeting=t.DoNotForwardMeeting)})),Object(O.mutator)(j.ib,(function(t){var e=I().event;e&&(e.IsResponseRequested=t.IsResponseRequested)})),Object(O.mutator)(j.Z,(function(t){I().event.HideAttendees=t.HideAttendees})),Object(O.mutator)(j.gb,(function(t){var e=I().event;t.ParentFolderId&&(e.ParentFolderId=t.ParentFolderId,Object(u.H)(e)&&(e.Sensitivity="Normal"))})),Object(O.mutator)(j.Gb,(function(){var t=I(),e=t.event,n=t.uiState;if(n){var o=n.bodyViewState,i=o.content,a=o.isDirty;e.Body={Value:a?i:e.Body?e.Body.Value:"",BodyType:"HTML"}}})),Object(O.mutator)(j.bb,(function(t){var e=I().event;e&&(e.IsOnlineMeeting=t.IsOnlineMeeting,e.OnlineMeetingProvider=t.onlineMeetingProvider)})),Object(O.mutator)(j.jb,(function(t){var e=I().event;e&&(e.RequiredAttendees=Object(i.a)(e.RequiredAttendees,t.requiredAttendees))}));Object(O.mutator)(j.mb,(function(t){var e=I().event;e&&(e.IsRoomRequested=t.isRoomRequested)}));Object(O.mutator)(j.fb,(function(t){var e=I().event;e&&(e.OptionalAttendees=Object(i.a)(e.OptionalAttendees,t.optionalAttendees))})),Object(O.mutator)(j.kb,(function(t){var e=I().event;e&&(e.Resources=t.resources)})),Object(O.mutator)(j.M,(function(t){var e=I().event;e&&e.Attachments.push(t.attachment),f(s.c.Added,t.attachment)})),Object(O.mutator)(j.N,(function(t){var e=I().event;e&&(e.Attachments=e.Attachments.filter((function(e){return e.AttachmentId.Id!==t.attachmentId.Id}))),f(s.c.Deleted,t.attachment)})),Object(O.mutator)(j.O,(function(){var t=I().event;if(t){var e=t.Attachments;t.Attachments=[],e.forEach((function(t){return f(s.c.Deleted,t)}))}})),Object(O.mutator)(j.R,(function(t){var e=I().event;e&&(e.Categories=t.Categories)})),Object(O.mutator)(j.X,(function(t){var e=t.datesSelected,n=e.start,o=e.end,i=I().event,a=Object(g.a)();i&&a&&!a.uiEnabled||(Object(r.Gb)(o,n)?v.d("Cannot set the end time to be before the start time"):(Object(r.Hb)(i.Start,n)||(i.Start=n),Object(r.Hb)(i.End,o)||(i.End=o),i.StartTimeZoneId=n.tz,i.EndTimeZoneId=o.tz))})),Object(O.mutator)(j.K,(function(t){var e=I().event;e&&(e.IsAllDayEvent=t.isAllDayEvent)})),Object(O.mutator)(j.eb,(function(t){var e=I().event;e&&(e.MeetingNotesWebUrl=t.blob)})),Object(O.mutator)(j.Xb,(function(t){var e=I().uiState;e&&(e.dateSelectorViewState={shouldHighlightStartDate:t.shouldHighlightStartDate,shouldHighlightStartTime:t.shouldHighlightStartTime,shouldHighlightEndDate:t.shouldHighlightEndDate,shouldHighlightEndTime:t.shouldHighlightEndTime})})),Object(O.mutator)(j.ob,(function(t){var e=I().event;e&&(e.SkypeTeamsProperties=t.skypeTeamsProperties)})),Object(O.mutator)(j.qb,(function(t){var e=I().event;e&&(e.Body.Value=t.Value,e.HasBlockedImages=t.HasBlockedImages)})),Object(O.mutator)(j.W,(function(t){var e=I().event;e&&(e.CollabSpace=t.collabSpace)})),Object(O.mutator)(j.p,(function(){var t=Object(g.a)();t&&(t.customRecurrenceViewState.recurrence=null,t.customRecurrenceViewState.startDate=null)})),Object(O.mutator)(j.Vb,(function(t){var e=Object(g.a)();e&&(e.customRecurrenceViewState.recurrence=t.recurrence)})),Object(O.mutator)(j.Wb,(function(t){var e=Object(g.a)();e&&(e.customRecurrenceViewState.startDate=t.startDate)})),n(2261);var h=n(2555);Object(O.mutator)(j.n,(function(){Object(h.a)().isOptionalAttendeeWellEnabled=!0})),Object(O.mutator)(j.Tb,(function(t){var e=Object(g.a)();e&&(e.isCharmExplicitlySet=t.explicitlySet)})),n(3607),Object(O.mutator)(j.Lb,(function(t){Object(g.a)().showSchedulingAssistant=t.showSchedulingAssistant})),Object(O.mutator)(j.ic,(function(t){var e=Object(g.a)();e&&(e.currentSidePaneType=t.newSidePaneType)})),Object(O.mutator)(j.Nb,(function(t){Object(g.a)().showCompactRecipientWell=!1}));Object(O.mutator)(j.Kb,(function(t){Object(g.a)().showDateSelectorTimeZones=t.showTimeZones}));Object(O.mutator)(j.wb,(function(t){var e=I();e.event=null,e.originalEvent=null,e.openedForm=null,e.uiState=null,e.metricsInfo=null,e.attachmentFiles=null})),Object(O.mutator)(j.xb,(function(){var t=I();t.metricsInfo=null,t.attachmentFiles=null})),Object(O.mutator)(j.yb,(function(){var t=I();t.metricsInfo=null,t.attachmentFiles=null})),Object(O.mutator)(j.Db,(function(t){I().attachmentFiles={fileList:t.fileList,shouldShare:t.shouldShare,isInline:t.isInline}})),Object(O.mutator)(j.d,(function(t){I().attachmentFiles=null}));Object(O.mutator)(j.e,(function(t){var e=Object(g.a)();e&&(e.linkFiles=[])})),Object(O.mutator)(j.a,(function(t){var e=Object(g.a)();if(e){var n={linkId:t.linkId,providerId:t.providerId};e.linkFiles.push(n)}}));Object(O.mutator)(j.cc,(function(t){var e=I();(null==e?void 0:e.uiState)&&(e.uiState.isUndoNotificationShown=t.isUndoNotificationShown)})),Object(O.mutator)(j.Eb,(function(t){Object(g.a)().awaitingServiceResponse=t.awaitingServiceResponse}));Object(O.mutator)(j.kc,(function(t){Object(g.a)().uiEnabled=t.uiEnabled}));Object(O.mutator)(j.Hb,(function(t){var e=Object(g.a)();e&&(e.isCompactRecipientWellExpanded=t.isCompactRecipientWellExpanded)})),Object(O.mutator)(j.bc,(function(){Object(h.a)().isOnlineMeetingExplicitlySet=!0})),Object(O.mutator)(j.Zb,(function(t){I().uiState.didDiscoverTimeSuggestions=t.didDiscoverTimeSuggestions}));var p=n(1945),I=(Object(O.mutator)(p.e,(function(t){var e=t.CalendarTime,n=t.Start,o=t.End;Object(r.Gb)(o,n)?v.d("Cannot set the end time to be before the start time"):(e.Start=n,e.StartTimeZoneId=n.tz,e.End=o,e.EndTimeZoneId=o.tz)})),Object(O.mutator)(p.d,(function(t){var e=t.calendarTime;e&&(e.IsAllDayEvent=t.isAllDayEvent)})),Object(O.mutator)(p.b,(function(t){var e=t.calendarTime;e&&(e.Recurrence=t.recurrenceType)})),Object(O.mutator)(p.c,(function(t){var e=t.calendarTime;e&&(e.StartTimeZoneId=t.timeZone,e.EndTimeZoneId=t.timeZone)})),e.a=Object(O.createStore)("composeFormStore",{openedForm:null,originalEvent:null,event:null,uiState:null,metricsInfo:null,attachmentFiles:null}))},1236:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n(1194),i=n(1241);function a(){var t=Object(o.a)();return t.openedForm==i.b?t.uiState:null}},1251:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(1555);function i(t){return Object(o.a)().attachments.get(t.Id)}},1653:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n(1194),i=n(1241);function a(){var t=Object(o.a)();return t.openedForm==i.e?t.uiState:null}},1681:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a}));var o=n(1618);function i(t){return c(t.type)}function a(t){return c(Object(o.a)(t))}function c(t){return 1===t||3===t}},2261:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return b}));var o=n(0),i=n(1236),a=n(1194),c=n(3),r=n(1187),u=n(2745),s=n(9),l=(Object(c.mutator)(r.w,(function(){var t=Object(s.jc)(),e=Object(a.a)(),n=e.openedForm,c=e.metricsInfo;if(n&&c){var r=c.formTransitionTimestamp?t-c.formTransitionTimestamp:0;switch(n){case"QuickCompose":c.timeInQuickCompose=r;break;case"FullCompose":var u=Object(i.a)();(null==u?void 0:u.showSchedulingAssistant)?c.timeInSchedulingAssistant=(c.timeInSchedulingAssistant||0)+r:c.timeInFullCompose=(c.timeInFullCompose||0)+r}}e.metricsInfo=Object(o.__assign)(Object(o.__assign)({},c),{formTransitionTimestamp:t})})),Object(c.mutator)(r.B,(function(t){var e=Object(a.a)().metricsInfo;e&&(e.schedulingGridUsed=!0)})),Object(c.mutator)(r.q,(function(t){var e=t.timeInRoomBookingPanelSession,n=Object(a.a)();n.metricsInfo&&(n.metricsInfo.timeInRoomBookingPanel=(n.metricsInfo.timeInRoomBookingPanel||0)+e)})),Object(c.mutator)(r.y,(function(t){var e=Object(a.a)().metricsInfo;if(e&&e.quickComposeControlUsageMetrics){var n=e.quickComposeControlUsageMetrics,o=n.usageDict,i=n.startTimeDict,c=n.durationDict,r=t.control,u=t.isFocus,l=o[r]||0,m=c[r]||0,d=i[r],b=Object(s.jc)();u?(o[r]=l+1,i[r]=b):d&&(c[r]=m+(b-d),i[r]=null)}})),Object(c.mutator)(r.H,(function(t){var e=Object(a.a)().metricsInfo;e&&e.timeSuggestionStartLastSet.push(t.suggestionStart)})),Object(c.mutator)(r.h,(function(){var t=Object(a.a)().metricsInfo;t&&(t.timeSuggestionStartLastSet=[])})),Object(c.mutator)(r.G,(function(){var t=Object(a.a)().metricsInfo;t&&(t.timeSuggestionStartFirstSet=t.timeSuggestionStartLastSet)})),Object(c.mutator)(r.g,(function(){var t=Object(a.a)().metricsInfo;t&&(t.timeSuggestionStartFirstSet=[])})),Object(c.mutator)(r.u,(function(){var t=Object(a.a)().metricsInfo;t&&(t.timeSuggestionShown=[],t.timeSuggestionClickedIndex=[],t.timeSuggestionNotFoundCount=0,t.timeSuggestionSAClickedCount=0,t.timeSuggestionStartLastSet=[],t.timeSuggestionStartFirstSet=[])})),Object(c.mutator)(r.F,(function(t){var e=Object(a.a)().metricsInfo;e&&e.timeSuggestionShown.push(t.suggestionsCount)})),Object(c.mutator)(r.C,(function(t){var e=Object(a.a)().metricsInfo;e&&e.timeSuggestionClickedIndex.push(t.suggestionIndex)})),Object(c.mutator)(r.D,(function(){var t=Object(a.a)().metricsInfo;t&&t.timeSuggestionNotFoundCount++})),Object(c.mutator)(r.E,(function(){var t=Object(a.a)().metricsInfo;t&&t.timeSuggestionSAClickedCount++})),Object(c.mutator)(r.v,(function(t){var e=Object(a.a)().metricsInfo;e&&(e.changeTimeActions||(e.changeTimeActions=[]),t.sourceAction&&e.changeTimeActions.push(t.sourceAction))})),Object(c.mutatorAction)("initializeLocationMetrics",(function(){var t,e=(t=Object(a.a)()).metricsInfo,n=t.event;e&&(e.locationMetrics={},n.Locations.forEach((function(t){var n=Object(u.d)(t.Id,t.PostalAddress);e.locationMetrics[n]=Object(u.a)(t,"ExistingLocation")})))}))),m=Object(c.mutatorAction)("addLocationMetrics",(function(t){var e=Object(a.a)().metricsInfo;e&&Object.keys(t).forEach((function(n){e.locationMetrics[n]||(e.locationMetrics[n]=t[n])}))})),d=Object(c.mutatorAction)("removeLocationMetrics",(function(t){var e=Object(a.a)().metricsInfo;e&&t.forEach((function(t){return delete e.locationMetrics[t]}))})),b=Object(c.mutatorAction)("updateAutoRoomBookingMetric",(function(t){var e=Object(a.a)().metricsInfo;e&&(e.autoRoomBookingMetric=Object(o.__assign)(Object(o.__assign)({},e.autoRoomBookingMetric),t))}));Object(c.mutator)(r.A,(function(t){var e=Object(a.a)().metricsInfo;e&&(e.quickComposeToFullComposeEntry=t.entryType)})),Object(c.mutator)(r.z,(function(t){var e=Object(a.a)().metricsInfo;e&&(e.quickComposePivotType=t.pivot)})),Object(c.mutator)(r.x,(function(t){var e=Object(a.a)().metricsInfo;e&&(e.isBusyResourceSendClicked=t.send)}))},2555:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n(1194),i=n(1241);function a(){var t=Object(o.a)();return t.openedForm===i.b||t.openedForm===i.e?t.uiState:null}},2745:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return r}));var o=n(1328);function i(t){var e={};return t.forEach((function(t){var n=t.relevanceData,o=r(t.personaId,t.postalAddress);e[o]={selectionSource:t.selectionSource,TotalLength:t.displayName.length,TotalDigits:t.displayName.replace(new RegExp("[^\\d]","g"),"").length,locationSource:t.postalAddress?t.postalAddress.LocationSource:"None",locationEntityType:t.entityType,relevanceHint:null==n?void 0:n.relevanceHint,locationIndex:null==n?void 0:n.locationIndex,queryLength:n&&(n.queryString?n.queryString.length:0),isOfficeLocation:u(t.displayName),isUrlLocation:s(t.displayName)}})),e}function a(t,e,n){var o={};return o[e]={selectionSource:n,TotalLength:t.length,locationSource:"Resource"},o}function c(t,e){return{selectionSource:e,TotalLength:t.DisplayName.length,TotalDigits:t.DisplayName.replace(new RegExp("[^\\d]","g"),"").length,locationSource:t.PostalAddress?t.PostalAddress.LocationSource:"None",isOfficeLocation:u(t.DisplayName),isUrlLocation:s(t.DisplayName)}}function r(t,e){return Object(o.s)(e)?e.LocationUri:t}function u(t){return-1!=t.toLowerCase().indexOf("office")}function s(t){return 0==t.toLowerCase().indexOf("http")}},3607:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var o=n(3),i=n(1187),a=n(1194),c=(Object(o.mutator)(i.Fb,(function(t){Object(a.a)().uiState.currentSaveRequestTimeStamp=t.timeStamp})),Object(o.mutatorAction)("resetUnresolvedLocation",(function(t){Object(a.a)().uiState.unresolvedLocation=t})));Object(o.mutator)(i.Ib,(function(t){Object(a.a)().uiState.isDarkMode=t.isDarkMode}))},4086:function(t,e,n){"use strict";var o=n(0);function i(t){var e;return(null===(e=null==t?void 0:t.Mailbox)||void 0===e?void 0:e.EmailAddress)&&t.Mailbox.EmailAddress.toLowerCase()}e.a=function(t,e){var n,a,c=[],r=function(e){var n=i(e);if(0===c.filter((function(t){return n===i(t)})).length){var o=t.filter((function(t){return n===i(t)})),a=o.length>=1?o[0]:e;c.push(a)}};try{for(var u=Object(o.__values)(e),s=u.next();!s.done;s=u.next()){r(s.value)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}return c}},4786:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var o=n(0),i=n(18);function a(t){var e=function t(e){if(!e)return e;var n=Object(o.__assign)({},e);return Object.keys(e).forEach((function(o){e[o]||"object"!=typeof e[o]?n[o]=e[o]:n[o]=t(e[o])})),n}(t);return["Attachments","Locations","Categories","RequiredAttendees","OptionalAttendees","Resources","InboxReminders"].map((function(n){e[n]=e[n]?Object(i.toJS)(t[n]):[]})),e}}}]);
//# sourceMappingURL=owa.MailBoot~CalendarComposeFormStore~CalendarQuickCompose~CalendarReadingPane~CollabSpace~QuickComposeI~4af89946.js.map
self.scriptsLoaded['owa.MailBoot~CalendarComposeFormStore~CalendarQuickCompose~CalendarReadingPane~CollabSpace~QuickComposeI~4af89946.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarComposeFormStore~CalendarQuickCompose~CalendarReadingPane~CollabSpace~QuickComposeI~4af89946.js'] = (new Date()).getTime();