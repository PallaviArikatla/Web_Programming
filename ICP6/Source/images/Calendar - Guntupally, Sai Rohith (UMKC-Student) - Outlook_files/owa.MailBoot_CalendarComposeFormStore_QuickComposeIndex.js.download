self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarComposeFormStore~QuickComposeIndex.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[206],{1203:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(69),i=n(1245);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(4),n.e(183),n.e(474)]).then(n.bind(null,1654))})),a=new r.b(o,(function(e){return e.confirmAction}));function c(e,t,n,r){return a.import().then((function(i){return i(e,t,n,r)}))}},1245:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))},1275:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(i||(i={}))},1279:function(e,t,n){"use strict";var r=n(522),i=n(1342),o=n(1205),a=n(695),c=1/0,u=r.a?r.a.prototype:void 0,s=u?u.toString:void 0;t.a=function e(t){if("string"==typeof t)return t;if(Object(o.a)(t))return Object(i.a)(t,e)+"";if(Object(a.a)(t))return s?s.call(t):"";var n=t+"";return"0"==n&&1/t==-c?"-0":n}},1342:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},1381:function(e,t,n){"use strict";var r=n(1279);t.a=function(e){return null==e?"":Object(r.a)(e)}},1580:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(0),i=n(1731),o=n(2207),a=n(269),c="EditorRibbonUsage";function u(e,t){for(var n,o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];return Object(i.b)(e,(function(e){var i;n=(i=e[t]).call.apply(i,Object(r.__spread)([e],o))}),null),n}function s(e,t,n,u){var s;void 0===n&&(n=[]),void 0===u&&(u=n);var l=o[t];return Object(i.b)(e,(function(e){s=l.apply(void 0,Object(r.__spread)([e],n)),(null==u?void 0:u.length)>0&&Object(a.p)(c+t,Object(r.__spread)(u.map((function(e){return JSON.stringify(e)})),[e.isDarkMode()]))}),null),s}},1731:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var r={};function i(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e,t,n){var i=r[e.editorId];i&&(i.htmlEditor==t&&(i.htmlEditor=null),i.plainTextEditor==n&&(i.plainTextEditor=null),i.htmlEditor||i.plainTextEditor||delete r[e.editorId])}function a(e,t,n,i){if(e){var o=e.bodyType,a=void 0===o||"HTML"===o,c="Text"===o,u=r[e.editorId]||{},s=u.htmlEditor,l=u.plainTextEditor;a&&t&&(s&&!s.isDisposed()||i)?t(s):c&&n&&(l||i)&&n(l)}}},1945:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(3),i=Object(r.action)("updateAllDay",(function(e,t){return{isAllDayEvent:e,calendarTime:t}})),o=Object(r.action)("updateStartAndEndTime",(function(e,t,n){return{Start:e,End:t,CalendarTime:n}})),a=Object(r.action)("onAllDayChanged",(function(e,t){return{isAllDayEvent:e,calendarTime:t}})),c=Object(r.action)("setRecurrence",(function(e,t){return{recurrenceType:e,calendarTime:t}})),u=Object(r.action)("setTimeZoneName",(function(e,t){return{timeZone:e,calendarTime:t}}))},2066:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},2089:function(e,t,n){"use strict";function r(){return{visibleItemCount:0,formatViewState:{fontName:"",fontSize:"",isBold:!1,isItalic:!1,isUnderline:!1,backgroundColor:"",textColor:"",isBullet:!1,isNumbering:!1,isStrikeThrough:!1,isSubscript:!1,isSuperscript:!1,isBlockQuote:!1,canUnlink:!1,canAddImageAltText:!1,canUndo:!1,canRedo:!1,formatPainterFormat:null},targetPoint:null}}n.d(t,"a",(function(){return r}))},2142:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(1229),i=Object(r.f)(),o=Object(r.p)(i.getLockId()),a=i.fetchFullCalendarEvent,c=i.fetchFullCalendarEventAndUpdateItemResponseShapeType,u=o.getFullCalendarEvent},2208:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1731),i=n(2263);function o(e){Object(r.b)(e,(function(t){Object(i.a)(e,t.getContent())}),(function(t){Object(i.a)(e,t.value)}))}},2263:function(e,t,n){"use strict";var r=n(275),i=n(2747);t.a=Object(r.action)("updateContent")((function(e,t,n){e.content!=t&&(e.content=t,n||Object(i.a)(e,!0))}))},2515:function(e,t,n){var r=n(2516),i=n(130);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2516:function(e,t,n){(t=e.exports=n(129)(!1)).push([e.i,".CZhyJSZip0r3ja-sWfvT0{width:0;height:0;overflow:hidden}",""]),t.locals={alert:"CZhyJSZip0r3ja-sWfvT0"}},2557:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.TimeBased=0]="TimeBased",e[e.CountBased=1]="CountBased",e[e.TimeAndCountCombined=2]="TimeAndCountCombined",e[e.BasicSkittle=3]="BasicSkittle",e[e.None=4]="None"}(r||(r={})),function(e){e[e.New=0]="New",e[e.Activated=1]="Activated",e[e.Expired=2]="Expired",e[e.Unknown=3]="Unknown"}(i||(i={}))},2589:function(e,t,n){"use strict";var r=n(1),i=n(47),o=n(2515),a=Object(i.a)((function(e){var t=e.message,n=e.atomic;return r.createElement("div",{"aria-live":"polite","aria-atomic":n,className:o.alert},r.createElement("span",null,t))}));n.d(t,"a",(function(){return a}))},2626:function(e,t,n){"use strict";function r(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return r}))},2747:function(e,t,n){"use strict";var r=n(275);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},2830:function(e,t,n){"use strict";function r(){return{isSuggesting:!1,bufferZone:0,targetPoint:null}}n.d(t,"a",(function(){return r}))},3063:function(e,t,n){"use strict";var r,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide"}(r||(r={})),function(e){e[e.Hide=0]="Hide",e[e.ShowCallout=1]="ShowCallout",e[e.ShowDialog=2]="ShowDialog"}(i||(i={}))},3065:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(69),i=new r.c((function(){return n.e(652).then(n.bind(null,5468))})),o=new r.a(i,(function(e){return e.initializeCache}))},308:function(e,t,n){"use strict";var r,i=n(0);function o(e,t){for(var n=[],r=0;r<e;r++)n[r]=t;return n}!function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.OOF=3]="OOF",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData",e[e.Loading=6]="Loading"}(r||(r={}));var a=r,c=[a.Loading,a.NoData,a.Free,a.WorkingElsewhere,a.Tentative,a.Busy,a.OOF];function u(e,t){return c.indexOf(e)>c.indexOf(t)?e:t}var s=n(607),l=n(18),d=n(373),b=n(646),f=n(287),O=n(30),p=n(84),h=n(725),j=n(29),m=n(52),v=n(3),g=n(9),y=15,I=function(){function e(e,t){var n=this;this.pagesRequestedTime=null,this.requestedAddressesForSamePage=[],this.debouncedGetAvailability=Object(s.a)((function(e,t,r,i){n.requestedAddressesForSamePage=[],Object(b.a)(e,t,i,n.processPageQueryResponsesInSamePage(r,e,t),!0,null,y)}),500),this.epoch=Object(g.mc)(1970,0,1),this.epochTime=Object(g.zb)(this.epoch),this.cacheSize=t,this.pageSizeInMilliseconds=e*O.e,this.slotsPerPage=this.pageSizeInMilliseconds/(O.g*y)}return Object.defineProperty(e.prototype,"maxBatchSize",{get:function(){return Object(p.i)("cal-mf-freeBusyBatch10")?10:5},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){this.store=e,this.attendeeDictionary={},this.attendeeFiltersDictionary={},this.attendeeWorkingHoursDictionary=new l.ObservableMap},e.prototype.getAttendeeWorkingHours=function(e){var t,n=null===(t=e.Mailbox)||void 0===t?void 0:t.EmailAddress,r=Object(j.a)().UserOptions.WorkingHours;return n?(this.attendeeWorkingHoursDictionary.has(n)||S(this.attendeeWorkingHoursDictionary,n,r),this.attendeeWorkingHoursDictionary.get(n)):r},e.prototype.getAttendeeDetailedEvents=function(e,t,n){for(var r=t.tz,o=this.getPageIndex(t),a=this.getPageIndex(n),c=[],u=function(t){var n=s.tryGetFreeBusy(e,t),o=(n.Items||[]).filter((function(e){return"Free"!=e.FreeBusyType})).map((function(e){return Object(i.__assign)(Object(i.__assign)({},e),{Subject:e.Subject,End:Object(g.Qb)(r,Object(g.mc)(e.End)),Start:Object(g.Qb)(r,Object(g.mc)(e.Start)),ItemId:{Id:e.ItemId.Id},IsFreeBusyOnly:!("DetailedMerged"===n.FreeBusyViewType)})}));c.push.apply(c,Object(i.__spread)(o))},s=this,l=o;l<=a;l++)u(l);return c},e.prototype.getDetailedFreeBusy=function(e,t,n,r){var o=this.getPageIndex(t),a=this.getPageIndex(n),c=Math.floor(this.getRecordIndex(t)),u=Math.ceil(this.getRecordIndex(n)),s=[];o==a&&c==u&&u++;for(var l=o;l<=a;l++){var d=this.tryGetFreeBusy(e,l,r).mergedFreeBusy;l==a&&(d=d.slice(0,u)),l==o&&(d=d.slice(c)),s.push.apply(s,Object(i.__spread)(d))}return s},e.prototype.getAggregatedFreeBusy=function(e,t,n,r,i){return t=r?Object(g.Wb)(t):t,n=r?Object(g.Wb)(Object(g.e)(n,1)):n,this.getDetailedFreeBusy(e,t,n,i).reduce((function(e,t){return u(e,t)}),a.Loading)},e.prototype.addEmailAddress=function(e){var t=this;this.store.has(e)||(Object(v.mutatorAction)("Initialize Attendee free busy store",(function(e){t.store.set(e,new l.ObservableMap)}))(e),this.attendeeDictionary[e]=new h.a(this.cacheSize),this.attendeeDictionary[e].initialize(this.store.get(e)))},e.prototype.getPageIndex=function(e){var t=Object(g.zb)(e)-this.epochTime;return Math.floor(t/this.pageSizeInMilliseconds)},e.prototype.getRecordIndex=function(e){return(Object(g.zb)(e)-this.epochTime)%this.pageSizeInMilliseconds/(O.g*y)},e.prototype.tryGetFreeBusy=function(e,t,n){var r=t.toString();this.attendeeDictionary[e]||this.addEmailAddress(e);var i=this.attendeeDictionary[e].get(r);return i||(this.attendeeDictionary[e].add(r,{FreeBusyViewType:"FreeBusyMerged",mergedFreeBusy:o(this.slotsPerPage,a.Loading)}),this.requestFreeBusyPage(e,t,n),i=this.attendeeDictionary[e].get(r)),i},e.prototype.isConflict=function(e,t,n){return Object(g.Eb)(e.end,t)&&Object(g.Gb)(e.start,n)},e.prototype.tryFilterOutCalendarEvent=function(e,t,n,r,i){if("Accept"==i||"Organizer"==i){var o=r.Start,c=r.End;if(r&&this.isConflict({start:o,end:c},t,n))for(var u=Object(g.Gb)(o,t)?t:o,s=Object(g.Eb)(c,n)?n:c,l=this.getRecordIndex(u),d=this.getRecordIndex(s),b=l;b<d;b++)e.mergedFreeBusy[b]=a.Free}return e},e.prototype.requestFreeBusyPage=function(e,t,n){this.attendeeFiltersDictionary[e]=n,this.getAvailabilityForSingleAddress(e,t)},e.prototype.getAvailabilityForSingleAddress=function(e,t){var n=Object(g.g)(this.epoch,this.pageSizeInMilliseconds*t),r=Object(g.g)(n,this.pageSizeInMilliseconds);if(e===Object(j.a)().SessionSettings.UserEmailAddress||Object(d.r)(e)){var i=Object(f.d)(e);Object(b.a)(n,r,[e],this.processPageQueryResponsesInSamePage(t,n,r),!0,i,y)}else Object(g.Hb)(this.pagesRequestedTime,n)||(this.debouncedGetAvailability.flush(),this.pagesRequestedTime=n),this.requestedAddressesForSamePage.push(e),this.debouncedGetAvailability(n,r,t,this.requestedAddressesForSamePage.slice()),this.requestedAddressesForSamePage.length>=this.maxBatchSize&&this.debouncedGetAvailability.flush()},e.prototype.processPageQueryResponsesInSamePage=function(e,t,n){var r=this;return function(c){c&&Object.keys(c).forEach((function(u){if(r.attendeeDictionary[u]){var s=c[u],l=s.MergedFreeBusy;r.attendeeWorkingHoursDictionary&&s.WorkingHours&&S(r.attendeeWorkingHoursDictionary,u,s.WorkingHours);var d=Object(i.__assign)(Object(i.__assign)({},s),{mergedFreeBusy:"None"==s.FreeBusyViewType?o(r.slotsPerPage,a.NoData):l?l.split("").map((function(e){return parseInt(e)})):[]}),b=r.attendeeFiltersDictionary[u];if(b){var f={};Object(i.__spread)(b.RequiredAttendees,b.OptionalAttendees,b.Resources).forEach((function(e){return f[e.Mailbox.EmailAddress]=e.ResponseType})),b.Organizer&&(f[b.Organizer.Mailbox.EmailAddress]="Organizer");var O=f[u];O||m.g.warn("Unknown response for attendee "+u),d=r.tryFilterOutCalendarEvent(d,t,n,b,O)}r.attendeeDictionary[u].add(e.toString(),d)}}))}},e}(),S=Object(v.mutatorAction)("updateAttendeeWorkingHours",(function(e,t,n){e.set(t,n)})),C=new I(28,10);function E(e,t){return e==a.Busy||e==a.OOF||t&&e==a.Tentative}n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return E})),n.d(t,"a",(function(){return a}))},3125:function(e,t,n){"use strict";var r=n(3223),i=35;n.d(t,"a",(function(){return c}));var o=14,a=["1f602","2764","1f60d","1f62d","1f60a","1f612","1f495","1f618","267b","1f629","1f44c","1f60f","1f601","1f609","1f44d","2b05","1f60c","1f64f","1f914","1f622","1f60e","1f633","1f440","1f605","1f64c","1f494","1f648","270c","2728","1f499","1f49c","1f4af","1f604","1f496","1f61c"];function c(e){void 0===e&&(e=i);for(var t=Object(r.b)(Math.min(e,o)),n=0;t.length<e;n++){var c=a[n];t.includes(c)||t.push(c)}return t}},3223:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(0),i=n(29),o=/emoji_([0-9a-z]+(_[0-9a-z]+)?)-png/i,a=49;function c(e){var t,n;void 0===e&&(e=a);var c=Object(i.a)().UserOptions.MruEmojis,u=[];if(c&&c.length>0)try{for(var s=Object(r.__values)(c),l=s.next();!l.done;l=s.next()){var d=l.value.match(o);if(d&&d.length>=2&&(u.push(d[1].toLowerCase()),u.length>=e))break}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return u}},3224:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return s}));var r=-1,i=0,o=-1,a=0,c="EditorProofing_SkittleOpenUpsellCallout",u="EditorProofing_SkittleVisible",s="EditorProofing_SkittleValueNonZero"},3225:function(e,t,n){"use strict";function r(){return{menuTargetPoint:null,menuTargetImage:null}}n.d(t,"a",(function(){return r}))},3580:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),i=n(2477),o=n(4763),a=n(9),c=n(1216),u=n(527),s=n(743),l=15;function d(e,t){var n,d,b,f=Object(s.a)(),O=l,p=!1,h=!t;if(e?(e.IsAllDayEvent?(n=e.Start||Object(a.Wb)(Object(a.Pb)()),d=e.End||Object(a.Wb)(Object(a.e)(Object(a.Pb)(),1)),h=!1):(n=e.Start||Object(a.f)(Object(a.Xb)(Object(a.Pb)()),1),d=e.End||Object(a.h)(n,f)),O=e.ReminderMinutesBeforeStart||Object(i.a)(e.IsAllDayEvent),e.ParentFolderId||(b=Object(o.a)()),p=e.IsOnlineMeeting):(n=Object(a.f)(Object(a.Xb)(Object(a.Pb)()),1),d=Object(a.h)(n,f),b=Object(o.a)(),O=Object(i.a)(!1)),h){var j=Object(u.g)(n,d);n=j.start,d=j.end}var m={ItemId:null,ParentFolderId:b,Subject:null,ReminderIsSet:-1!=O,ReminderMinutesBeforeStart:O,LastModifiedTime:null,InstanceKey:null,Preview:null,__type:null,Start:n,StartTimeZoneId:n.tz,End:d,EndTimeZoneId:d.tz,IsAllDayEvent:!1,IsRoomRequested:!1,AutoRoomBookingStatus:void 0,IsDraft:!1,FreeBusyType:"Busy",IsMeeting:!1,IsCancelled:!1,IsRecurring:!1,IsResponseRequested:!0,CalendarItemType:"Single",ResponseType:null,Organizer:null,RequiredAttendees:null,OptionalAttendees:null,Resources:null,AppointmentReplyTime:null,Recurrence:null,Location:null,IntendedFreeBusyStatus:null,IsOrganizer:!0,AppointmentReplyName:null,IsSeriesCancelled:null,CharmId:Object(c.t)().IconId,Locations:null,ClientSeriesId:null,EffectiveRights:null,HasAttachments:!1,HasBlockedImages:!1,Attachments:null,Sensitivity:"Normal",Body:{Value:"",BodyType:"HTML"},EntityNamesMap:0,TailoredXpEntities:null,UID:null,ExperienceType:"Unspecified",DoNotForwardMeeting:!1,IsOnlineMeeting:p,JoinOnlineMeetingUrl:null,Categories:null,InboxReminders:null,MeetingRequestWasSent:null,ExtractionSourceId:null,OnlineMeetingProvider:null,OnlineMeetingJoinUrl:null,OnlineMeetingConferenceId:null,OnlineMeetingTollNumber:null,OnlineMeetingTollFreeNumbers:null,SeriesMasterItemId:null,ExtractionSourceInternetMessageId:null,PersonId:null,InReplyTo:null,HideAttendees:!1,IsFreeBusyOnly:null,MeetingNotesWebUrl:null,SkypeTeamsProperties:null,DocLinks:[],AppendOnSend:[],IsBookedFreeBlocks:!1,AssociatedTasks:[],CollabSpace:null};return e&&(m=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},m),e),{Start:n,End:d}),e.FreeBusyType||(m.FreeBusyType=e.IsAllDayEvent?"Free":"Busy")),m}},3704:function(e,t,n){"use strict";n.r(t);var r=n(1194),i=n(351),o=n(1795);function a(e){return e==o.n||e==o.o||e==o.m||e==o.g}var c=n(1241),u=n(3),s=n(188),l=n(2339);Object(u.mutator)(l.a,(function(e){var t,n=e.entrySource,o=e.anchor,u=e.viewType,l=a(n),d=Object(r.a)();d.metricsInfo={quickComposeEntrySource:n,quickComposeControlUsageMetrics:{usageDict:{},startTimeDict:{},durationDict:{}},formSessionId:Object(i.a)()},l?o&&(d.uiState.surfaceAnchor=o):d.uiState={surfaceAnchor:o,charmSelection:c.a.None,isUndoNotificationShown:null===(t=d.uiState)||void 0===t?void 0:t.isUndoNotificationShown,isOptionalAttendeeWellEnabled:!1,showCompactRecipientWell:!1,dateSelectorViewState:{shouldHighlightStartDate:!1,shouldHighlightStartTime:!1,shouldHighlightEndDate:!1,shouldHighlightEndTime:!1},unresolvedLocation:null,activePivot:c.h.Event,showExpandedEditor:!1,bodyViewState:{content:null,isDirty:!1},cachedEventData:{},oofViewState:{declineNewInvitationsEnabled:void 0,declineExistingCalendarEventsEnabled:void 0,autoReplyEnabled:!1,autoReplyViewState:null,mailboxAutoReplyConfigurationLoadingStatus:null,mailboxAutoReplyConfiguration:null,startDate:null,endDate:null,hideOverridingWarningMessage:!1,optionsPageLoadingState:null},viewType:u,isOnlineMeetingExplicitlySet:!1,shouldAdjustStartTimeEndTime:Object(s.f)()}}));var d,b=n(0),f=n(269),O=n(1187),p=n(1401),h=n(3379),j=n(1236),m=n(2829),v=null;function g(e,t,n,i){return Object(b.__awaiter)(this,void 0,void 0,(function(){var o,a,c,u;return Object(b.__generator)(this,(function(s){switch(s.label){case 0:return o=Object(r.a)().uiState,a=Object(p.l)(e),o&&a?d?[3,2]:[4,p.x.import()]:[3,4];case 1:d=s.sent(),s.label=2;case 2:return d(e,p.b.attachingAsACopy),[4,p.r.import()];case 3:c=s.sent(),u=c(a,t),Object(h.a)(o,Object(m.a)(),[u],{isInline:!1,isHiddenInline:!1,shouldShare:!1,downsellFromLink:!0},null,null,(function(t,r,o){return function(e,t,n){return Object(b.__awaiter)(this,void 0,void 0,(function(){return Object(b.__generator)(this,(function(r){return Object(f.p)("linkAttachAsACopySuccess",{isTryAgain:t}),setTimeout((function(){var t=Object(p.l)(e);t&&t.linkActionStatus===p.b.attachingAsACopy&&Object(p.g)(e,n)}),100),[2]}))}))}(e,n,i)}),(function(t){return function(e,t,n){d(e,p.b.none),t?Object(f.p)("linkAttachAsACopyCanceled",{isTryAGain:n,isCalendar:!0}):Object(f.p)("linkAttachAsACopyFailed",{isTryAgain:n,isCalendar:!0})}(e,t,n)}),(function(){Object(f.p)("LinkAttachAsCopyTriedAgain",{isCalendar:!0}),Object(p.e)(e,t,!0,i)})),s.label=4;case 4:return[2]}}))}))}Object(u.orchestrator)(p.e,(function(e){if(!Object(m.a)())return Object(O.a)(e.linkId,e.providerId),Object(O.ab)(!0),Object(O.Cb)(),d(e.linkId,p.b.pendingAttachAsACopy),void(v?v.addCustomData({secondAttemptMade:!0}):v=new f.a("AttachLinkAsCopyStartedWithoutDraft"));Object(f.p)("AttachAsACopyStartedWithDraftAlreadySaved"),g(e.linkId,e.providerId,e.isTryAgain,e.targetWindow)})),Object(u.orchestrator)(O.Y,(function(e){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(b.__generator)(this,(function(t){return(e=Object(j.a)())&&e.linkFiles?(e.linkFiles.map((function(e){g(e.linkId,e.providerId,!1,null)})),Object(O.e)(),v&&(v.addCustomData({createdAttachments:!0}),v.end(),v=null),[2]):(v&&(v.addCustomData({createdAttachments:!1}),v.end(),v=null),[2])}))}))}));var y=n(9);function I(e){return Object(y.e)(e,-1)}var S=n(61),C=Object(u.action)("duplicateEvent",(function(e,t,n,r){return Object(S.c)({name:"DuplicateEvent",customData:{owa_1:t}},{event:e,entrySource:t,useDefaultScope:r,viewType:n})})),E=n(2142),w=n(1192),T={customData:function(e,t,n){return{isCharmExplicitlySet:e,entrySource:t,viewType:n}}},A={customData:function(e,t,n,r){return{isCharmExplicitlySet:e,entrySource:t,viewType:n}}},_={customData:function(e,t,n,r,i,o,a){return{fullComposeEntrySource:r,viewType:i}}},x=n(2262),F=n(2584),M=n(4786),k=n(5054),P=n(308),D=n(18);function R(e,t){var n=Object(r.a)().uiState;if(!n.freeBusyData){var i=n.freeBusyData=new D.ObservableMap({});P.b.initialize(i)}}var B=n(4410),L=n(373),N=n(1306),G=n(2858),z=n(2261),W=n(4411),H=n(1730),q=n(1201),U=n(2005),V=n(84),Z=n(2412),Q=n(275),J=Object(Q.action)("initializeLocationFeedbackManagerState")((function(){Z.a.feedbackManagerState={maxActionBatchSize:10,entityType:5,entityScenarioName:"LocationWell_react",hasSessionStarted:!1,isSessionPaused:!1,entityFeedbackEntries:[],clientSessionId:"",clientVersion:"1.1",clientId:1,entrySequenceNumber:0}})),K=n(156),$=n(3065),X=n(1936),Y=n(98),ee=n(2786),te=Object(S.d)("showFullComposeInPopOut")((function(e,t,n){var i=Object(r.a)();i.event=t,i.originalEvent=n,re(e,"PopOut")})),ne=Object(S.d)("showFullCompose",T)((function(e,t,n,o,c){return Object(b.__awaiter)(this,void 0,void 0,(function(){var u,s,l;return Object(b.__generator)(this,(function(d){switch(d.label){case 0:return u=a(t),s=Object(r.a)(),u||(l=s.event,Object(N.a)(),s.event||Object(O.r)(l)),s.metricsInfo=Object(b.__assign)({},s.metricsInfo),s.metricsInfo.formSessionId||(s.metricsInfo.formSessionId=Object(i.a)()),"QuickCompose"===t&&(s.metricsInfo.quickComposeFinalEvent=Object(M.a)(s.event)),"Mail_SmartReplyWithMeeting"===t&&(s.metricsInfo.extractionSourceId=o),[4,re(Object(k.c)(s.event,e,n,function(e){return"Mail_AcceptPNT"==e||"ProposeNewTimeInfobar"==e||"PeekReviewPNT"==e||"TimePanelReviewPNT"==e||"ReviewPNT"==e}(t),o,s.metricsInfo.formSessionId,c),t)];case 1:return d.sent(),[2]}}))}))}));function re(e,t){return Object(b.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l,d;return Object(b.__generator)(this,(function(b){switch(b.label){case 0:return Object(K.d)()&&((d=Object(K.b)()).registerFormSaveHandler&&d.registerFormSaveHandler((function(){return Object(O.lc)()})),d.registerFormCloseHandler&&d.registerFormCloseHandler((function(){return Object(O.tb)()}))),n=Object(r.a)(),i=n.event,e||(e=Object(k.c)(i,!1,"PopOut",!1,null,null)),u=Object(Y.p)(),i.StartTimeZoneId=i.StartTimeZoneId||u,i.EndTimeZoneId=i.EndTimeZoneId||u,i.Start=Object(y.Qb)(i.StartTimeZoneId,i.Start),i.End=Object(y.Qb)(i.EndTimeZoneId,i.End),[4,Object(W.a)(i,!1,e,!1)];case 1:return b.sent(),Object(B.b)(),Object(O.w)(),s=n.openedForm,n.openedForm=c.b,n.uiState=e,n.metricsInfo.fullComposeEntrySource=t,a(t)||t==o.f||(n.metricsInfo.quickComposeEntrySource=void 0),Z.a.feedbackManagerState||J(),R(0,n.openedForm),H.e.importAndExecute(e,[i.ParentFolderId.Id],Object(y.Wb)(i.Start),Object(H.c)(i,q.g.suggestedItems),(function(e){return e.filter((function(e){return!i.ItemId||e.ItemId.Id!=i.ItemId.Id}))}),!0,!0,!0),Object(F.a)()&&s!=c.e&&(U.f.importAndExecute(i,t==o.e,e.shouldAdjustStartTimeEndTime,!0),Object(O.u)()),l=i.ParentFolderId.mailboxInfo.userIdentity,i.ParentFolderId.mailboxInfo&&X.g.importAndExecute(i,Object(Y.s)(l),!1),t!=o.f&&(Object(z.b)(),Object(L.r)(l)||$.a.importAndExecute()),Object(K.d)()&&(d=Object(K.b)()).navigateToView&&d.navigateToView(Object(x.a)()?"ComposeForm":"EditForm",Object(w.x)(i)?"Send":"Save",i),(Object(V.i)("cal-mf-calendarPicker")||Object(V.i)("cal-mf-calendarPickerV2")||Object(L.p)())&&G.b.importAndExecute(i),Object(ee.a)(),[2]}}))}))}var ie=n(4763),oe=n(179);Object(u.orchestrator)(C,(function(e){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,o,a;return Object(b.__generator)(this,(function(c){switch(c.label){case 0:return t=e.event,n=e.useDefaultScope?0:function(e){if(Object(w.z)(e.CalendarItemType))return 1;if(Object(w.G)(e.CalendarItemType))return 3;return 0}(t),r=Object(E.b)(t.ItemId,"WithBlockedExternalContent",null,null,3===n,{fetchSource:"DuplicateEvent"}).fullEventPromise,o=D.toJS,[4,r];case 1:return(i=o.apply(void 0,[c.sent()])).ItemId=null,i.IsOnlineMeeting&&(i.OnlineMeetingConferenceId=null,i.OnlineMeetingJoinUrl=null,i.OnlineMeetingTollFreeNumbers=null,i.OnlineMeetingTollNumber=null,i.JoinOnlineMeetingUrl=null,i.SkypeTeamsProperties=null),i.HasAttachments&&(i.Attachments=null),i.IsAllDayEvent&&(i.End=I(i.End)),function(e){var t=Object(oe.u)(e.Id);if(!t)return!1;var n=Object(oe.g)().filter((function(e){return e.id.id==t.id}))[0];return Object(oe.N)(n)}(i.ParentFolderId)||(i.ParentFolderId=Object(ie.a)()),i.RequiredAttendees&&(i.RequiredAttendees=ae(i.RequiredAttendees)),!i.IsOrganizer&&i.Organizer&&i.Organizer.Mailbox.EmailAddress&&(a=i.Organizer.Mailbox.EmailAddress,0===i.RequiredAttendees.filter((function(e){return(null==e?void 0:e.Mailbox)&&e.Mailbox.EmailAddress==a})).length&&i.RequiredAttendees.push({Mailbox:a})),i.OptionalAttendees&&(i.OptionalAttendees=ae(i.OptionalAttendees)),i.Resources&&(i.Resources=ae(i.Resources)),i.InboxReminders&&i.InboxReminders.forEach((function(e){return e.Id=void 0})),i.MeetingRequestWasSent=void 0,i.ConversationId=void 0,Object(O.r)(i),ne(!1,e.entrySource,e.viewType),[2]}}))}))}));function ae(e){return e.map((function(e){return{Mailbox:e.Mailbox}}))}Object(u.orchestrator)(O.s,(function(e){var t,n=e.event;Object(O.r)(n),e.formType&&Object(O.ec)(e.formType),(null===(t=n.ItemId)||void 0===t?void 0:t.Id)?null==n.CharmId||0==n.CharmId?Object(O.Ub)(c.a.None):Object(O.Ub)(c.a.Manual):Object(O.Ub)(c.a.None),Object(z.b)(),Object(L.r)(n.ParentFolderId.mailboxInfo.userIdentity)||$.a.importAndExecute()}));Object(u.orchestrator)(O.bb,(function(e){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(b.__generator)(this,(function(i){if(0,52,59,(t=Object(r.a)().event)&&Object(V.i)("cal-showTeamsOrSkypeCharmWhenOnlineMeeting"))if(n=Object(j.a)(),!e.IsOnlineMeeting||0!==t.CharmId&&52!==t.CharmId&&59!==t.CharmId)(null==n?void 0:n.isCharmExplicitlySet)&&(52===t.CharmId||59===t.CharmId)&&(Object(O.Rb)(0),n.isCharmExplicitlySet=!1);else{switch(e.onlineMeetingProvider){case"SkypeForBusiness":case"SkypeForConsumer":Object(O.Rb)(52);break;case"TeamsForBusiness":Object(O.Rb)(59)}n&&(n.isCharmExplicitlySet=!0)}return t&&Object(V.i)("cal-mf-enableDefaultOnlineMeetingSetting")&&e.isOnlineMeetingExplicitlySet&&Object(O.bc)(),[2]}))}))}));var ce=n(6098),ue=n(2208),se=n(2555);Object(u.orchestrator)(O.N,(function(e){var t=Object(se.a)();if(t&&e.attachment.IsInline){var n="cid:"+e.attachment.ContentId;Object(ce.a)(t.bodyViewState,'img[originalsrc^="'+n+'"]'),Object(ue.a)(t.bodyViewState)}}));var le=n(527),de=n(1842),be=n(29);Object(u.orchestrator)(O.o,(function(){var e=Object(r.a)().event,t=Object(s.d)()||function(){var e,t=!1;if(Object(V.i)("cal-mf-enableDefaultOnlineMeetingSetting")){var n=Object(be.a)();t=!!n&&!!(null===(e=n.UserOptions)||void 0===e?void 0:e.AddOnlineMeetingToAllEvents)}return t}();!e.IsOnlineMeeting&&t&&Object(O.bb)(!0,Object(de.b)(e),!1);var n=Object(le.g)(e.Start,e.End);Object(O.X)({start:n.start,end:n.end})}));var fe=n(3580),Oe=n(2477),pe=n(2392);var he=n(1760),je=n(301),me=n(324),ve=n(69),ge=new ve.c((function(){return n.e(818).then(n.bind(null,16614))})),ye=new ve.a(ge,(function(e){return e.initLoadMailboxAutomaticRepliesConfiguration})),Ie=n(6118);Object(u.orchestrator)(l.a,(function(e){return Object(b.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,u,s,l,d,f,p,h;return Object(b.__generator)(this,(function(b){switch(b.label){case 0:return t=e.entrySource,n=e.viewType,i=e.initialCalendarEvent,o=e.eventScope,u=Object(r.a)(),(s=a(t))||Object(N.a)(),(l=new je.a("ComposeEventStarted")).addCustomData({EntrySource:t}),d=!Object(me.a)(),s?(Object(O.ec)(c.e),u.event&&d&&R(u.event,c.e),Object(z.b)(),[3,7]):[3,1];case 1:return J(),f=void 0,(null===(h=null==i?void 0:i.ItemId)||void 0===h?void 0:h.Id)?3!=o&&2!=o?[3,3]:[4,Object(E.b)(i.ItemId,"WithBlockedExternalContent",null,null,!0,{fetchSource:"QuickCompose_"+t}).fullEventPromise]:[3,5];case 2:return p=b.sent(),p=Object(D.toJS)(p),2==o&&Object(he.e)(p,i),p.IsAllDayEvent&&(p.End=I(p.End)),f=Object(fe.a)(p,!0),Object(O.s)(f,c.e),[3,4];case 3:f=Object(fe.a)(i,!0),i.IsAllDayEvent&&(f.End=I(i.End)),Object(E.b)(f.ItemId,"WithBlockedExternalContent",null,null,void 0,{fetchSource:"QuickCompose_"+t}),Object(O.s)(f,c.e),b.label=4;case 4:return[3,6];case 5:f=i?Object(fe.a)(i):Object(fe.a)({Start:Object(pe.a)(Object(y.Pb)()),ReminderMinutesBeforeStart:Object(Oe.a)(!1)}),Object(O.s)(f,c.e),Object(Ie.a)(!1)&&(Object(O.z)(c.h.Event),ye.importAndExecute()),b.label=6;case 6:f&&d&&R(0,c.e),b.label=7;case 7:return Object(F.a)()&&(U.f.importAndExecute(u.event,!1,u.uiState.shouldAdjustStartTimeEndTime),Object(O.u)()),(Object(V.i)("cal-mf-calendarPicker")||Object(V.i)("cal-mf-calendarPickerV2")||Object(L.p)()||"TimePanel"===n)&&G.b.importAndExecute(u.event),Object(O.w)(),l.end(),[2]}}))}))}));var Se=n(2423),Ce=n(645);Object(u.orchestrator)(Ce.c,(function(e){var t=e.userId,n=Object(Se.a)();t&&n&&Object(L.r)(t)&&G.b.importAndExecute(n)}));var Ee=Object(S.d)("showFullComposeWithAttendee",A)((function(e,t,n,o){return Object(b.__awaiter)(this,void 0,void 0,(function(){var c,u;return Object(b.__generator)(this,(function(s){switch(s.label){case 0:return a(t)||Object(N.a)(),Object(O.s)(function(e){var t={Start:Object(pe.a)(Object(y.Pb)()),ReminderMinutesBeforeStart:Object(Oe.a)(!1)};return t.RequiredAttendees=e,Object(fe.a)(t)}(o)),c=Object(r.a)(),u=c.event,[4,re(Object(k.c)(u,e,n,!1,null,Object(i.a)()),t)];case 1:return s.sent(),[2]}}))}))})),we=Object(S.d)("showFullComposeInEditMode",_)((function(e,t,n,r,i,o,a,c){var u;return Object(b.__awaiter)(this,void 0,void 0,(function(){var s,l,d,f,p;return Object(b.__generator)(this,(function(h){switch(h.label){case 0:return s=!1,e||(e=Object(fe.a)(),s=!0),Object(N.d)("ViewOpened","EditForm",e.IsOrganizer,e.IsMeeting),l=null,(null===(u=e.ItemId)||void 0===u?void 0:u.Id)?(d=Object(E.b)(e.ItemId,"WithBlockedExternalContent",null,(function(){return e}),2===t||3===t,{fetchSource:"FullComposeEdit"}).fullEventPromise,f=D.toJS,[4,d]):[3,2];case 1:return l=f.apply(void 0,[h.sent()]),Object(w.h)(l)?[3,3]:[2];case 2:l=Object(fe.a)(e,s),h.label=3;case 3:return 2==t&&(p=e,e.Start&&e.End||(p=Object(E.b)(e.ItemId,"WithBlockedExternalContent",null,null,!1,{fetchSource:"FullComposeInEditMode_"+r}).event),l=Object(b.__assign)({},l),Object(he.e)(l,p)),l.IsAllDayEvent&&(l.End=I(l.End)),n?Object(O.r)(l,e):Object(O.r)(l),c&&Object(O.o)(),ne(0!=l.CharmId,r||"Edit",i,o,a),[2]}}))}))})),Te=n(4),Ae=n(685),_e=n(5093),xe=n.n(_e),Fe=n(4009),Me=Object(Q.action)("showFullComposeFromDeeplink")((function(){return Object(b.__awaiter)(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,u;return Object(b.__generator)(this,(function(s){if(e=Object(Te.b)(),t={},e.subject&&(t.Subject=xe.a.sanitizeHtml(e.subject)),e.body&&(t.Body={BodyType:"HTML",Value:xe.a.sanitizeHtml(e.body)}),n=Object(Y.h)().UserOptions,r=null==n?void 0:n.TimeZone,e.startdt)try{t.Start=Object(y.Qb)(r,e.startdt)}catch(e){}if(e.enddt)try{t.End=Object(y.Qb)(r,e.enddt)}catch(e){}return e.allday&&(t.IsAllDayEvent="true"==e.allday.toLowerCase()),e.location&&(t.Locations=[{Id:e.location,DisplayName:e.location,PostalAddress:{Type:"Business",LocationSource:"None"}}]),"online"in e&&(t.IsOnlineMeeting=!0),(e.to||e.cc)&&(i=function(e){return e.map((function(e){return{Mailbox:e}}))},e.to&&(o=[],Object(Fe.a)(e.to,o),t.RequiredAttendees=i(o)),e.cc&&(a=[],Object(Fe.a)(e.cc,a),t.OptionalAttendees=i(a))),u=""+Object(Ae.l)()+location.pathname,window.history.replaceState(null,null,u),[2,we(t,0,null,"Deeplink_Compose",c.c,null)]}))}))})),ke=n(3229);function Pe(){return Object(r.a)().openedForm==c.b}n.d(t,"showFullCompose",(function(){return ne})),n.d(t,"showFullComposeInPopOut",(function(){return te})),n.d(t,"showFullComposeWithAttendee",(function(){return Ee})),n.d(t,"showQuickCompose",(function(){return l.a})),n.d(t,"showFullComposeInEditMode",(function(){return we})),n.d(t,"showFullComposeFromDeeplink",(function(){return Me})),n.d(t,"duplicateEvent",(function(){return C})),n.d(t,"isQuickComposeOpen",(function(){return ke.a})),n.d(t,"isFullComposeOpen",(function(){return Pe}))},3720:function(e,t,n){"use strict";var r=n(1466);var i=n(69);function o(){return{position:null,subMenuSelectionIndex:-1}}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=new i.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(36),n.e(546)]).then(n.bind(null,16504))})),c=Object(r.a)(a,(function(e){return e.PasteOptionPlugin}),"PasteOption",(function(e){return 7===e.eventType&&"Paste"==e.source}))},3721:function(e,t,n){"use strict";var r=n(69),i=n(1466);function o(){return{position:null,hasHeaders:!1}}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(36),n.e(546)]).then(n.bind(null,16561))})),c=Object(i.a)(a,(function(e){return e.TableEditPlugin}),"TableEdit",(function(e,t){return 7==e.eventType||11==e.eventType&&t.queryElements("TABLE").length>0}))},3818:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n(18);function i(e,t){return{appendOnSend:e||[],draftComposeType:t,lastFocusedControl:0,subject:{selectionStart:-1,selectionEnd:-1},internetHeaders:new r.ObservableMap,keysOfInternetHeadersToBeRemoved:[],isAutorunComposeEventTriggered:!1,sessionStore:new r.ObservableMap}}function o(e){var t=c(e,"AppendOnSend"),n=[];if(t)try{n=JSON.parse(t.Value)}catch(e){n=[]}return n}function a(e){var t=c(e,"ComposeType"),n="",r="unknown";return t&&(r="reply"==(n=t.Value).toLowerCase()?"reply":"forward"==n.toLowerCase()?"forward":"newMail"),r}function c(e,t){if(!e||!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n],i=void 0;if((null==r?void 0:r.ExtendedFieldURI)&&(i=r.ExtendedFieldURI.PropertyName),t&&i==t)return r}return null}},4009:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1365),i=n(1514),o=n(1611),a=/[,;]/;function c(e,t){e.length>0&&e.split(a).forEach((function(e){if(Object(r.c)(e))t.push({EmailAddress:e,Name:e});else{var n=Object(i.a)(e),a=Object(o.a)(n.address,n.displayName);if(!a)return;t.push(a)}}))}},4087:function(e,t,n){"use strict";function r(e){return{isOpen:!1,errors:[],useFlexPane:e}}n.d(t,"a",(function(){return r}))},4088:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(2830),o=n(3125);function a(){return Object(r.__assign)(Object(r.__assign)({},Object(i.a)()),{emojiResults:Object(o.a)(),queryString:"",wordBeforeCursor:"",selectedEmojiIndex:0})}},4089:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3063),i=n(351),o=n(2557),a=n(3224);function c(){return{editorProofingId:Object(i.a)(),premimumFlagsFound:0,premiumCategories:"",skittleViewStatus:r.b.Hide,isProofingDisabled:!1,skittleCalloutStatus:r.a.Hide,premiumPreviewData:{numberOfDaysLeftToUsePremiunSuggestions:void 0,premiumSuggestionsCount:a.g,premiumPreviewStatus:o.a.Unknown,premiumPreviewType:o.b.None}}}},4090:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(1275),o=n(2830);function a(e){var t=Object(r.__assign)(Object(r.__assign)({},Object(o.a)()),{queryString:"",wordBeforeCursor:"",findResultSet:[],selectedRecipientIndex:0,isSearching:!1,directorySearchType:i.a.None,atMentionTuples:{},mentionsAddedRecipients:[]});return e&&e.length>0&&e.forEach((function(e){var n=JSON.parse(e);if((null==n?void 0:n.a)&&n.b){var r=JSON.parse(n.a);r&&("MentionAddedRecipients"==n.b&&r instanceof Array?t.mentionsAddedRecipients=r:r.Mentioned&&(t.atMentionTuples[n.b]={EmailAddress:r.Mentioned}))}})),t}},4091:function(e,t,n){"use strict";function r(){return{imageStatusMap:{}}}n.d(t,"a",(function(){return r}))},4092:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=0;function i(){return(r++).toString()}},4093:function(e,t,n){"use strict";function r(){return{objectUrls:{}}}n.d(t,"a",(function(){return r}))},4411:function(e,t,n){"use strict";var r=n(0),i=n(275),o=n(1384),a=n(373),c=n(2066),u=1;t.a=Object(i.action)("initAttachmentWell")((function(e,t,n,i){return void 0===i&&(i=!0),Object(r.__awaiter)(this,void 0,void 0,(function(){var s,l,d,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e?[4,o.j.import()]:[2];case 1:return s=r.sent(),n.attachmentWell=s(i,!1,u.toString()),u++,l=e.ParentFolderId.mailboxInfo,d=Object(a.r)(l.userIdentity),b=d?[c.a.ConvertClassicToCloudy,c.a.SaveToCloud,c.a.MoveAttachmentToInline,c.a.Preview]:[],t?[4,o.q.importAndExecute(e.Attachments,l,n.attachmentWell,!0,b)]:[3,3];case 2:return r.sent(),[3,5];case 3:return[4,o.n.importAndExecute(e.Attachments,l,n.attachmentWell,!0,!1,b)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))}))},4763:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(287),i=n(179),o=n(3581),a=n(373);function c(){var e=Object(i.w)(),t=u(null==e?void 0:e.id.mailboxInfo.userIdentity);if(t)return t;var n=Object(a.i)();if(n){var o=u(n.userIdentity);if(o)return o}var c=null,s=Object(r.d)();return e&&(s=e.id.mailboxInfo,c=Object(i.r)(e)),{Id:c,mailboxInfo:s}}function u(e){var t=Object(i.w)(e),n=t?function(e){var t=Object(o.a)(e);return t?t.filter(i.N):null}(t.id.mailboxInfo.userIdentity):null,r=n?n.length:0,a=t;return n&&r>0?(a=n[r-1],t&&n.forEach((function(e){e.id.id==t.id.id&&(a=t)})),{Id:Object(i.r)(a),mailboxInfo:a.id.mailboxInfo}):null}},5054:function(e,t,n){"use strict";var r=n(0),i=n(4409),o=n(1241),a=n(4087),c=n(4088),u=n(2089),s=n(1558),l=n(4089),d=n(3818),b=n(2626),f=n(3225),O=n(4090),p=n(1226),h=n(177),j=n(4091),m=n(84),v=n(4092),g=n(3720),y=n(3721),I=n(4093),S=n(188),C=n(1194);function E(){var e,t=Object(C.a)().metricsInfo;return(null===(e=null==t?void 0:t.timeSuggestionShown)||void 0===e?void 0:e[0])>0}n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"c",(function(){return _}));var w=122,T=74,A=10;function _(e,t,n,C,w,_,x){var F,M,k,P=(null===(F=e.RequiredAttendees)||void 0===F?void 0:F.length)+(null===(M=e.OptionalAttendees)||void 0===M?void 0:M.length),D=Object(r.__assign)(Object(r.__assign)({},Object(b.a)()),{docking:{isBottomDocking:!1,bottomDockingHeight:T,minBodyHeight:72,scrollLeft:0,scrollBarHeight:0,dockingWidth:0,bottomDockingBottom:0,useStickyDocking:!1,initialVisiblePart:null,dockingTriggerPart:null},dropViewState:Object(p.a)(),isCharmExplicitlySet:t,freeBusyData:void 0,mentionsPicker:Object(O.a)(null),attachmentWell:void 0,bodyViewState:Object(s.a)(e.Body?e.Body.Value:null),isOptionalAttendeeWellEnabled:(null===(k=e.OptionalAttendees)||void 0===k?void 0:k.length)>0,viewType:n,ribbon:Object(u.a)(),isRibbonShown:!1,emojiPicker:Object(c.a)(),accChecker:Object(a.a)(!1),inlineImageResize:Object(f.a)(),inlineImage:Object(j.a)(),inlineImageV2:Object(I.a)(),customRecurrenceViewState:{recurrence:null,startDate:null},subjectViewState:{selectionStart:0,selectionEnd:0},currentSidePaneType:0,showSchedulingAssistant:!1,showCompactRecipientWell:P>A,showDateSelectorTimeZones:Object(i.a)(e.Start.tz,e.End.tz),isUndoNotificationShown:!1,schedulingGridViewState:{},currentSaveRequestTimeStamp:null,isAcceptProposeNewTime:C,extractionSourceId:w,internetMessageId:x,awaitingServiceResponse:!1,dateSelectorViewState:{shouldHighlightStartDate:!1,shouldHighlightStartTime:!1,shouldHighlightEndDate:!1,shouldHighlightEndTime:!1},unresolvedLocation:null,linkFiles:[],addin:Object(d.a)(e.AppendOnSend),uiEnabled:!0,isCompactRecipientWellExpanded:!1,isDarkMode:Object(h.e)(),typeOfItemBeingDragged:null,showDropHint:!1,proofing:Object(l.a)(),isOnlineMeetingExplicitlySet:!1,expressionId:Object(v.a)(),pasteOption:Object(g.b)(),tableEdit:Object(y.b)(),shouldAdjustStartTimeEndTime:Object(S.f)()||n==o.d,didDiscoverTimeSuggestions:!Object(m.i)("cal-mf-timeSuggestions-exp-c")||E()});return D.ribbon.visibleItemCount=1,D}},527:function(e,t,n){"use strict";var r=n(188);function i(e){return Object(r.f)()&&0!==e?e<60?Object(r.c)():Object(r.b)():0}var o=n(743);function a(){var e=Object(o.a)(),t=i(e);return Math.max(e-t,0)}var c,u=n(9);function s(e,t){if(!Object(r.g)())return t;var n=i(Object(u.x)(t,e)),o=n?Object(u.ec)(t,n):t;return Object(u.Gb)(e,o)?o:t}function l(e,t){if(!Object(r.h)())return e;var n=i(Object(u.x)(t,e)),o=n?Object(u.h)(e,n):e;return Object(u.Gb)(o,t)?o:e}function d(e,t){return{start:l(e,t),end:s(e,t)}}function b(e,t,n,i){var o=Object(u.x)(t,e),a=Object(u.x)(i,n),s=60-Object(r.b)();return 0===o&&0!==a&&a<s?c.ZeroToShort:0===o&&a>=s?c.ZeroToLong:0===a&&0!==o&&o<s?c.ShortToZero:0===a&&o>=s?c.LongToZero:o<s&&a<s||o>=s&&a>=s?c.None:o<s&&a>=s?c.ShortToLong:o>=s&&a<s?c.LongToShort:null}function f(e,t,n,i,o,a){if(!Object(r.h)())return n;var s=b(e,t,n,i),l=o?n:e,d=n;return s===c.ShortToLong?d=Object(u.h)(Object(u.ec)(l,Object(r.c)()),Object(r.b)()):s===c.LongToShort?d=Object(u.h)(Object(u.ec)(l,Object(r.b)()),Object(r.c)()):s!==c.ZeroToShort||a?s!==c.ZeroToLong||a||(d=Object(u.h)(l,Object(r.b)())):d=Object(u.h)(l,Object(r.c)()),Object(u.Gb)(d,i)?d:n}function O(e,t,n,i){if(!Object(r.g)())return i;var o=b(e,t,n,i),a=i;return o===c.ShortToLong?a=Object(u.ec)(Object(u.h)(i,Object(r.c)()),Object(r.b)()):o===c.LongToShort?a=Object(u.ec)(Object(u.h)(i,Object(r.b)()),Object(r.c)()):o===c.ZeroToShort?a=Object(u.ec)(i,Object(r.c)()):o===c.ZeroToLong&&(a=Object(u.ec)(i,Object(r.b)())),Object(u.Gb)(n,a)?a:i}function p(e,t){if(!Object(r.h)())return t;var n=Object(r.c)(),i=Object(r.b)();return e>=60-i?Object(u.h)(t,i):Object(u.h)(t,n)}function h(e,t,n,r){return Object(u.Hb)(t,r)?O(e,t,n,r):s(n,r)}function j(e,t,n,r){return Object(u.Hb)(e,n)?f(e,t,n,r):l(n,r)}function m(e,t,n,r){return{start:j(e,t,n,r),end:h(e,t,n,r)}}!function(e){e[e.None=0]="None",e[e.ShortToLong=1]="ShortToLong",e[e.LongToShort=2]="LongToShort",e[e.ZeroToShort=3]="ZeroToShort",e[e.ZeroToLong=4]="ZeroToLong",e[e.ShortToZero=5]="ShortToZero",e[e.LongToZero=6]="LongToZero"}(c||(c={})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return p})),n.d(t,"h",(function(){return m}))},607:function(e,t,n){"use strict";var r=n(531),i=n(599),o=function(){return i.a.Date.now()},a=n(637),c="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var i,l,d,b,f,O,p=0,h=!1,j=!1,m=!0;if("function"!=typeof e)throw new TypeError(c);function v(t){var n=i,r=l;return i=l=void 0,p=t,b=e.apply(r,n)}function g(e){var n=e-O;return void 0===O||n>=t||n<0||j&&e-p>=d}function y(){var e=o();if(g(e))return I(e);f=setTimeout(y,function(e){var n=t-(e-O);return j?s(n,d-(e-p)):n}(e))}function I(e){return f=void 0,m&&i?v(e):(i=l=void 0,b)}function S(){var e=o(),n=g(e);if(i=arguments,l=this,O=e,n){if(void 0===f)return function(e){return p=e,f=setTimeout(y,t),h?v(e):b}(O);if(j)return clearTimeout(f),f=setTimeout(y,t),v(O)}return void 0===f&&(f=setTimeout(y,t)),b}return t=Object(a.a)(t)||0,Object(r.a)(n)&&(h=!!n.leading,d=(j="maxWait"in n)?u(Object(a.a)(n.maxWait)||0,t):d,m="trailing"in n?!!n.trailing:m),S.cancel=function(){void 0!==f&&clearTimeout(f),p=0,i=O=l=f=void 0},S.flush=function(){return void 0===f?b:I(o())},S}},6098:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1580);function i(e,t){Object(r.a)(e,"queryElements",t,0,(function(e){return e.parentNode.removeChild(e)}))}},637:function(e,t,n){"use strict";var r=n(531),i=n(695),o=NaN,a=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(i.a)(e))return o;if(Object(r.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(r.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=u.test(e);return n||s.test(e)?l(e.slice(2),n?2:8):c.test(e)?o:+e}},643:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(63),i=function(){var e,t,n=Object(r.a)();return!(null===(t=null===(e=n)||void 0===e?void 0:e.navigator)||void 0===t||!t.userAgent)&&n.navigator.userAgent.indexOf("rv:11.0")>-1}},645:function(e,t,n){"use strict";var r,i=n(3),o=Object(i.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(r||(r={}));var a=n(233),c=n(287);function u(e,t){switch(e){case r.Outlook:case r.OutlookGroup:return(t||Object(c.d)().userIdentity)+e.toString();case r.TeamsCalendars:return e.toString();default:return Object(a.a)(e)}}var s=n(98),l=n(84);function d(e,t){var n=u(e,t);return o().loadedCalendarAccounts.some((function(e){return e===n}))}function b(e){return function(e){if(e&&e!==Object(s.b)()){var t=[r.Outlook];return Object(l.i)("cal-multiAccounts-groups")&&t.push(r.OutlookGroup),t}return[r.Outlook,r.OutlookGroup,r.TeamsCalendars]}(e).every((function(t){return d(t,e)}))}var f=Object(i.action)("addToLoadedCalendarAccounts",(function(e){return{calendarAccountData:e}}));Object(i.mutator)(f,(function(e){o().loadedCalendarAccounts.push(e.calendarAccountData)}));var O=n(729),p=n(52),h=Object(i.action)("calendarCacheInitializedForAccount",(function(e,t){return{calendarEndpointType:e,userId:t}})),j=n(0),m=n(737),v=n(757),g=n(69),y=new g.c((function(){return Promise.all([n.e(16),n.e(18),n.e(696)]).then(n.bind(null,16682))})),I=new g.a(y,(function(e){return e.initializeSelectedTeamsCalendars}));var S=n(640),C=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)}),E={};function w(e,t){if(t=t||Object(c.d)().userIdentity,d(e,t))return Promise.resolve();var n=u(e,t),i=E[n];if(i)return i.requestPromise;var o=C((function(){return function(e,t){return Object(j.__awaiter)(this,void 0,void 0,(function(){return Object(j.__generator)(this,(function(n){switch(n.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,3];case r.TeamsCalendars:return[3,5]}return[3,7];case 1:return[4,Object(m.f)(t)];case 2:return n.sent(),[3,8];case 3:return[4,Object(v.b)(t)];case 4:return n.sent(),[3,8];case 5:return[4,I.importAndExecute()];case 6:return n.sent(),[3,8];case 7:Object(a.a)(e),n.label=8;case 8:return[2]}}))}))}(e,t)})).retriableFunc();return E[n]={requestPromise:o},o.then((function(){f(n),h(e,t)})).catch((function(e){p.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)}))}Object(i.orchestrator)(O.e,(function(e){w(r.Outlook,e.userIdentity),Object(l.i)("cal-multiAccounts-groups")&&w(r.OutlookGroup,e.userIdentity)}));var T=n(373);function A(){return Object(j.__awaiter)(this,void 0,void 0,(function(){var e,t,n,i,o,a;return Object(j.__generator)(this,(function(c){switch(c.label){case 0:return e=w(r.Outlook),t=Object(T.n)().map((function(e){return w(r.Outlook,e.userIdentity)})),n=w(r.OutlookGroup),i=w(r.TeamsCalendars),o=Object(j.__spread)([e,n],t,[i]),Object(l.i)("cal-multiAccounts-groups")&&(a=Object(T.n)().map((function(e){return w(r.OutlookGroup,e.userIdentity)})),o=o.concat(a)),[4,Promise.all(o)];case 1:return c.sent(),[2]}}))}))}n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return A}))},691:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(1),o=n(62),a=n(279),c=Object(a.a)({cacheSize:100}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,u=e.className,s=e.disabled,l=e.styles,d=e.required,b=e.theme,f=c(l,{className:u,disabled:s,required:d,theme:b});return i.createElement(n,Object(r.__assign)({},Object(o.j)(this.props,o.h),{className:f.root}),a)},t}(i.Component)},695:function(e,t,n){"use strict";var r=n(682),i=n(684),o="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(i.a)(e)&&Object(r.a)(e)==o}},725:function(e,t,n){"use strict";var r=n(0),i=n(275),o=n(52),a=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(this.store){var a=new Error("MruCache cannot be initialized twice.");a.diagnosticInfo=this.firstCs,o.d(a)}else{this.store=e,this.deleteCallback=t;try{for(var c=Object(r.__values)(e.keys()),u=c.next();!u.done;u=c.next()){var s=u.value;this.mruList.push(s)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}this.firstCs=(new Error).stack}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return a}))},737:function(e,t,n){"use strict";var r=n(0),i=n(179),o=n(287),a=n(29),c=n(526),u=n(52);function s(e,t,n){var s,l={},d={},b={},f={},O={},p=n?[n]:[Object(a.a)().SessionSettings.LogonEmailAddress],h=Object(o.d)(n);return e.forEach((function(e){O[e.ItemId.Id]=e.ItemId.ChangeKey;var n=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:e.GroupId,mailboxInfo:h}}),o=Object(i.s)(h.userIdentity,e.GroupId);f[o]=n,e.Calendars.forEach((function(e){if(function(e,t){if(7==e.CalendarFolderType)return!1;if(Object(c.d)(e)){var n=e;if(n.IsOwnerEmailAddressInvalid)return u.g.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+n.OwnerEmailAddress),!1;var r=n.IsGeneralScheduleCalendar?n.OwnerEmailAddress:n.SharedFolderId?n.SharedFolderId.Id:null;if(!r)return u.g.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(t.includes(r))return u.g.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(t.push(r),n.OwnerEmailAddress=n.OwnerEmailAddress.toLowerCase(),n.IsGroupMailboxCalendar)return!1}return!0}(e,p)){var n=e.ItemId.Id,o=Object(i.h)(e).Id,a=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:n,mailboxInfo:h}});if(1==e.CalendarFolderType){var d=t&&t.filter((function(e){return e.FolderId.Id===o}))[0];s={id:{id:n,mailboxInfo:h},calculatedFolderId:o,displayName:d?d.DisplayName:e.CalendarName,colorScheme:null},a.CalendarName=s.displayName}!l[n]&&(l[n]=a),!b[o]&&(b[o]={id:e.ItemId.Id,mailboxInfo:h}),!O[n]&&(O[n]=e.ItemId.ChangeKey)}}))})),t.forEach((function(e){var t=b[e.FolderId.Id];t&&(d[t.id]=e)})),{defaultCalendar:s,calendarEntryMapping:l,calendarFolderMapping:d,folderIdMapping:b,calendarGroupMapping:f,calendarIdToChangeKeyMapping:O}}var l=n(745),d=n(350),b=n(755),f=n(98),O=n(431),p=n(544);function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(t=null,n=null,e&&!Object(f.t)(e)||(t=Object(b.a)()),t)return[3,6];n=Object(O.a)(Object(o.d)(e)),r.label=1;case 1:return r.trys.push([1,3,,6]),[4,Object(l.a)({Header:Object(d.a)()},n)];case 2:return t=r.sent(),[3,6];case 3:return r.sent(),Object(p.a)()?[4,p.d.importAndExecute(e)]:[3,5];case 4:t=r.sent(),r.label=5;case 5:return[3,6];case 6:return t&&Object(p.a)()?(n||(n=Object(O.a)(Object(o.d)(e))),[4,p.b.importAndExecute({userIdentity:e,options:n},t)]):[3,8];case 7:r.sent(),r.label=8;case 8:return[2,t]}}))}))}var j=n(707),m=n(753);function v(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=Object(O.a)({type:"GroupMailbox",userIdentity:n,mailboxSmtpAddress:t,requestOptions:null}),a=Object(i.o)(e.Id),c=a&&(a.IsGeneralScheduleCalendar||a.IsGroupMailboxCalendar)?Object(j.a)({Id:"calendar",Mailbox:{EmailAddress:t}}):5==a.CalendarFolderType?a.SharedFolderId:e,[4,Object(m.a)({request:{FolderId:c}},o)];case 1:return[2,r.sent()]}}))}))}var g=n(532),y=n(269),I=n(3),S=Object(I.action)("calendarFolderIdUpdated"),C=Object(I.action)("setCalendarLoadState",(function(e,t){return{calendarId:e,loadState:t}}));function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),C(e,"Loading"),[4,w(e)];case 1:return n.sent(),[3,3];case 2:return(t=n.sent()).message&&(t.message.indexOf("ErrorApiQuarantined")>=0||t.message.indexOf("ErrorTooManyObjectsOpened")>=0)?C(e,"Throttled"):C(e,"Failed"),[3,3];case 3:return[2]}}))}))}function w(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,a,c,u,s,l,d,b,O,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(!(t=Object(i.m)(e)))throw new Error("Unable to get calendar entry for calendar "+e);n=Object(i.x)(e),a=Object(i.i)(e),c=Object(i.u)(n),u=c?c.mailboxInfo:Object(o.d)(),s=Object(i.L)(t),O=Object(i.t)().filter((function(e){return e.GroupId==t.ParentGroupId})),b=O?O[0].id.mailboxInfo.userIdentity:Object(o.d)().userIdentity,5==t.CalendarFolderType&&Object(f.h)().SessionSettings.DefaultPublicFolderMailbox?l=Object(f.h)().SessionSettings.DefaultPublicFolderMailbox:(p=function(e,t){return e||(t?t.userIdentity:null)}(t.OwnerEmailAddress,u),l=s?Object(i.f)(p):p),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,v(Object(g.a)({Id:a}),l,b)];case 2:return d=r.sent(),[3,4];case 3:return r.sent(),Object(y.p)("getCalendarFolderConfigurationServiceFailed"),Object(i.P)(t),[2];case 4:if(!d)throw new Error("Unable to get folder for calendar "+e);return(Object(i.P)(t),5==t.CalendarFolderType?function(e,t,n){var r=e.CalendarFolder;if(r){t.CalendarFolderId||(t.CalendarFolderId=e.CalendarFolder.FolderId);var a=r.ReplicaList[0];Object(i.b)(t,r,(c=a,{type:"PublicMailbox",userIdentity:Object(o.d)().userIdentity,mailboxSmtpAddress:c}))}var c}(d,t):function(e,t,n,r,o){var a,c,u=e.CalendarFolder;o&&(null===(a=null==u?void 0:u.FolderId)||void 0===a?void 0:a.Id)&&(u.FolderId.Id=Object(i.O)(u.FolderId.Id,r));(null===(c=null==u?void 0:u.EffectiveRights)||void 0===c?void 0:c.Read)&&(e.MasterList&&(t.RemoteCategories=e.MasterList),(r==t.OwnerEmailAddress||t.ItemId&&r==t.ItemId.Id)&&(Object(i.e)(r,{id:{id:t.ItemId.Id,mailboxInfo:n},calculatedFolderId:u.FolderId.Id}),Object(i.R)(r),Object(i.b)(t,u,n)))}(d,t,u,e,s),S(),[2])}}))}))}var T=n(373);function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(e)];case 1:if(null==(t=r.sent())||!t.WasSuccessful)throw a=new Error("[getCalendarFoldersFromServer] Failed to load calendars from server"),t?a.fetchErrorType="ServerFailure":a.networkError=!0,Object(u.d)(a),a;return n=s(t.CalendarGroups,t.CalendarFolders,e),c=t.CalendarGroups.length,o=c<1?{lowerBoundResultSize:null,upperBoundResultSize:0}:c<=3?{lowerBoundResultSize:1,upperBoundResultSize:3}:c<=6?{lowerBoundResultSize:4,upperBoundResultSize:6}:{lowerBoundResultSize:7,upperBoundResultSize:null},Object(y.p)("CalendarGroupsPerAccount",{connectedAccount_1:Object(T.r)(e),calendarGroupCount:t.CalendarGroups.length,calendarGroupCount_2:o.lowerBoundResultSize+" - "+o.upperBoundResultSize}),Object(i.E)(n.defaultCalendar,n.calendarEntryMapping,n.calendarFolderMapping,n.calendarGroupMapping,n.folderIdMapping,n.calendarIdToChangeKeyMapping),[2]}var c}))}))}var _=n(18),x=Object(I.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new _.ObservableMap});function F(e){return x().calendarIdsLoadState.get(e)}Object(I.mutator)(C,(function(e){var t=e.calendarId,n=e.loadState;x().calendarIdsLoadState.set(t,n)})),Object(I.mutator)(i.Q,(function(e){var t=e.calendar;x().calendarIdsLoadState.delete(t.id.id)})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return E})),n.d(t,"f",(function(){return A})),n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return F}))},745:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(31);function i(e,t){return Object(r.a)("GetCalendarFolders",e,t)}},746:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(31),i=n(749);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetUserUnifiedGroups",e,t)}},747:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}},749:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},e)}},753:function(e,t,n){"use strict";var r=n(31),i=n(0);function o(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(i.__assign)({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},n))),Object(r.a)("GetCalendarFolderConfiguration",e,t)}n.d(t,"a",(function(){return o}))},756:function(e){e.exports=JSON.parse('{"a":"Bbb"}')},757:function(e,t,n){"use strict";var r=n(0),i=n(275),o=n(756),a=n(11),c=n(746),u=n(747),s=n(350),l="Groups",d=n(287),b=n(526),f=n(431),O=n(179);function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return 4,(t=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(n=Object(s.a)()).RequestServerVersion="V2018_01_08",i=Object(f.a)(Object(d.d)(e)),[4,Object(c.a)({Header:n,Body:Object(u.a)({RequestedGroupsSets:t})},i)];case 1:return[2,r.sent()]}}))}))}var h=Object(i.action)("getGroupCalendarsService")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,p(e)];case 1:return null!=(t=n.sent())&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?[2,j(t.Body.GroupsSets,e)]:[2,null]}}))}))}));function j(e,t){var n=[],r=[],i=Object(O.s)(t,l);if(e.forEach((function(e){e.Groups.forEach((function(e){var o=e.SmtpAddress.toLowerCase(),a={type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:o,requestOptions:null},c={__type:b.a,CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:o,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ItemId:{Id:o},ParentGroupId:i},u={DistinguishedFolderId:o,DisplayName:e.DisplayName};n.push({entry:c,folder:u,mailboxInfo:a});var s={id:{id:o,mailboxInfo:a},calculatedFolderId:o,displayName:e.DisplayName,colorScheme:null};r.push(s)}))})),r.length>0){var c={id:{id:i,mailboxInfo:{type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:t,requestOptions:null}},GroupId:i,ItemId:{Id:i},GroupName:Object(a.b)(o.a),GroupType:3};return{groupCalendars:n,calendarGroup:c,calendars:r}}return null}var m=Object(i.action)("getGroupCalendars")((function(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,h(e)];case 1:return null!=(t=n.sent())&&null!=t.groupCalendars?(t.groupCalendars.forEach((function(e){Object(O.b)(e.entry,e.folder,e.mailboxInfo)})),Object(O.a)(t.calendarGroup),[2,{group:t.calendarGroup,calendars:t.calendars}]):[2,null]}}))}))})),v=n(269),g=n(98),y=Object(i.action)("initializeGroupCalendars")((function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:n=new v.a("initializeGroupCalendars"),e||(e=Object(d.d)().userIdentity),i=Object(g.i)(e).GroupsEnabled,o=Object(O.s)(e,l),a=!Object(O.t)().some((function(t){return t.id.id===o&&t.id.mailboxInfo.userIdentity===e})),c=i&&(t||a),n.addCustomData({issueServiceCall:c,GroupsEnabled:i,featureEnabled:!0,refresh:t,initialLoad:a}),r.label=1;case 1:return r.trys.push([1,4,,5]),c?[4,m(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return n.end(),[3,5];case 4:throw u=r.sent(),n.endWithError("ServerError",Error(u)),u;case 5:return[2]}}))}))})),I=n(3),S=n(52),C=n(607),E=null;Object(I.orchestrator)(O.D,(function(e){var t=e.payload,n=t.id,r=t.EventType,i=t.Group.SmtpAddress;S.g.info(n+": "+r+", "+i),E||(E=Object(C.a)(y.bind(null,Object(d.d)().userIdentity,!0),2e3)),E()})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return l}))},886:function(e,t,n){"use strict";var r=n(439),i=n(691),o=n(0),a=n(13);n.d(t,"a",(function(){return c}));var c=Object(r.a)(i.a,(function(e){var t,n=e.theme,r=e.className,i=e.disabled,c=e.required,u=n.semanticColors,s=a.FontWeights.semibold,l=u.bodyText,d=u.disabledBodyText,b=u.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:s,color:l,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},i&&{color:d,selectors:Object(o.__assign)((t={},t[a.HighContrastSelector]={color:"GrayText"},t),Object(a.getEdgeChromiumNoHighContrastAdjustSelector)())},c&&{selectors:{"::after":{content:"' *'",color:b,paddingRight:12}}},r]}}),void 0,{scope:"Label"})}}]);
//# sourceMappingURL=owa.MailBoot~CalendarComposeFormStore~QuickComposeIndex.js.map
self.scriptsLoaded['owa.MailBoot~CalendarComposeFormStore~QuickComposeIndex.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarComposeFormStore~QuickComposeIndex.js'] = (new Date()).getTime();