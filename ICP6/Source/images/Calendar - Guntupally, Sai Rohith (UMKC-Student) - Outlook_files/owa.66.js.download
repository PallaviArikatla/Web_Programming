self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.66.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[66],{1900:function(e,t,r){"use strict";var n=r(3),o=r(61),i=r(1183),c=Object(n.action)("selectFocusedViewFilter",(function(e,t){return Object(o.c)({name:0===e?"TnS_SelectFocusedPivot":"TnS_SelectOtherPivot",options:{isCore:!0},customData:[e,t,null!=i.Y.inboxPausedDateTime]},{focusedViewFilter:e,actionSource:t})})),a=Object(n.action)("ON_INITIAL_TABLE_LOAD_COMPLETE",(function(e){return{tableView:e}})),u=r(3027);var s=r(18);var l=Object(n.mutatorAction)("addTableViewToStore",(function(e,t){t.set(e.id,e)}));function d(e,t){var r=Object(i.K)().tableViews,n=function(e){var t=[];switch(e.type){case 0:t.push("folderId:"+e.folderId);var r=e;t.push("lVT:"+e.listViewType),t.push("vF:"+r.viewFilter),t.push("fVF:"+r.focusedViewFilter),t.push("iCF: "+r.inboxClassificationFilter),t.push("sC:"+r.sortBy.sortColumn),t.push("sD:"+r.sortBy.sortDirection),r.categoryName&&t.push("catName:"+r.categoryName);var n=Object(u.a)(r.inboxClassificationFilter);n&&t.push("hTE"+n.join(",")),t.push("sT:"+r.scenarioType);break;case 1:t.push("folderId:"+e.folderId);var o=e;t.push("id:"+o.searchNumber),t.push("query:"+o.queryString),t.push("lVT:"+e.listViewType),t.push("sT:"+o.scenarioType);break;case 2:t.push("gId:"+e.folderId);var i=e;t.push("lVT:"+e.listViewType),t.push("vF:"+i.viewFilter)}return t.join(";").toString()}(e),o=r.get(n);if(!o&&(o=function(e,t){return{currentLoadedIndex:0,loadErrorStatus:0,id:e,isInCheckedMode:!1,isInVirtualSelectAllMode:!1,isInitialLoadComplete:!1,isLoading:!0,rowKeys:[],rowIdToRowKeyMap:new s.ObservableMap,lastEmptiedTime:null,selectAllModeTimeStamp:null,selectedRowKeys:new s.ObservableMap,serverFolderId:t.folderId,tableQuery:t,totalRowsInView:0,virtualSelectAllExclusionList:[],selectionAnchorRowKey:null,focusedRowKey:null,multiSelectionAnchorRowKey:null}}(n,e),!t)){var c=o.id;l(o,r),o=r.get(c)}return o}r.d(t,"a",(function(){return 25})),r.d(t,"b",(function(){return 25})),r.d(t,"e",(function(){return c})),r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return d}))},2023:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"SortResults:#Exchange"},e)}},2438:function(e,t,r){"use strict";var n=r(3),o=Object(n.action)("ON_NUDGE_REMOVED",(function(e){return{rowKey:e}})),i=Object(n.action)("ON_GET_NUDGES_COMPLETED",(function(e,t){return{nudgedRows:e,tableView:t}})),c=Object(n.createStore)("nudgeStore",{nudgedRows:[]}),a=c();Object(n.mutator)(i,(function(e){a.nudgedRows=e.nudgedRows})),Object(n.mutator)(o,(function(e){for(var t=a.nudgedRows.length-1;t>=0;t--)a.nudgedRows[t].rowKey===e.rowKey&&a.nudgedRows.splice(t,1)}));var u=r(4660),s=r(11);function l(e){var t=a.nudgedRows.filter((function(t){return t.rowKey===e}))[0],r=t.daysAgo,n=0==t.reason;return 0==r?n?Object(s.b)(u.c):Object(s.b)(u.f):1==r?n?Object(s.b)(u.b):Object(s.b)(u.e):n?Object(s.c)(Object(s.b)(u.a),r):Object(s.c)(Object(s.b)(u.d),r)}var d=r(1183);function f(e,t){return a.nudgedRows.some((function(r){return r.rowKey===e&&r.tableViewId===t||"testNudgeRowKey"==e}))}var b=r(4303);function O(e,t,r){return!!f(e,t)&&(!!Object(b.c)(t)&&!Object(d.w)(r))}function v(e){var t=a.nudgedRows.filter((function(t){return t.conversationId===e}));return t.length>0&&j(t[0])?t[0].rowKey:null}function w(e){var t=a.nudgedRows.filter((function(t){return t.itemId===e}));return t.length>0&&j(t[0])?t[0].rowKey:null}function j(e){var t=e.tableViewId,r=Object(d.K)().tableViews.get(t);if(!r||r.id!=Object(d.I)())return!1;var n=e.rowKey;return O(n,t,d.b.getLastDeliveryOrRenewTimeStamp(n,r))}function p(e){var t=a.nudgedRows.filter((function(t){return t.rowKey===e}));return t.length>0?t[0].itemId:null}r.d(t,"c",(function(){return l})),r.d(t,"e",(function(){return w})),r.d(t,"d",(function(){return v})),r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return O})),r.d(t,"g",(function(){return f})),r.d(t,"f",(function(){return c})),r.d(t,"h",(function(){return i})),r.d(t,"i",(function(){return o}))},3027:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(0),o=r(5111),i=r(2903),c=r(2086),a=r(84);function u(e){if(!Object(c.b)())return null;switch(e){case 1:return Object(a.i)("tri-inboxPlusEasyOnFocusedInclusion")?[]:s();case 5:return s();default:return[]}}function s(){var e,t,r=[],c=i.a.inboxPlusPivots;try{for(var a=Object(n.__values)(c),u=a.next();!u.done;u=a.next()){var s=u.value;0!=s.InboxClassificationFilter&&1!=s.InboxClassificationFilter&&5!=s.InboxClassificationFilter&&s.isEnabled&&r.push(Object(o.a)(s.InboxClassificationFilter))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r}},3181:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(98);function o(e){return!!(e&Object(n.h)().ViewStateConfiguration.FocusedInboxBitFlags)}function i(e,t){o(t)!==e&&Object(n.y)((function(r){e?r.ViewStateConfiguration.FocusedInboxBitFlags|=t:r.ViewStateConfiguration.FocusedInboxBitFlags&=~t}))}},3765:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2045),o=r(1183),i=r(1207),c=r(2023);function a(e){var t,r=e.sortBy;switch(e.sortBy.sortColumn){case 1:Object(n.l)(e)&&(t="ConversationLastDeliveryOrRenewTime");break;case 3:t="ConversationUniqueSenders";break;case 7:t="ConversationSize";break;case 8:t="ConversationTopic";break;case 5:t="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+r.sortColumn)}var a=[];t&&a.push(Object(c.a)({Order:r.sortDirection,Path:Object(i.a)({FieldURI:t})}));var u=1==e.sortBy.sortColumn?e.sortBy.sortDirection:o.c.DESCENDING_SORT_DIR;return a.push(Object(c.a)({Order:u,Path:Object(i.a)({FieldURI:"ConversationLastDeliveryTime"})})),a}},3766:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2086);function o(e){if(!Object(n.b)())return null;switch(e){case 4:return["#NewslettersPlus"];case 2:return["#Promotions"];case 3:return["#Social"];default:return[]}}},4303:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return f})),r.d(t,"a",(function(){return b}));var n=r(84),o=r(2902),i=r(1190),c=r(1183),a=r(3181),u=r(324);function s(){var e=Object(u.a)(),t=e&&Object(n.i)("tri-nudge-consumer");return(!e&&Object(n.i)("tri-nudge")||t)&&!Object(a.a)(16)}function l(e){return e===Object(i.a)("inbox")||e===Object(i.a)("sentitems")}function d(e,t){if(0!=e.tableQuery.type)return!1;if("All"!=Object(c.P)(e))return!1;var r=Object(c.l)(e);if(0!=r&&-1!=r)return!1;var n=Object(c.u)(e.id);if(0!=n&&1!=n)return!1;var i=Object(c.J)(e);return 1==i.sortColumn&&i.sortDirection==o.DESCENDING_SORT_DIR}function f(e){var t=c.Y.tableViews.get(e),r=t.tableQuery.folderId;return!!l(r)&&d(t)}function b(e){return!!l(e)&&d(Object(c.H)())}},4311:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2045),o=r(1183),i=r(417),c=r(1207),a=r(2023),u=r(1190);function s(e){var t,r,s=e.sortBy;switch(s.sortColumn){case 1:Object(n.l)(e)?t="ReceivedOrRenewTime":Object(u.a)("drafts")==e.folderId&&(t="ItemLastModifiedTime");break;case 3:r=!0,t=Object(i.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+s.sortColumn)}var l=[];if(t){var d=t;r||(d=Object(c.a)({FieldURI:t})),l.push(Object(a.a)({Order:s.sortDirection,Path:d}))}var f=1==e.sortBy.sortColumn?e.sortBy.sortDirection:o.c.DESCENDING_SORT_DIR;return l.push(Object(a.a)({Order:f,Path:Object(c.a)({FieldURI:"DateTimeReceived"})})),l}},4660:function(e){e.exports=JSON.parse('{"c":"_ca","b":"$ca","a":"ada","f":"bda","e":"cda","d":"dda"}')},5060:function(e,t,r){"use strict";var n=r(532),o=r(3765),i=r(2297),c=r(4311),a=r(275),u=r(2274),s=r(1183),l=r(1402),d=r(1900),f=r(269),b=r(2045),O=Object(a.action)("onReloadTableSucceeded")((function(e,t,r){Object(b.h)(t,e,r,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),v=Object(a.action)("onReloadTableFailed")((function(e){Object(f.p)("TnS_ReloadError",[e])})),w=r(3766),j=r(3027),p=r(84),y=r(5600);t.a=Object(a.action)("reloadMailListTableAction")((function(e){if(1!==e.tableQuery.type&&!Object(s.U)(e.tableQuery.folderId)){var t=Math.max(e.currentLoadedIndex,d.a);switch(e.tableQuery.listViewType){case 0:Object(p.i)("mon-conv-useGqlForFindConv")?function(e,t){var r,n=e.tableQuery,o=Object(s.j)(e,!0),i=null===(r=o)||void 0===r?void 0:r.Id;Object(u.f)(n.folderId,t,n.viewFilter,n.sortBy,Object(b.l)(n),n.focusedViewFilter,n.requestShapeName,Object(l.e)(n),void 0,n.categoryName,i).then((function(t){var r=[];t.edges&&(r=t.edges.map((function(e){return e.node}))),O(e,r,t.totalConversationRowsInView)})).catch((function(e){var t=Object(y.a)(e);v(t)}))}(e,t):function(e,t){var r=e.tableQuery;Object(u.c)(Object(s.i)(r),0,t,r.viewFilter,Object(o.a)(r),r.focusedViewFilter,r.requestShapeName,r.shouldTryToUseSessionDataResponse,Object(l.d)(r).requestOptions,r.categoryName,Object(w.a)(r.inboxClassificationFilter),Object(j.a)(r.inboxClassificationFilter),Object(s.j)(e,!0)).then((function(t){var r=t.findConversationResponseMessage;"Success"==r.ResponseClass?O(e,r.Conversations,r.TotalConversationsInView):v(r.ResponseCode)})).catch((function(e){v()}))}(e,t);break;case 1:!function(e,t){var r=e.tableQuery;Object(u.e)(Object(s.i)(r),0,t,r.viewFilter,Object(c.a)(r),r.focusedViewFilter,r.requestShapeName,r.shouldTryToUseSessionDataResponse,Object(l.f)(r,!0),r.categoryName,Object(w.a)(r.inboxClassificationFilter),Object(j.a)(r.inboxClassificationFilter),e.serverFolderId&&e.serverFolderId!=r.folderId?Object(n.a)({Id:e.serverFolderId}):null).then((function(t){"Success"==t.ResponseClass?O(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):v(t.ResponseCode)})).catch((function(e){v()}))}(e,t)}0==e.tableQuery.type&&Object(i.a)(e.tableQuery.folderId),Object(f.p)("ReloadTable",[t],{sessionSampleRate:10})}}))},5111:function(e,t,r){"use strict";function n(e){switch(e){case 0:case 1:case 5:return"";case 2:return"#Promotions";case 3:return"#Social";case 4:return"#NewslettersPlus";default:throw new Error("No hashtag for given inbox classification filter"+e)}}r.d(t,"a",(function(){return n}))},5600:function(e,t,r){"use strict";function n(e){e.graphQLErrors&&e.graphQLErrors.forEach((function(e){var t;if(null===(t=e.extensions)||void 0===t?void 0:t.responseCode)return e.extensions.responseCode}))}r.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=owa.66.js.map
self.scriptsLoaded['owa.66.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.66.js'] = (new Date()).getTime();