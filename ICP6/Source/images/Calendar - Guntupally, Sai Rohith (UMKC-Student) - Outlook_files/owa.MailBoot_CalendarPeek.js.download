self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarPeek.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[458],{1207:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"PropertyUri:#Exchange"},e)}},1558:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=0;function i(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),{editorId:(r++).toString(),content:e,isDirty:t,textDirection:null,keyStrokeCount:0,selectedImage:null}}},1584:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"BodyContentType:#Exchange"},e)}},1606:function(e){e.exports=JSON.parse('{"a":"aya"}')},1666:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(2),o=n(1),c=n.n(o),a=n(486);function u(e){var t=c.a.useRef(e);return{getClass:c.a.useCallback((function(e){var n=t.current,r=n.base,o=void 0===r?{}:r,c=n.desktop,u=void 0===c?{}:c,s=n.mac,d=void 0===s?{}:s;switch(Object(i.u)()){case i.d:return a(o[e],null==u?void 0:u[e]);case i.b:return a(o[e],null==d?void 0:d[e]);default:return o[e]}}),[]),getStyle:c.a.useCallback((function(e){var n=t.current,o=n.base,c=void 0===o?{}:o,a=n.desktop,u=void 0===a?{}:a,s=n.mac,d=void 0===s?{}:s;switch(Object(i.u)()){case i.d:return Object(r.__assign)(Object(r.__assign)({},c[e]),u[e]);case i.b:return Object(r.__assign)(Object(r.__assign)({},c[e]),d[e]);default:return c[e]}}),[])}}},1771:function(e,t,n){"use strict";var r=n(3),i=n(61),o=Object(r.action)("toggleShowDeclinedEventsMode",(function(e,t){return Object(i.c)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:t,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:t})})),c=o,a=n(357);Object(r.orchestrator)(o,(function(e){var t=e.isDeclinedEventsMode;Object(a.a)((function(e){e.ViewStateConfiguration.CalendarViewShowDeclinedMeetings=t}),[{key:"CalendarViewShowDeclinedMeetings",valuetype:"Boolean",value:[""+t]}],"OWA.ViewStateConfiguration")}));var u=n(98),s=n(84);function d(){return!!Object(s.i)("cal-surface-declinedMeetings")&&Object(u.h)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c}))},1944:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return s}));var r=n(69),i=n(2605);n.d(t,"b",(function(){return i.a}));var o=n(2459);n.d(t,"d",(function(){return o.a}));var c=n(2518);n.d(t,"c",(function(){return c.a}));var a=new r.c((function(){return Promise.all([n.e(1),n.e(11),n.e(14),n.e(15),n.e(13),n.e(18),n.e(49),n.e(57),n.e(64),n.e(82),n.e(111),n.e(137),n.e(457)]).then(n.bind(null,5461))})),u=Object(r.d)(a,(function(e){return e.NotesEditor})),s=new r.a(a,(function(e){return e.openNotesEditor}))},2097:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return u}));var r=n(69),i=new r.c((function(){return Promise.all([n.e(1),n.e(11),n.e(15),n.e(26),n.e(54),n.e(452)]).then(n.bind(null,5480))})),o=Object(r.d)(i,(function(e){return e.CalendarItemContextMenu})),c=new r.b(i,(function(e){return e.initializeLivePersonaCard})),a=new r.b(i,(function(e){return e.personaControlStore})),u=new r.a(i,(function(e){return e.initializeLivePersonaCardForBirthdayEvent}))},2142:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u}));var r=n(1229),i=Object(r.f)(),o=Object(r.p)(i.getLockId()),c=i.fetchFullCalendarEvent,a=i.fetchFullCalendarEventAndUpdateItemResponseShapeType,u=o.getFullCalendarEvent},2238:function(e){e.exports=JSON.parse('{"a":"oxa"}')},2459:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2606);function i(e){return Object(r.a)().meetingIdToNotesViewStateMap.get(e.Id)}},2514:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"DeleteCalendarEventRequest:#Exchange"},e)}},2518:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),i=Object(r.action)("forwardEvent",(function(e,t,n,r,i){return{calendarEventId:e,notes:t,eventScope:r,actionSource:n,forwardees:i}}))},2588:function(e,t,n){"use strict";var r=n(31),i=n(0);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.__assign)({__type:"DeleteCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("DeleteCalendarEvent",e,t)}n.d(t,"a",(function(){return o}))},2605:function(e,t,n){"use strict";var r=n(2606),i=n(275);t.a=Object(i.action)("closeNotesEditor")((function(e){Object(r.a)().meetingIdToNotesViewStateMap.delete(e.Id)}))},2606:function(e,t,n){"use strict";var r=n(18),i=n(3),o=Object(i.createStore)("calendarNotesEditorStore",{meetingIdToNotesViewStateMap:new r.ObservableMap});t.a=o},3612:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return d}));var r=n(69),i=new r.c((function(){return Promise.all([n.e(1),n.e(7),n.e(8),n.e(170),n.e(603)]).then(n.bind(null,7255))})),o=Object(r.d)(i,(function(e){return e.MobilityInlineLocationRow})),c=Object(r.d)(i,(function(e){return e.MobilityPrepMessageRow})),a=Object(r.d)(i,(function(e){return e.MobilityTripOriginRow})),u=new r.a(i,(function(e){return e.fetchTravelBookendDetails})),s=new r.a(i,(function(e){return e.resetTravelBookendDetails})),d=new r.b(i,(function(e){return e.hasTravelBookendData}))},603:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},725:function(e,t,n){"use strict";var r=n(0),i=n(275),o=n(52),c=function(){function e(e){this.maxSize=e,this.references=[],this.mruList=[]}return e.prototype.initialize=function(e,t){var n,i;if(this.store){var c=new Error("MruCache cannot be initialized twice.");c.diagnosticInfo=this.firstCs,o.d(c)}else{this.store=e,this.deleteCallback=t;try{for(var a=Object(r.__values)(e.keys()),u=a.next();!u.done;u=a.next()){var s=u.value;this.mruList.push(s)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.firstCs=(new Error).stack}},e.prototype.add=function(e,t){var n=this;Object(i.action)("MruCache_add")((function(){n.store.set(e,t),n.mruList.indexOf(e)>=0?n.touch(e):(n.mruList.push(e),n.purgeIfNecessary())}))()},e.prototype.get=function(e){return this.store.get(e)},e.prototype.getAndTouch=function(e){var t=this.store.get(e);return t&&this.touch(e),t},e.prototype.has=function(e){return this.store.has(e)},e.prototype.remove=function(e){var t=this;Object(i.action)("MruCache_remove")((function(){if(t.store.has(e)&&!t.isReferenced(e))return t.removeItemAtIndex(t.mruList.indexOf(e))}))()},e.prototype.registerReference=function(e){this.references.push(e)},e.prototype.clear=function(){var e=this;Object(i.action)("MruCache_clear")((function(){e.purgeTillSize(0)}))()},e.prototype.getItemIds=function(){return new(Array.bind.apply(Array,Object(r.__spread)([void 0],this.mruList)))},e.prototype.touch=function(e){var t=this.mruList.indexOf(e);if(t<0)throw new Error("Item with key '"+e+"' does not exist in the cache.");this.mruList.splice(t,1),this.mruList.push(e)},e.prototype.purgeIfNecessary=function(){this.purgeTillSize(this.maxSize)},e.prototype.purgeTillSize=function(e){for(var t=0;this.mruList.length>e&&t<this.mruList.length;){var n=this.mruList[t];this.isReferenced(n)?t++:this.removeItemAtIndex(t)}},e.prototype.removeItemAtIndex=function(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);var t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)},e.prototype.isReferenced=function(e){for(var t=0;t<this.references.length;t++){var n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1},e}();n.d(t,"a",(function(){return c}))},7258:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1306),o=n(2142),c=n(1192),a=n(2053),u=n(269),s=n(2097),d=n(3),f=n(61),l=Object(d.action)("openItemPeek",(function(e){return Object(f.c)({name:"OpenItemPeek",options:{isCore:!0}},{item:e})})),v=Object(d.action)("openItemPeekToRespond",(function(e,t,n,r,i){return Object(f.c)({name:"OpenItemPeekToRespond"},{calendarEvent:e,eventScope:t,responseType:n,titleText:r,actionSource:i})})),p=Object(d.action)("openItemPeekToCancel",(function(e,t,n,r){return Object(f.c)({name:"OpenItemPeekToCancel"},{item:e,eventScope:t,actionSource:n,titleText:r})})),b=Object(d.action)("setPeekState",(function(e){return{state:e}})),h=n(3323),m=n(3174),O=n(1944),j=n(9);function g(e){if(null==e?void 0:e.start){var t=Object(j.Pb)();return function(e,t){return Object(j.x)(e.start,t)<=0&&Object(j.x)(e.end,t)>=0}(e,t)?1:Object(j.Gb)(t,e.start)?2:0}return null}var I=n(2461),w=n(3612),y=n(373),_=n(98),S=n(84);function T(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,d,f,l,v,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(u.r)(),Object(i.a)(),Object(a.c)(e)?[2]:(d=Object(o.a)(e.ItemId,void 0,void 0,void 0,{fetchSource:"OpenPeek"}),f=d.event,l=d.fullEventPromise,Object(m.a)(),Object(h.a)(),b({itemId:e.ItemId.Id}),t&&O.e.importAndExecute(e.ItemId,t.eventScope,t.onSend,t.titleText,t.iconName,t.proposedTime,t.forwardees,t.showNotifyToggle,t.sendResponse,t.isCancelledEvent,t.isDeclinedSeriesInstance,t.isTxpShareEvent),Object(c.w)(e)&&s.c.importAndExecute(),n&&f&&(n.markUserPerceivedTime(!0),v=g({start:f.Start,end:f.End}),p=Object(c.x)(f),n.addCustomData({ExperienceType:f.ExperienceType,CharmId:f.CharmId,PPFViewTime:v,isMeeting:p,timeRelevance:Object(I.a)(f.Start,f.End)})),Object(S.i)("cal-mf-mobility")&&Object(_.r)()&&!Object(y.r)(f.ParentFolderId.mailboxInfo.userIdentity)&&w.d.importAndExecute(f),[4,l]);case 1:return r.sent(),[2]}}))}))}var E=n(3898);Object(d.orchestrator)(l,(function(e){var t=e.item;T(t),E.i.importAndExecute(t.ItemId.Id,2)}));var x=n(3173),C=n(2016);Object(d.orchestrator)(x.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return b(null),Object(m.a)(),[4,C.a.import()];case 1:return e.sent()("EventViewed"),Object(S.i)("cal-mf-mobility")&&w.f.importAndExecute(),[2]}}))}))}));var R=n(1386),k=n(1771),D=n(1558);Object(d.orchestrator)(v,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,c,a,u;return Object(r.__generator)(this,(function(s){return t=e.calendarEvent,n=e.eventScope,i=e.titleText,o=e.actionSource,c=e.responseType,a={Accept:"Accept",Tentative:"Help",Decline:"Cancel"},u=function(e,n,r,i,a,u){Object(R.j)(t.ItemId,t.ResponseType,c,t.FreeBusyType,e,i,o,n,r,Object(k.a)()),Object(x.a)()},T(t,Object(r.__assign)(Object(r.__assign)({},Object(D.a)("")),{onSend:u,titleText:i,eventScope:n,iconName:a[c]||"CalendarReply",sendResponse:t.IsResponseRequested,showNotifyToggle:t.IsResponseRequested,isDeclinedSeriesInstance:"Decline"===t.ResponseType&&t.IsRecurring&&3!==n})),[2]}))}))}));var P=n(3172);Object(d.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,c;return Object(r.__generator)(this,(function(a){return t=e.item,n=e.eventScope,i=e.actionSource,o=e.titleText,c=Object(r.__assign)(Object(r.__assign)({},Object(D.a)("")),{eventScope:n,titleText:o,iconName:"RemoveEvent",onSend:function(e,n){Object(R.b)(t.ItemId,i,e,n)},proposedTime:null,showNotifyToggle:!1,sendResponse:!0,forwardees:null,isCancelledEvent:!0,isDeclinedSeriesInstance:!1,isTxpShareEvent:!1}),!function(e){var t=Object(P.a)().viewState;if(null==t?void 0:t.itemId)return e===t.itemId;return!1}(t.ItemId.Id)?T(t,c):O.e.importAndExecute(t.ItemId,c.eventScope,c.onSend,c.titleText,c.iconName,c.proposedTime,c.forwardees,c.showNotifyToggle,c.sendResponse,c.isCancelledEvent,c.isDeclinedSeriesInstance,c.isTxpShareEvent),[2]}))}))})),Object(d.mutator)(b,(function(e){Object(P.a)().viewState=e.state})),n.d(t,"openItemPeek",(function(){return l})),n.d(t,"openItemPeekToRespond",(function(){return v})),n.d(t,"openItemPeekToCancel",(function(){return p}))}}]);
//# sourceMappingURL=owa.MailBoot~CalendarPeek.js.map
self.scriptsLoaded['owa.MailBoot~CalendarPeek.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarPeek.js'] = (new Date()).getTime();