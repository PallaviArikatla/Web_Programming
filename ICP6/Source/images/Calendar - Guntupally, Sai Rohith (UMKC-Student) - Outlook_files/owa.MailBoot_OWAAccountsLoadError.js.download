self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~OWAAccountsLoadError.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[613],{1115:function(e,t,n){"use strict";var o=n(439),i=n(701),r=n(13),s={root:"ms-Dialog"};n.d(t,"a",(function(){return a}));var a=Object(o.a)(i.a,(function(e){var t,n=e.className,o=e.containerClassName,i=e.dialogDefaultMinWidth,a=void 0===i?"288px":i,c=e.dialogDefaultMaxWidth,l=void 0===c?"340px":c,d=e.hidden,u=e.theme;return{root:[Object(r.getGlobalClassNames)(s,u).root,u.fonts.medium,n],main:[{width:a,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+r.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:l,minWidth:a},t)},!d&&{display:"flex"},o]}}),void 0,{scope:"Dialog"});a.displayName="Dialog"},1117:function(e,t,n){"use strict";var o=n(439),i=n(705),r=n(0),s=n(13),a={root:"ms-Link"};n.d(t,"a",(function(){return c}));var c=Object(o.a)(i.a,(function(e){var t,n,o,i,c,l,d=e.className,u=e.isButton,p=e.isDisabled,m=e.theme,b=m.semanticColors,g=b.link,h=b.linkHovered,f=b.disabledText,x=b.focusBorder,v=Object(s.getGlobalClassNames)(a,m);return{root:[v.root,m.fonts.medium,{color:g,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:"none",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+x+" inset",outline:"1px auto "+x,selectors:(n={},n[s.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[s.HighContrastSelector]={borderBottom:"none"},t)},u&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:Object(r.__assign)((o={},o[s.HighContrastSelector]={color:"LinkText"},o),Object(s.getEdgeChromiumNoHighContrastAdjustSelector)())},!u&&{selectors:(i={},i[s.HighContrastSelector]={MsHighContrastAdjust:"auto"},i)},p&&["is-disabled",{color:f,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!p&&{selectors:{"&:active, &:hover, &:active:hover":{color:h,textDecoration:"underline",selectors:(c={},c[s.HighContrastSelector]={color:"LinkText"},c)},"&:focus":{color:g,selectors:(l={},l[s.HighContrastSelector]={color:"LinkText"},l)}}},v.root,d]}}),void 0,{scope:"Link"})},11388:function(e){e.exports=JSON.parse('{"a":"VOc","e":"WOc","f":"XOc","g":"YOc","h":"ZOc","d":"_Oc","b":"$Oc","c":"aPc"}')},11389:function(e,t,n){var o=n(11390),i=n(130);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)i.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},11390:function(e,t,n){(t=e.exports=n(129)(!1)).push([e.i,"._1e5v1PmnpRL7l6n6JS4PwV{max-width:500px!important;width:430px!important}",""]),t.locals={errorModal:"_1e5v1PmnpRL7l6n6JS4PwV"}},16448:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n(47),r=n(3),s=n(373);Object(r.orchestrator)(s.c,(function(e){var t=e.accountState;u(!1,t)}));var a=n(0),c=n(1856);Object(r.orchestrator)(s.v,(function(e){var t=e.accountId,n=e.userIdentity;return Object(a.__awaiter)(void 0,void 0,void 0,(function(){return Object(a.__generator)(this,(function(e){switch(e.label){case 0:return[4,c.a.importAndExecute(t,n)];case 1:return e.sent(),[2]}}))}))}));var l={isDialogHidden:!0,failureState:s.b.Valid,hasUserRetried:!1},d=Object(r.createStore)("owaAccountsErrorDialogStore",l),u=Object(r.mutatorAction)("setErrorDialogState",(function(e,t){void 0===t&&(t=s.b.Valid);var n=d();n.isDialogHidden=e,n.failureState=t})),p=n(449),m=n(1115),b=n(488),g=n(700),h=n(11),f=n(11388),x=n(2600),v=n(269),O=n(5448),_=n(540);var j=n(11389),C=Object(i.a)((function(){var e=d(),t=e.isDialogHidden,n=e.failureState,i=n==s.b.TransientTokenError||n==s.b.UnknownTokenError,r=i&&Object(_.d)()?Object(h.b)(f.h):i&&!Object(_.d)()?Object(h.b)(f.g):Object(_.d)()?Object(h.b)(f.f):Object(h.b)(f.e);return o.createElement(m.a,{hidden:t,onDismiss:function(){l("Dismiss"),u(!0,n)},dialogContentProps:{type:b.a.normal,title:Object(h.b)(f.a),subText:r},modalProps:{isBlocking:!1},styles:{main:j.errorModal}},o.createElement(g.a,null,i&&!d().hasUserRetried&&o.createElement(p.a,{onClick:function(){l("FixTokenError"),Object(s.g)([s.b.TransientTokenError,s.b.FailedToInitializeOWAConfig]).map((function(e){return c.a.importAndExecute(e.accountId,e.userIdentity)})),u(!0,n)},text:Object(h.b)(f.d)}),o.createElement(p.a,{onClick:a,text:Object(h.b)(f.b)}),o.createElement(p.a,{onClick:a,text:Object(h.b)(f.c)})));function a(){l("OpenAddAccountsOption"),x.e.importAndExecute(x.a.Personal),x.f.importAndExecute("OWAAccountsLoadError"),Object(O.b)(Object(s.f)().map((function(e){return e.userIdentity}))),u(!0,n)}function l(e){Object(v.p)("owaAccountsLoadErrorResponse",{userResponse_1:e},{isCore:!0})}}));n.d(t,"OWAAccountsLoadError",(function(){return C}))},2482:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return u}));var o=n(69),i=n(2551);n.d(t,"g",(function(){return i.b}));var r=new o.c((function(){return n.e(995).then(n.bind(null,6582))})),s=new o.a(r,(function(e){return e.initializeTrueTimeStore})),a=new o.b(r,(function(e){return e.getMergeViewEnabledAccount})),c=new o.b(r,(function(e){return e.getStoreIsSettled})),l=new o.b(r,(function(e){return e.getStoreState})),d=new o.b(r,(function(e){return e.addMergedViewAvailabilityAccount})),u=new o.b(r,(function(e){return e.removeMergedViewAvailabilityAccount}))},2551:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var o=n(3),i=Object(o.action)("initializeTrueTimeStore"),r=Object(o.action)("updateMergedViewAvailabilityAccountCompleted",(function(e,t){return{userIdentity:e,updateSuccessful:t}}))},488:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o,i=n(299);n.d(t,"b",(function(){return i.ResponsiveMode})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(o||(o={}))},699:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(0),i=n(1),r=n(279),s=n(305),a=Object(r.a)(),c=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.a)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,o=e.theme;return this._classNames=a(n,{theme:o,className:t}),i.createElement("div",{className:this._classNames.actions},i.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return i.Children.map(this.props.children,(function(t){return t?i.createElement("span",{className:e._classNames.action},t):null}))},t}(i.Component)},700:function(e,t,n){"use strict";var o=n(439),i=n(699),r=n(13),s={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return a}));var a=Object(o.a)(i.a,(function(e){var t=e.className,n=e.theme,o=Object(r.getGlobalClassNames)(s,n);return{actions:[o.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[o.action,{margin:"0 4px"}],actionsRight:[o.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var o=n(0),i=n(1),r=n(279),s=n(284),a=n(488),c=n(923),l=n(299),d=n(703),u=Object(r.a)(),p={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},m={type:a.a.normal,className:"",topButtonsProps:[]},b=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,o=e.modalProps,i=e.dialogContentProps,r=e.subText,s=o&&o.subtitleAriaId||t;return s||(s=(i&&i.subText||r)&&n._defaultSubTextId),s},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,o=e.modalProps,i=e.dialogContentProps,r=e.title,s=o&&o.titleAriaId||t;return s||(s=(i&&i.title||r)&&n._defaultTitleTextId),s},n._id=Object(s.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,s=this.props,a=s.className,l=s.containerClassName,b=s.contentClassName,g=s.elementToFocusOnDismiss,h=s.firstFocusableSelector,f=s.forceFocusInsideTrap,x=s.styles,v=s.hidden,O=s.ignoreExternalFocusing,_=s.isBlocking,j=s.isClickableOutsideFocusTrap,C=s.isDarkOverlay,y=s.isOpen,D=s.onDismiss,T=s.onDismissed,S=s.onLayerDidMount,N=s.responsiveMode,w=s.subText,k=s.theme,E=s.title,P=s.topButtonsProps,H=s.type,A=s.minWidth,I=s.maxWidth,B=s.modalProps,M=Object(o.__assign)({},B?B.layerProps:{onLayerDidMount:S});S&&!M.onLayerDidMount&&(M.onLayerDidMount=S),B&&B.dragOptions&&!B.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",r=Object(o.__assign)(Object(o.__assign)({},B.dragOptions),{dragHandleSelector:"."+n})):r=B&&B.dragOptions;var L=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},p),{className:a,containerClassName:l,isBlocking:_,isDarkOverlay:C,onDismissed:T}),B),{layerProps:M,dragOptions:r}),W=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({className:b,subText:w,title:E,topButtonsProps:P,type:H},m),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(o.__assign)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),R=u(x,{theme:k,className:L.className,containerClassName:L.containerClassName,hidden:v,dialogDefaultMinWidth:A,dialogDefaultMaxWidth:I});return i.createElement(c.a,Object(o.__assign)({elementToFocusOnDismiss:g,firstFocusableSelector:h,forceFocusInsideTrap:f,ignoreExternalFocusing:O,isClickableOutsideFocusTrap:j,onDismissed:L.onDismissed,responsiveMode:N},L,{isDarkOverlay:L.isDarkOverlay,isBlocking:L.isBlocking,isOpen:void 0!==y?y:!v,className:R.root,containerClassName:R.main,onDismiss:D||L.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),i.createElement(d.a,Object(o.__assign)({subTextId:this._defaultSubTextId,title:W.title,subText:W.subText,showCloseButton:L.isBlocking,topButtonsProps:W.topButtonsProps,type:W.type,onDismiss:D||W.onDismiss,className:W.className},W),this.props.children))},t.defaultProps={hidden:!0},t=Object(o.__decorate)([l.withResponsiveMode],t)}(i.Component)},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var o=n(0),i=n(1),r=n(279),s=n(305),a=n(375),c=n(295),l=n(488),d=n(706),u=n(700),p=n(299),m=Object(r.a)(),b=i.createElement(u.a,null).type,g="DialogContent",h=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.a)(n),Object(a.a)(g,t,{titleId:"titleProps.id"}),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,r=t.className,s=t.closeButtonAriaLabel,a=t.onDismiss,u=t.subTextId,p=t.subText,b=t.titleProps,g=void 0===b?{}:b,h=t.titleId,f=t.title,x=t.type,v=t.styles,O=t.theme,_=t.draggableHeaderClassName,j=m(v,{theme:O,className:r,isLargeHeader:x===l.a.largeHeader,isClose:x===l.a.close,draggableHeaderClassName:_}),C=this._groupChildren();return p&&(e=i.createElement("p",{className:j.subText,id:u},p)),i.createElement("div",{className:j.content},i.createElement("div",{className:j.header},i.createElement("div",Object(o.__assign)({id:h,role:"heading","aria-level":1},g,{className:Object(c.css)(j.title,g.className)}),f),i.createElement("div",{className:j.topButton},this.props.topButtonsProps.map((function(e,t){return i.createElement(d.a,Object(o.__assign)({key:e.uniqueId||t},e))})),(x===l.a.close||n&&x!==l.a.largeHeader)&&i.createElement(d.a,{className:j.button,iconProps:{iconName:"Cancel"},ariaLabel:s,onClick:a,title:s}))),i.createElement("div",{className:j.inner},i.createElement("div",{className:j.innerContent},e,C.contents),C.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return i.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===b?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(o.__decorate)([p.withResponsiveMode],t)}(i.Component)},703:function(e,t,n){"use strict";var o=n(439),i=n(702),r=n(13),s={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"};n.d(t,"a",(function(){return a}));var a=Object(o.a)(i.a,(function(e){var t,n,o,i=e.className,a=e.theme,c=e.isLargeHeader,l=e.isClose,d=e.hidden,u=e.isMultiline,p=e.draggableHeaderClassName,m=a.palette,b=a.fonts,g=a.effects,h=a.semanticColors,f=Object(r.getGlobalClassNames)(s,a);return{content:[c&&[f.contentLgHeader,{borderTop:"4px solid "+m.themePrimary}],l&&f.close,{flexGrow:1,overflowY:"hidden"},i],subText:[f.subText,b.medium,{margin:"0 0 24px 0",color:h.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:r.FontWeights.regular}],header:[f.header,{position:"relative",width:"100%",boxSizing:"border-box"},l&&f.close,p&&[p,{cursor:"move"}]],button:[f.button,d&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:h.buttonText,fontSize:r.IconFontSizes.medium}}}],inner:[f.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+r.ScreenWidthMinSmall+"px) and (max-width: "+r.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[f.content,{position:"relative",width:"100%"}],title:[f.title,b.xLarge,{color:h.bodyText,margin:"0",minHeight:b.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+r.ScreenWidthMinSmall+"px) and (max-width: "+r.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},c&&{color:h.menuHeader},u&&{fontSize:b.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(o={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:h.buttonText},".ms-Dialog-button:hover":{color:h.buttonTextHovered,borderRadius:g.roundedCorner2}},o["@media (min-width: "+r.ScreenWidthMinSmall+"px) and (max-width: "+r.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},o)}]}}),void 0,{scope:"DialogContent"})},705:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(0),i=n(1),r=n(279),s=n(305),a=n(420),c=Object(r.a)(),l=function(e){function t(t){var n=e.call(this,t)||this;return n._link=i.createRef(),n._renderContent=function(e){void 0===e&&(e={});var t=n.props,r=t.disabled,s=t.children,a=t.className,l=t.href,d=t.theme,u=t.styles,p=c(u,{className:a,isButton:!l,isDisabled:r,theme:d}),m=n._getRootType(n.props);return i.createElement(m,Object(o.__assign)({},e,n._adjustPropsForRootType(m,n.props),{className:p.root,onClick:n._onClick,ref:n._link,"aria-disabled":r}),s)},n._onClick=function(e){var t=n.props,o=t.onClick;t.disabled?e.preventDefault():o&&o(e)},Object(s.a)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,o=t.keytipProps;return o?i.createElement(a.a,{keytipProps:o,ariaDescribedBy:this.props["aria-describedby"],disabled:n},(function(t){return e._renderContent(t)})):this._renderContent()},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._adjustPropsForRootType=function(e,t){t.children,t.as;var n=t.disabled,i=t.target,r=t.href,s=(t.theme,t.getStyles,t.styles,t.componentRef,t.keytipProps,Object(o.__rest)(t,["children","as","disabled","target","href","theme","getStyles","styles","componentRef","keytipProps"]));return"string"==typeof e?"a"===e?Object(o.__assign)({target:i,href:n?void 0:r},s):"button"===e?Object(o.__assign)({type:"button",disabled:n},s):Object(o.__assign)(Object(o.__assign)({},s),{disabled:n}):Object(o.__assign)({target:i,href:r,disabled:n},s)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(i.Component)}}]);
//# sourceMappingURL=owa.MailBoot~OWAAccountsLoadError.js.map
self.scriptsLoaded['owa.MailBoot~OWAAccountsLoadError.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~OWAAccountsLoadError.js'] = (new Date()).getTime();