self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.56.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[56],{1145:function(e,t,o){"use strict";var n,r,i,s,a=o(0),l=o(1),d=o(1138),c=o(291),u=o(72),p=o(436),h=o(352),_=o(295),g=o(57),f=o(824),b=o(825),m=o(305),v=o(329),x=o(230),C=o(459),y=o(284),O=o(62),S=o(388),I=o(446),P=o(648),k=o(1118),V=o(706),w=o(889),T=o(83),B=o(13),H=o(197),j=Object(H.c)((function(e){var t,o=e.semanticColors;return{backgroundColor:o.disabledBackground,color:o.disabledText,cursor:"default",selectors:(t={":after":{borderColor:o.disabledBackground}},t[B.HighContrastSelector]={color:"GrayText",selectors:{":after":{borderColor:"GrayText"}}},t)}})),D={selectors:(n={},n[B.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"},n)},M={selectors:(r={},r[B.HighContrastSelector]={color:"WindowText",backgroundColor:"Window",MsHighContrastAdjust:"none"},r)},F=Object(H.c)((function(e,t,o,n,r){var i,s=e.palette,a=e.semanticColors,l={textHoveredColor:a.menuItemTextHovered,textSelectedColor:s.neutralDark,textDisabledColor:a.disabledText,backgroundHoveredColor:a.menuItemBackgroundHovered,backgroundPressedColor:a.menuItemBackgroundPressed},d={root:[e.fonts.medium,{backgroundColor:n?l.backgroundHoveredColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:r?"none":"block",width:"100%",height:"auto",minHeight:36,lineHeight:"20px",padding:"0 8px",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:"transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",selectors:(i={},i[B.HighContrastSelector]={border:"none",borderColor:"Background"},i["&.ms-Checkbox"]={display:"flex",alignItems:"center"},i["&.ms-Button--command:hover:active"]={backgroundColor:l.backgroundPressedColor},i[".ms-Checkbox-label"]={width:"100%"},i)}],rootHovered:{backgroundColor:l.backgroundHoveredColor,color:l.textHoveredColor},rootFocused:{backgroundColor:l.backgroundHoveredColor},rootChecked:[{backgroundColor:"transparent",color:l.textSelectedColor,selectors:{":hover":[{backgroundColor:l.backgroundHoveredColor},D]}},Object(B.getFocusStyle)(e,{inset:-1,isFocusedOnly:!1}),D],rootDisabled:{color:l.textDisabledColor,cursor:"default"},optionText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:"0px",maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",display:"inline-block"},optionTextWrapper:{maxWidth:"100%",display:"flex",alignItems:"center"}};return Object(B.concatStyleSets)(d,t,o)})),A=Object(H.c)((function(e,t){var o,n,r=e.semanticColors,i=e.fonts,s={buttonTextColor:r.bodySubtext,buttonTextHoveredCheckedColor:r.buttonTextChecked,buttonBackgroundHoveredColor:r.listItemBackgroundHovered,buttonBackgroundCheckedColor:r.listItemBackgroundChecked,buttonBackgroundCheckedHoveredColor:r.listItemBackgroundCheckedHovered},a={selectors:(o={},o[B.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"},o)},l={root:{color:s.buttonTextColor,fontSize:i.small.fontSize,position:"absolute",top:0,height:"100%",lineHeight:30,width:32,textAlign:"center",cursor:"default",selectors:(n={},n[B.HighContrastSelector]={backgroundColor:"ButtonFace",borderColor:"ButtonText",color:"ButtonText",MsHighContrastAdjust:"none"},n)},icon:{fontSize:i.small.fontSize},rootHovered:[{backgroundColor:s.buttonBackgroundHoveredColor,color:s.buttonTextHoveredCheckedColor,cursor:"pointer"},a],rootPressed:[{backgroundColor:s.buttonBackgroundCheckedColor,color:s.buttonTextHoveredCheckedColor},a],rootChecked:[{backgroundColor:s.buttonBackgroundCheckedColor,color:s.buttonTextHoveredCheckedColor},a],rootCheckedHovered:[{backgroundColor:s.buttonBackgroundCheckedHoveredColor,color:s.buttonTextHoveredCheckedColor},a],rootDisabled:[j(e),{position:"absolute"}]};return Object(B.concatStyleSets)(l,t)})),W=Object(H.c)((function(e,t,o){var n,r,i,s,l,d,c=e.semanticColors,u=e.fonts,p=e.effects,h={textColor:c.inputText,borderColor:c.inputBorder,borderHoveredColor:c.inputBorderHovered,borderPressedColor:c.inputFocusBorderAlt,borderFocusedColor:c.inputFocusBorderAlt,backgroundColor:c.inputBackground,erroredColor:c.errorText},_={headerTextColor:c.menuHeader,dividerBorderColor:c.bodyDivider},g={selectors:(n={},n[B.HighContrastSelector]={color:"GrayText"},n)},f=[{color:c.inputPlaceholderText},g],b=[{color:c.inputTextHovered},g],m=[{color:c.disabledText},g],v={color:"HighlightText",backgroundColor:"Window",MsHighContrastAdjust:"none",selectors:{":after":{borderColor:"Highlight"}}},x=Object(B.getInputFocusStyle)(h.borderPressedColor,p.roundedCorner2,"border",0),C={container:{},label:{},labelDisabled:{},root:[e.fonts.medium,{boxShadow:"none",marginLeft:"0",paddingRight:32,paddingLeft:9,color:h.textColor,position:"relative",outline:"0",userSelect:"none",backgroundColor:h.backgroundColor,cursor:"text",display:"block",height:32,whiteSpace:"nowrap",textOverflow:"ellipsis",boxSizing:"border-box",selectors:{".ms-Label":{display:"inline-block",marginBottom:"8px"},"&.is-open":{selectors:(r={},r[B.HighContrastSelector]=v,r)},":after":{pointerEvents:"none",content:"''",position:"absolute",left:0,top:0,bottom:0,right:0,borderWidth:"1px",borderStyle:"solid",borderColor:h.borderColor,borderRadius:p.roundedCorner2}}}],rootHovered:{selectors:(i={":after":{borderColor:h.borderHoveredColor},".ms-ComboBox-Input":[{color:c.inputTextHovered},Object(B.getPlaceholderStyles)(b),M]},i[B.HighContrastSelector]={color:"HighlightText",backgroundColor:"Window",MsHighContrastAdjust:"none",selectors:{":after":{borderColor:"Highlight"}}},i)},rootPressed:[{position:"relative",selectors:(s={},s[B.HighContrastSelector]=v,s)}],rootFocused:[{selectors:(l={".ms-ComboBox-Input":[{color:c.inputTextHovered},M]},l[B.HighContrastSelector]=v,l)},x],rootDisabled:j(e),rootError:{selectors:{":after":{borderColor:h.erroredColor},":hover:after":{borderColor:c.inputBorderHovered}}},rootDisallowFreeForm:{},input:[Object(B.getPlaceholderStyles)(f),{backgroundColor:h.backgroundColor,color:h.textColor,boxSizing:"border-box",width:"100%",height:"100%",borderStyle:"none",outline:"none",font:"inherit",textOverflow:"ellipsis",padding:"0",selectors:{"::-ms-clear":{display:"none"}}},M],inputDisabled:[j(e),Object(B.getPlaceholderStyles)(m)],errorMessage:[e.fonts.small,{color:h.erroredColor,marginTop:"5px"}],callout:{boxShadow:p.elevation8},optionsContainerWrapper:{width:o},optionsContainer:{display:"block"},screenReaderText:B.hiddenContentStyle,header:[u.medium,{fontWeight:B.FontWeights.semibold,color:_.headerTextColor,backgroundColor:"none",borderStyle:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:Object(a.__assign)((d={},d[B.HighContrastSelector]={color:"GrayText"},d),Object(B.getEdgeChromiumNoHighContrastAdjustSelector)())}],divider:{height:1,backgroundColor:_.dividerBorderColor}};return Object(B.concatStyleSets)(C,t)})),R=Object(H.c)((function(e,t,o,n,r,i,s,a){return{container:Object(B.mergeStyles)("ms-ComboBox-container",t,e.container),label:Object(B.mergeStyles)(e.label,n&&e.labelDisabled),root:Object(B.mergeStyles)("ms-ComboBox",a?e.rootError:o&&"is-open",r&&"is-required",e.root,!s&&e.rootDisallowFreeForm,a&&!i?e.rootError:!n&&i&&e.rootFocused,!n&&{selectors:{":hover":a?e.rootError:!o&&!i&&e.rootHovered,":active":a?e.rootError:e.rootPressed,":focus":a?e.rootError:e.rootFocused}},n&&["is-disabled",e.rootDisabled]),input:Object(B.mergeStyles)("ms-ComboBox-Input",e.input,n&&e.inputDisabled),errorMessage:Object(B.mergeStyles)(e.errorMessage),callout:Object(B.mergeStyles)("ms-ComboBox-callout",e.callout),optionsContainerWrapper:Object(B.mergeStyles)("ms-ComboBox-optionsContainerWrapper",e.optionsContainerWrapper),optionsContainer:Object(B.mergeStyles)("ms-ComboBox-optionsContainer",e.optionsContainer),header:Object(B.mergeStyles)("ms-ComboBox-header",e.header),divider:Object(B.mergeStyles)("ms-ComboBox-divider",e.divider),screenReaderText:Object(B.mergeStyles)(e.screenReaderText)}})),L=Object(H.c)((function(e){return{optionText:Object(B.mergeStyles)("ms-ComboBox-optionText",e.optionText),root:Object(B.mergeStyles)("ms-ComboBox-option",e.root,{selectors:{":hover":e.rootHovered,":focus":e.rootFocused,":active":e.rootPressed}}),optionTextWrapper:Object(B.mergeStyles)(e.optionTextWrapper)}})),E=o(420),N=o(886),K=o(1136),z=o(1150);o.d(t,"a",(function(){return $})),function(e){e[e.backward=-1]="backward",e[e.none=0]="none",e[e.forward=1]="forward"}(i||(i={})),function(e){e[e.clearAll=-2]="clearAll",e[e.default=-1]="default"}(s||(s={}));var U=250,q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return this.props.render()},t.prototype.shouldComponentUpdate=function(e){return!Object(c.f)(Object(a.__assign)(Object(a.__assign)({},this.props),{render:void 0}),Object(a.__assign)(Object(a.__assign)({},e),{render:void 0}))},t}(l.Component),G="ComboBox",$=function(e){function t(t){var o=e.call(this,t)||this;o._root=l.createRef(),o._autofill=l.createRef(),o._comboBoxWrapper=l.createRef(),o._comboBoxMenu=l.createRef(),o._selectedElement=l.createRef(),o.focus=function(e,t){o._autofill.current&&(t?Object(u.b)(o._autofill.current):o._autofill.current.focus(),e&&o.setState({isOpen:!0})),o._hasFocus()||o.setState({focusState:"focused"})},o.dismissMenu=function(){o.state.isOpen&&o.setState({isOpen:!1})},o._onUpdateValueInAutofillWillReceiveProps=function(){var e=o._autofill.current;if(!e)return null;if(null===e.value||void 0===e.value)return null;var t=o._normalizeToString(o._currentVisibleValue);return e.value!==t?t||"":e.value},o._renderComboBoxWrapper=function(e,t,n){void 0===n&&(n={});var r=o.props,i=r.label,s=r.disabled,c=r.ariaLabel,u=r.ariaDescribedBy,h=r.required,_=r.errorMessage,g=r.allowFreeform,f=r.buttonIconProps,b=r.isButtonAriaHidden,m=void 0===b||b,v=r.title,x=r.placeholder,C=r.tabIndex,y=r.autofill,O=r.iconButtonProps,S=o.state,I=S.isOpen,P=S.suggestedDisplayValue,k=o._hasFocus()&&o.props.multiSelect&&e?e:x;return l.createElement("div",{"data-ktp-target":n["data-ktp-target"],ref:o._comboBoxWrapper,id:o._id+"wrapper",className:o._classNames.root},l.createElement(d.a,Object(a.__assign)({"data-ktp-execute-target":n["data-ktp-execute-target"],"data-is-interactable":!s,componentRef:o._autofill,id:o._id+"-input",className:o._classNames.input,type:"text",onFocus:o._onFocus,onBlur:o._onBlur,onKeyDown:o._onInputKeyDown,onKeyUp:o._onInputKeyUp,onClick:o._onAutofillClick,onTouchStart:o._onTouchStart,onInputValueChange:o._onInputChange,"aria-expanded":I,"aria-autocomplete":o._getAriaAutoCompleteValue(),role:"combobox",readOnly:s||!g,"aria-labelledby":i&&o._id+"-label","aria-label":c&&!i?c:void 0,"aria-describedby":void 0!==_?Object(p.a)(u,n["aria-describedby"],t):Object(p.a)(u,n["aria-describedby"]),"aria-activedescendant":o._getAriaActiveDescendantValue(),"aria-required":h,"aria-disabled":s,"aria-owns":I?o._id+"-list":void 0,spellCheck:!1,defaultVisibleValue:o._currentVisibleValue,suggestedDisplayValue:P,updateValueInWillReceiveProps:o._onUpdateValueInAutofillWillReceiveProps,shouldSelectFullInputValueInComponentDidUpdate:o._onShouldSelectFullInputValueInAutofillComponentDidUpdate,title:v,preventValueSelection:!o._hasFocus(),placeholder:k,tabIndex:C},y)),l.createElement(V.a,Object(a.__assign)({className:"ms-ComboBox-CaretDown-button",styles:o._getCaretButtonStyles(),role:"presentation","aria-hidden":m,"data-is-focusable":!1,tabIndex:-1,onClick:o._onComboBoxClick,onBlur:o._onBlur,iconProps:f,disabled:s,checked:I},O)))},o._onShouldSelectFullInputValueInAutofillComponentDidUpdate=function(){return o._currentVisibleValue===o.state.suggestedDisplayValue},o._getVisibleValue=function(){var e=o.props,t=e.text,n=e.allowFreeform,r=e.autoComplete,i=o.state,s=i.selectedIndices,a=i.currentPendingValueValidIndex,l=i.currentOptions,d=i.currentPendingValue,c=i.suggestedDisplayValue,u=i.isOpen,p=o._indexWithinBounds(l,a);if((!u||!p)&&t&&null==d)return t;if(o.props.multiSelect){if(o._hasFocus()){var h=-1;return"on"===r&&p&&(h=a),o._getPendingString(d,l,h)}return o._getMultiselectDisplayString(s,l,c)}h=o._getFirstSelectedIndex();return n?("on"===r&&p&&(h=a),o._getPendingString(d,l,h)):p&&"on"===r?(h=a,o._normalizeToString(d)):!o.state.isOpen&&d?o._indexWithinBounds(l,h)?d:o._normalizeToString(c):o._indexWithinBounds(l,h)?l[h].text:o._normalizeToString(c)},o._onInputChange=function(e){o.props.disabled?o._handleInputWhenDisabled(null):o.props.allowFreeform?o._processInputChangeWithFreeform(e):o._processInputChangeWithoutFreeform(e)},o._onFocus=function(){o._autofill.current&&o._autofill.current.inputElement&&o._autofill.current.inputElement.select(),o._hasFocus()||o.setState({focusState:"focusing"})},o._onResolveOptions=function(){if(o.props.onResolveOptions){var e=o.props.onResolveOptions(Object(a.__spreadArrays)(o.state.currentOptions));if(Array.isArray(e))o.setState({currentOptions:e});else if(e&&e.then){var t=o._currentPromise=e;t.then((function(e){t===o._currentPromise&&o.setState({currentOptions:e})}))}}},o._onBlur=function(e){var t=e.relatedTarget;if(null===e.relatedTarget&&(t=document.activeElement),t&&(o._root.current&&o._root.current.contains(t)||o._comboBoxMenu.current&&(o._comboBoxMenu.current.contains(t)||Object(h.a)(o._comboBoxMenu.current,(function(e){return e===t})))))return e.preventDefault(),void e.stopPropagation();o._hasFocus()&&(o.setState({focusState:"none"}),o.props.multiSelect&&!o.props.allowFreeform||o._submitPendingValue(e))},o._onRenderContainer=function(e){var t=e.onRenderList,n=e.calloutProps,r=e.dropdownWidth,i=e.dropdownMaxWidth,s=e.onRenderUpperContent,d=void 0===s?o._onRenderUpperContent:s,c=e.onRenderLowerContent,u=void 0===c?o._onRenderLowerContent:c,p=e.useComboBoxAsMenuWidth,h=e.persistMenu,g=e.shouldRestoreFocus,f=void 0===g||g,b=o.state.isOpen,m=p&&o._comboBoxWrapper.current?o._comboBoxWrapper.current.clientWidth+2:void 0;return l.createElement(P.a,Object(a.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHint:T.DirectionalHint.bottomLeftEdge,directionalHintFixed:!1},n,{onLayerMounted:o._onLayerMounted,className:Object(_.css)(o._classNames.callout,n?n.className:void 0),target:o._comboBoxWrapper.current,onDismiss:o._onDismiss,onMouseDown:o._onCalloutMouseDown,onScroll:o._onScroll,setInitialFocus:!1,calloutWidth:p&&o._comboBoxWrapper.current?m&&m:r,calloutMaxWidth:i||m,hidden:h?!b:void 0,shouldRestoreFocus:f}),d(o.props,o._onRenderUpperContent),l.createElement("div",{className:o._classNames.optionsContainerWrapper,ref:o._comboBoxMenu},t(Object(a.__assign)({},e),o._onRenderList)),u(o.props,o._onRenderLowerContent))},o._onLayerMounted=function(){o._onCalloutLayerMounted(),o.props.calloutProps&&o.props.calloutProps.onLayerMounted&&o.props.calloutProps.onLayerMounted()},o._onRenderLabel=function(e){var t=e.props,n=t.label,r=t.disabled,i=t.required;return n?l.createElement(N.a,{id:o._id+"-label",disabled:r,required:i,className:o._classNames.label},n,e.multiselectAccessibleText&&l.createElement("span",{className:o._classNames.screenReaderText},e.multiselectAccessibleText)):null},o._onRenderList=function(e){var t=e.onRenderItem,n=e.options,r=o._id;return l.createElement("div",{id:r+"-list",className:o._classNames.optionsContainer,"aria-labelledby":r+"-label",role:"listbox"},n.map((function(e){return t(e,o._onRenderItem)})))},o._onRenderItem=function(e){switch(e.itemType){case K.a.Divider:return o._renderSeparator(e);case K.a.Header:return o._renderHeader(e);default:return o._renderOption(e)}},o._onRenderLowerContent=function(){return null},o._onRenderUpperContent=function(){return null},o._renderOption=function(e){var t=o.props.onRenderOption,n=void 0===t?o._onRenderOptionContent:t,r=o._id,i=o._isOptionSelected(e.index),s=o._isOptionChecked(e.index),a=o._getCurrentOptionStyles(e),d=L(o._getCurrentOptionStyles(e)),c=o._getPreviewText(e),u=function(){return n(e,o._onRenderOptionContent)};return l.createElement(q,{key:e.key,index:e.index,disabled:e.disabled,isSelected:i,isChecked:s,text:e.text,render:function(){return o.props.multiSelect?l.createElement(k.a,{id:r+"-list"+e.index,ariaLabel:o._getPreviewText(e),key:e.key,"data-index":e.index,styles:a,className:"ms-ComboBox-option","data-is-focusable":!0,onChange:o._onItemClick(e),label:e.text,role:"option",checked:s,title:c,disabled:e.disabled,onRenderLabel:u,inputProps:{"aria-selected":i?"true":"false"}}):l.createElement(w.a,{id:r+"-list"+e.index,key:e.key,"data-index":e.index,styles:a,checked:i,className:"ms-ComboBox-option",onClick:o._onItemClick(e),onMouseEnter:o._onOptionMouseEnter.bind(o,e.index),onMouseMove:o._onOptionMouseMove.bind(o,e.index),onMouseLeave:o._onOptionMouseLeave,role:"option","aria-selected":i?"true":"false",ariaLabel:o._getPreviewText(e),disabled:e.disabled,title:c},l.createElement("span",{className:d.optionTextWrapper,ref:i?o._selectedElement:void 0},n(e,o._onRenderOptionContent)))},data:e.data})},o._onCalloutMouseDown=function(e){e.preventDefault()},o._onScroll=function(){o._isScrollIdle||void 0===o._scrollIdleTimeoutId?o._isScrollIdle=!1:(o._async.clearTimeout(o._scrollIdleTimeoutId),o._scrollIdleTimeoutId=void 0),o._scrollIdleTimeoutId=o._async.setTimeout((function(){o._isScrollIdle=!0}),U)},o._onRenderOptionContent=function(e){var t=L(o._getCurrentOptionStyles(e));return l.createElement("span",{className:t.optionText},e.text)},o._onDismiss=function(){var e=o.props.onMenuDismiss;e&&e(),o.props.persistMenu&&o._onCalloutLayerMounted(),o._setOpenStateAndFocusOnClose(!1,!1),o._resetSelectedIndex()},o._onAfterClearPendingInfo=function(){o._processingClearPendingInfo=!1},o._onInputKeyDown=function(e){var t=o.props,n=t.disabled,r=t.allowFreeform,a=t.autoComplete,l=o.state,d=l.isOpen,c=l.currentOptions,u=l.currentPendingValueValidIndexOnHover;if(o._lastKeyDownWasAltOrMeta=o._isAltOrMeta(e),n)o._handleInputWhenDisabled(e);else{var p=o._getPendingSelectedIndex(!1);switch(e.which){case g.a.enter:o._autofill.current&&o._autofill.current.inputElement&&o._autofill.current.inputElement.select(),o._submitPendingValue(e),o.props.multiSelect&&d?o.setState({currentPendingValueValidIndex:p}):(d||(!r||void 0===o.state.currentPendingValue||null===o.state.currentPendingValue||o.state.currentPendingValue.length<=0)&&o.state.currentPendingValueValidIndex<0)&&o.setState({isOpen:!d});break;case g.a.tab:return o.props.multiSelect||o._submitPendingValue(e),void(d&&o._setOpenStateAndFocusOnClose(!d,!1));case g.a.escape:if(o._resetSelectedIndex(),!d)return;o.setState({isOpen:!1});break;case g.a.up:if(u===s.clearAll&&(p=o.state.currentOptions.length),e.altKey||e.metaKey){if(d){o._setOpenStateAndFocusOnClose(!d,!0);break}return}o._setPendingInfoFromIndexAndDirection(p,i.backward);break;case g.a.down:e.altKey||e.metaKey?o._setOpenStateAndFocusOnClose(!0,!0):(u===s.clearAll&&(p=-1),o._setPendingInfoFromIndexAndDirection(p,i.forward));break;case g.a.home:case g.a.end:if(r)return;p=-1;var h=i.forward;e.which===g.a.end&&(p=c.length,h=i.backward),o._setPendingInfoFromIndexAndDirection(p,h);break;case g.a.space:if(!r&&"off"===a)break;default:if(e.which>=112&&e.which<=123)return;if(e.keyCode===g.a.alt||"Meta"===e.key)return;if(!r&&"on"===a){o._onInputChange(e.key);break}return}e.stopPropagation(),e.preventDefault()}},o._onInputKeyUp=function(e){var t=o.props,n=t.disabled,r=t.allowFreeform,i=t.autoComplete,s=o.state.isOpen,a=o._lastKeyDownWasAltOrMeta&&o._isAltOrMeta(e);o._lastKeyDownWasAltOrMeta=!1;var l=a&&!(Object(f.a)()||Object(b.a)());if(n)o._handleInputWhenDisabled(e);else switch(e.which){case g.a.space:return void(r||"off"!==i||o._setOpenStateAndFocusOnClose(!s,!!s));default:return void(l&&s?o._setOpenStateAndFocusOnClose(!s,!0):("focusing"===o.state.focusState&&o.props.openOnKeyboardFocus&&o.setState({isOpen:!0}),"focused"!==o.state.focusState&&o.setState({focusState:"focused"})))}},o._onOptionMouseLeave=function(){o._shouldIgnoreMouseEvent()||o.props.persistMenu&&!o.state.isOpen||o.setState({currentPendingValueValidIndexOnHover:s.clearAll})},o._onComboBoxClick=function(){var e=o.props.disabled,t=o.state.isOpen;e||(o._setOpenStateAndFocusOnClose(!t,!1),o.setState({focusState:"focused"}))},o._onAutofillClick=function(){var e=o.props,t=e.disabled;e.allowFreeform&&!t?o.focus(o.state.isOpen||o._processingTouch):o._onComboBoxClick()},o._onTouchStart=function(){!o._comboBoxWrapper.current||"onpointerdown"in o._comboBoxWrapper||o._handleTouchAndPointerEvent()},o._onPointerDown=function(e){"touch"===e.pointerType&&(o._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},Object(m.a)(o),o._async=new v.a(o),o._events=new x.a(o),Object(C.a)(G,t,{defaultSelectedKey:"selectedKey",text:"defaultSelectedKey",selectedKey:"value",dropdownWidth:"useComboBoxAsMenuWidth"}),o._id=t.id||Object(y.a)("ComboBox");var n=o._buildDefaultSelectedKeys(t.defaultSelectedKey,t.selectedKey);o._isScrollIdle=!0,o._processingTouch=!1,o._gotMouseMove=!1,o._processingClearPendingInfo=!1;var r=o._getSelectedIndices(t.options,n);return o.state={isOpen:!1,selectedIndices:r,focusState:"none",suggestedDisplayValue:void 0,currentOptions:o.props.options,currentPendingValueValidIndex:-1,currentPendingValue:void 0,currentPendingValueValidIndexOnHover:s.default},o}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.state,t=e.currentOptions,o=e.selectedIndices;return Object(z.a)(t,o)},enumerable:!0,configurable:!0}),t.prototype.componentDidMount=function(){this._comboBoxWrapper.current&&!this.props.disabled&&(this._events.on(this._comboBoxWrapper.current,"focus",this._onResolveOptions,!0),"onpointerdown"in this._comboBoxWrapper.current&&this._events.on(this._comboBoxWrapper.current,"pointerdown",this._onPointerDown,!0))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.selectedKey!==this.props.selectedKey||e.text!==this.props.text||e.options!==this.props.options){var t=this._buildSelectedKeys(e.selectedKey),o=this._getSelectedIndices(e.options,t);this.setState({selectedIndices:o,currentOptions:e.options}),null===e.selectedKey&&this.setState({suggestedDisplayValue:void 0})}},t.prototype.componentDidUpdate=function(e,t){var o=this,n=this.props,r=n.allowFreeform,i=n.text,s=n.onMenuOpen,a=n.onMenuDismissed,l=this.state,d=l.isOpen,c=l.selectedIndices,u=l.currentPendingValueValidIndex;!d||t.isOpen&&t.currentPendingValueValidIndex===u||this._async.setTimeout((function(){return o._scrollIntoView()}),0),this._hasFocus()&&(d||t.isOpen&&!d&&this._focusInputAfterClose&&this._autofill.current&&document.activeElement!==this._autofill.current.inputElement)&&this.focus(void 0,!0),this._focusInputAfterClose&&(t.isOpen&&!d||this._hasFocus()&&(!d&&!this.props.multiSelect&&t.selectedIndices&&c&&t.selectedIndices[0]!==c[0]||!r||i!==e.text))&&this._onFocus(),this._notifyPendingValueChanged(t),d&&!t.isOpen&&s&&s(),!d&&t.isOpen&&a&&a()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this,t=this._id+"-error",o=this.props,n=o.className,r=o.disabled,i=o.required,s=o.errorMessage,d=o.onRenderContainer,c=void 0===d?this._onRenderContainer:d,u=o.onRenderLabel,p=void 0===u?this._onRenderLabel:u,h=o.onRenderList,_=void 0===h?this._onRenderList:h,g=o.onRenderItem,f=void 0===g?this._onRenderItem:g,b=o.onRenderOption,m=void 0===b?this._onRenderOptionContent:b,v=o.allowFreeform,x=o.styles,C=o.theme,y=o.keytipProps,S=o.persistMenu,I=o.multiSelect,P=this.state,k=P.isOpen,V=P.suggestedDisplayValue;this._currentVisibleValue=this._getVisibleValue();var w=I?this._getMultiselectDisplayString(this.state.selectedIndices,this.state.currentOptions,V):void 0,T=Object(O.j)(this.props,O.h,["onChange","value"]),B=!!(s&&s.length>0);this._classNames=this.props.getClassNames?this.props.getClassNames(C,!!k,!!r,!!i,!!this._hasFocus(),!!v,!!B,n):R(W(C,x),n,!!k,!!r,!!i,!!this._hasFocus(),!!v,!!B);var H=y?l.createElement(E.a,{keytipProps:y,disabled:r},(function(o){return e._renderComboBoxWrapper(w,t,o)})):this._renderComboBoxWrapper(w,t);return l.createElement("div",Object(a.__assign)({},T,{ref:this._root,className:this._classNames.container}),p({props:this.props,multiselectAccessibleText:w},this._onRenderLabel),H,(S||k)&&c(Object(a.__assign)(Object(a.__assign)({},this.props),{onRenderList:_,onRenderItem:f,onRenderOption:m,options:this.state.currentOptions.map((function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{index:t})})),onDismiss:this._onDismiss}),this._onRenderContainer),l.createElement("div",{role:"region","aria-live":"polite","aria-atomic":"true",id:t,className:B?this._classNames.errorMessage:""},void 0!==s?s:""))},t.prototype._getPendingString=function(e,t,o){return null!=e?e:this._indexWithinBounds(t,o)?t[o].text:""},t.prototype._getMultiselectDisplayString=function(e,t,o){for(var n=[],r=0;e&&r<e.length;r++){var i=e[r];n.push(this._indexWithinBounds(t,i)?t[i].text:this._normalizeToString(o))}var s=this.props.multiSelectDelimiter,a=void 0===s?", ":s;return n.join(a)},t.prototype._indexWithinBounds=function(e,t){return!!e&&(t>=0&&t<e.length)},t.prototype._processInputChangeWithFreeform=function(e){var t=this,o=this.state.currentOptions,n=-1;if(""===e)return 1===(i=o.map((function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{index:t})})).filter((function(e){return e.itemType!==K.a.Header&&e.itemType!==K.a.Divider})).filter((function(o){return t._getPreviewText(o)===e}))).length&&(n=i[0].index),void this._setPendingInfo(e,n,e);var r=e;e=e.toLocaleLowerCase();var i,s="";if("on"===this.props.autoComplete){if((i=o.map((function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{index:t})})).filter((function(e){return e.itemType!==K.a.Header&&e.itemType!==K.a.Divider})).filter((function(o){return 0===t._getPreviewText(o).toLocaleLowerCase().indexOf(e)}))).length>0){var l=this._getPreviewText(i[0]);s=l.toLocaleLowerCase()!==e?l:"",n=i[0].index}}else 1===(i=o.map((function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{index:t})})).filter((function(e){return e.itemType!==K.a.Header&&e.itemType!==K.a.Divider})).filter((function(o){return t._getPreviewText(o).toLocaleLowerCase()===e}))).length&&(n=i[0].index);this._setPendingInfo(r,n,s)},t.prototype._processInputChangeWithoutFreeform=function(e){var t=this,o=this.state,n=o.currentPendingValue,r=o.currentPendingValueValidIndex,i=o.currentOptions;if("on"===this.props.autoComplete&&""!==e){void 0!==this._lastReadOnlyAutoCompleteChangeTimeoutId&&(this._async.clearTimeout(this._lastReadOnlyAutoCompleteChangeTimeoutId),this._lastReadOnlyAutoCompleteChangeTimeoutId=void 0,e=this._normalizeToString(n)+e);var s=e;e=e.toLocaleLowerCase();var l=i.map((function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{index:t})})).filter((function(e){return e.itemType!==K.a.Header&&e.itemType!==K.a.Divider})).filter((function(t){return 0===t.text.toLocaleLowerCase().indexOf(e)}));return l.length>0&&this._setPendingInfo(s,l[0].index,this._getPreviewText(l[0])),void(this._lastReadOnlyAutoCompleteChangeTimeoutId=this._async.setTimeout((function(){t._lastReadOnlyAutoCompleteChangeTimeoutId=void 0}),1e3))}var d=r>=0?r:this._getFirstSelectedIndex();this._setPendingInfoFromIndex(d)},t.prototype._getFirstSelectedIndex=function(){return this.state.selectedIndices&&this.state.selectedIndices.length>0?this.state.selectedIndices[0]:-1},t.prototype._getNextSelectableIndex=function(e,t){var o=this.state.currentOptions,n=e+t;if(n=Math.max(0,Math.min(o.length-1,n)),!this._indexWithinBounds(o,n))return-1;var r=o[n];if(r.itemType===K.a.Header||r.itemType===K.a.Divider||!0===r.hidden){if(t===i.none||!(n>0&&t<i.none||n>=0&&n<o.length&&t>i.none))return e;n=this._getNextSelectableIndex(n,t)}return n},t.prototype._setSelectedIndex=function(e,t,o){var n=this;void 0===o&&(o=i.none);var r=this.props,s=r.onChange,l=r.onPendingValueChanged,d=this.state.currentOptions,c=this.state.selectedIndices,u=c?c.slice():[];if(e=this._getNextSelectableIndex(e,o),this._indexWithinBounds(d,e)){if(this.props.multiSelect||u.length<1||1===u.length&&u[0]!==e){var p=Object(a.__assign)({},d[e]);if(!p||p.disabled)return;if(this.props.multiSelect?(p.selected=void 0!==p.selected?!p.selected:u.indexOf(e)<0,p.selected&&u.indexOf(e)<0?u.push(e):!p.selected&&u.indexOf(e)>=0&&(u=u.filter((function(t){return t!==e})))):u[0]=e,t.persist(),this.props.selectedKey||null===this.props.selectedKey)this._hasPendingValue&&l&&(l(),this._hasPendingValue=!1),s&&s(t,p,e,void 0);else{var h=d.slice();h[e]=p,this.setState({selectedIndices:u,currentOptions:h},(function(){n._hasPendingValue&&l&&(l(),n._hasPendingValue=!1),s&&s(t,p,e,void 0)}))}}this.props.multiSelect&&this.state.isOpen||this._clearPendingInfo()}},t.prototype._submitPendingValue=function(e){var t=this.props,o=t.onChange,n=t.allowFreeform,r=t.autoComplete,i=this.state,s=i.currentPendingValue,a=i.currentPendingValueValidIndex,l=i.currentOptions,d=i.currentPendingValueValidIndexOnHover,c=this.state.selectedIndices;if(!this._processingClearPendingInfo){if(n){if(null==s)return void(d>=0&&(this._setSelectedIndex(d,e),this._clearPendingInfo()));if(this._indexWithinBounds(l,a)){var u=this._getPreviewText(l[a]).toLocaleLowerCase();if(s.toLocaleLowerCase()===u||r&&0===u.indexOf(s.toLocaleLowerCase())&&this._autofill.current&&this._autofill.current.isValueSelected&&s.length+(this._autofill.current.selectionEnd-this._autofill.current.selectionStart)===u.length||this._autofill.current&&this._autofill.current.inputElement&&this._autofill.current.inputElement.value.toLocaleLowerCase()===u){if(this._setSelectedIndex(a,e),this.props.multiSelect&&this.state.isOpen)return;return void this._clearPendingInfo()}}if(o)o&&o(e,void 0,void 0,s);else{var p={key:s||Object(y.a)(),text:this._normalizeToString(s)};this.props.multiSelect&&(p.selected=!0);var h=l.concat([p]);c&&(this.props.multiSelect||(c=[]),c.push(h.length-1)),this.setState({currentOptions:h,selectedIndices:c})}}else a>=0?this._setSelectedIndex(a,e):d>=0&&this._setSelectedIndex(d,e);this._clearPendingInfo()}},t.prototype._onCalloutLayerMounted=function(){this._gotMouseMove=!1},t.prototype._renderSeparator=function(e){var t=e.index,o=e.key;return t&&t>0?l.createElement("div",{role:"separator",key:o,className:this._classNames.divider}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,o=void 0===t?this._onRenderOptionContent:t;return l.createElement("div",{key:e.key,className:this._classNames.header},o(e,this._onRenderOptionContent))},t.prototype._isOptionSelected=function(e){return this.state.currentPendingValueValidIndexOnHover!==s.clearAll&&this._getPendingSelectedIndex(!0)===e},t.prototype._isOptionChecked=function(e){if(this.props.multiSelect&&void 0!==e&&this.state.selectedIndices){return this.state.selectedIndices.indexOf(e)>=0}return!1},t.prototype._getPendingSelectedIndex=function(e){var t=this.state,o=t.currentPendingValueValidIndexOnHover,n=t.currentPendingValueValidIndex,r=t.currentPendingValue;return o>=0?o:n>=0||e&&null!=r?n:this.props.multiSelect?0:this._getFirstSelectedIndex()},t.prototype._scrollIntoView=function(){var e=this.props,t=e.onScrollToItem,o=e.scrollSelectedToTop,n=this.state,r=n.currentPendingValueValidIndex,i=n.currentPendingValue;if(t)t(r>=0||""!==i?r:this._getFirstSelectedIndex());else if(this._selectedElement.current&&this._selectedElement.current.offsetParent)if(o)this._selectedElement.current.offsetParent.scrollIntoView(!0);else{var s=!0;if(this._comboBoxMenu.current&&this._comboBoxMenu.current.offsetParent){var a=this._comboBoxMenu.current.offsetParent.getBoundingClientRect(),l=this._selectedElement.current.offsetParent.getBoundingClientRect();if(a.top<=l.top&&a.top+a.height>=l.top+l.height)return;a.top+a.height<=l.top+l.height&&(s=!1)}this._selectedElement.current.offsetParent.scrollIntoView(s)}},t.prototype._onItemClick=function(e){var t=this,o=this.props.onItemClick,n=e.index;return function(r){o&&o(r,e,n),t._setSelectedIndex(n,r),t.props.multiSelect||(t._autofill.current&&t._autofill.current.focus(),t.setState({isOpen:!1}))}},t.prototype._getSelectedIndices=function(e,t){if(!e||!t)return[];var o={};e.forEach((function(e,t){e.selected&&(o[t]=!0)}));for(var n=function(t){var n=Object(S.e)(e,(function(e){return e.key===t}));n>-1&&(o[n]=!0)},r=0,i=t;r<i.length;r++){n(i[r])}return Object.keys(o).map(Number).sort()},t.prototype._resetSelectedIndex=function(){var e=this.state.currentOptions;this._clearPendingInfo();var t=this._getFirstSelectedIndex();t>0&&t<e.length?this.setState({suggestedDisplayValue:e[t].text}):this.props.text&&this.setState({suggestedDisplayValue:this.props.text})},t.prototype._clearPendingInfo=function(){this._processingClearPendingInfo=!0,this.setState({currentPendingValue:void 0,currentPendingValueValidIndex:-1,suggestedDisplayValue:void 0,currentPendingValueValidIndexOnHover:s.default},this._onAfterClearPendingInfo)},t.prototype._setPendingInfo=function(e,t,o){void 0===t&&(t=-1),this._processingClearPendingInfo||this.setState({currentPendingValue:this._normalizeToString(e),currentPendingValueValidIndex:t,suggestedDisplayValue:o,currentPendingValueValidIndexOnHover:s.default})},t.prototype._setPendingInfoFromIndex=function(e){var t=this.state.currentOptions;if(e>=0&&e<t.length){var o=t[e];this._setPendingInfo(this._getPreviewText(o),e,this._getPreviewText(o))}else this._clearPendingInfo()},t.prototype._setPendingInfoFromIndexAndDirection=function(e,t){var o=this.state.currentOptions;t===i.forward&&e>=o.length-1?e=-1:t===i.backward&&e<=0&&(e=o.length);var n=this._getNextSelectableIndex(e,t);e===n?t===i.forward?e=this._getNextSelectableIndex(-1,t):t===i.backward&&(e=this._getNextSelectableIndex(o.length,t)):e=n,this._indexWithinBounds(o,e)&&this._setPendingInfoFromIndex(e)},t.prototype._notifyPendingValueChanged=function(e){var t=this.props.onPendingValueChanged;if(t){var o=this.state,n=o.currentPendingValue,r=o.currentOptions,i=o.currentPendingValueValidIndex,s=o.currentPendingValueValidIndexOnHover,a=void 0,l=void 0;s!==e.currentPendingValueValidIndexOnHover&&this._indexWithinBounds(r,s)?a=s:i!==e.currentPendingValueValidIndex&&this._indexWithinBounds(r,i)?a=i:n!==e.currentPendingValue&&(l=n),(void 0!==a||void 0!==l||this._hasPendingValue)&&(t(void 0!==a?r[a]:void 0,a,l),this._hasPendingValue=void 0!==a||void 0!==l)}},t.prototype._setOpenStateAndFocusOnClose=function(e,t){this._focusInputAfterClose=t,this.setState({isOpen:e})},t.prototype._isAltOrMeta=function(e){return e.which===g.a.alt||"Meta"===e.key},t.prototype._onOptionMouseEnter=function(e){this._shouldIgnoreMouseEvent()||this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._onOptionMouseMove=function(e){this._gotMouseMove=!0,this._isScrollIdle&&this.state.currentPendingValueValidIndexOnHover!==e&&this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._handleInputWhenDisabled=function(e){this.props.disabled&&(this.state.isOpen&&this.setState({isOpen:!1}),null!==e&&e.which!==g.a.tab&&e.which!==g.a.escape&&(e.which<112||e.which>123)&&(e.stopPropagation(),e.preventDefault()))},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0}),500)},t.prototype._getCaretButtonStyles=function(){var e=this.props.caretDownButtonStyles;return A(this.props.theme,e)},t.prototype._getCurrentOptionStyles=function(e){var t=this.props.comboBoxOptionStyles,o=e.styles;return F(this.props.theme,t,o,this._isPendingOption(e),e.hidden)},t.prototype._getAriaActiveDescendantValue=function(){var e=this.state.isOpen&&this.state.selectedIndices&&this.state.selectedIndices.length>0?this._id+"-list"+this.state.selectedIndices[0]:void 0;return this.state.isOpen&&this._hasFocus()&&-1!==this.state.currentPendingValueValidIndex&&(e=this._id+"-list"+this.state.currentPendingValueValidIndex),e},t.prototype._getAriaAutoCompleteValue=function(){return!this.props.disabled&&"on"===this.props.autoComplete?this.props.allowFreeform?"inline":"both":"none"},t.prototype._isPendingOption=function(e){return e&&e.index===this.state.currentPendingValueValidIndex},t.prototype._buildDefaultSelectedKeys=function(e,t){var o=this._buildSelectedKeys(e);return o.length?o:this._buildSelectedKeys(t)},t.prototype._buildSelectedKeys=function(e){return void 0===e?[]:e instanceof Array?e:[e]},t.prototype._getPreviewText=function(e){return e.useAriaLabelAsText&&e.ariaLabel?e.ariaLabel:e.text},t.prototype._normalizeToString=function(e){return e||""},t.prototype._hasFocus=function(){return"none"!==this.state.focusState},t.defaultProps={options:[],allowFreeform:!1,autoComplete:"on",buttonIconProps:{iconName:"ChevronDown"}},t=Object(a.__decorate)([Object(I.a)("ComboBox",["theme","styles"],!0)],t)}(l.Component)}}]);
//# sourceMappingURL=owa.56.js.map
self.scriptsLoaded['owa.56.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.56.js'] = (new Date()).getTime();