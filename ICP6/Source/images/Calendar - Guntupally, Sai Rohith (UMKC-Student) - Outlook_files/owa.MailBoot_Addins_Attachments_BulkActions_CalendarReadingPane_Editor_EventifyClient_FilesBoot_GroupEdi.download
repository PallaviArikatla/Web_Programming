self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~Addins~Attachments~BulkActions~CalendarReadingPane~Editor~EventifyClient~FilesBoot~GroupEdi~e59cda82.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[25],{1185:function(e,r,n){"use strict";var t=n(69),o=n(1470),i=n(3),d=n(3760),u=n(1698),a=(Object(i.mutator)(d.a,(function(e){var r=e.folderTreeId,n=e.userIdentity,t=e.loadingState;Object(u.a)(n).get(r).loadingState=t})),n(0)),l=Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(function(e,r){return{existingFolders:e,personaOrPdlFavorites:r}})),c=n(1585),f=n(2048),s=(Object(i.mutator)(l,(function(e){e.existingFolders.forEach((function(r){if(r){var n=r.FolderId.Id,t=e.personaOrPdlFavorites.filter((function(e){return e.searchFolderId===n}));if(1===t.length){var o=t[0].displayName,i=Object(a.__assign)(Object(a.__assign)({},Object(f.c)(r)),{DisplayName:o});Object(c.a)().set(r.FolderId.Id,i)}}}))})),n(1679)),b=n(275);function v(e,r){r.forEach((function(r){e.folderTable.delete(r)}))}var I=Object(b.action)("removeFolderFromParentFolder")((function(e,r){if(r.ParentFolderId){var n=e.folderTable.get(r.ParentFolderId.Id).childFolderIds;n.splice(n.indexOf(r.FolderId.Id),1)}}));function O(e,r,n){for(var t=r.folderTable.get(n).childFolderIds,o=!1,i=Z(e).toLowerCase(),d=0;d<t.length&&!o;d++){Z(r.folderTable.get(t[d])).toLowerCase()>i&&(t.splice(d,0,e.FolderId.Id),o=!0)}o||t.push(e.FolderId.Id)}var F=Object(b.action)("moveFolderToParentFolder")((function(e,r,n){O(r,e,n),r.ParentFolderId={Id:n,__typename:"FolderId"},r.treeType=Object(s.c)(n,e)})),h=n(4294),g=n(1909);Object(i.mutator)(g.a,(function(e){!function(e,r,n,t){var o=Object(h.a)(n),i=Object(c.a)().get(n);if(!i)return;var d=i.treeType,u=Object(a.__assign)(Object(a.__assign)({},Object(f.c)(r)),{DisplayName:t,ParentFolderId:o,FolderClass:"IPF.Note",childFolderIds:[],treeType:d});e.folderTable.set(r.FolderId.Id,u),O(u,e,o.Id)}(e.folderStore,e.folder,e.parentFolderId,e.displayName)}));var p=n(18),j=Object(i.mutatorAction)("addFoldersToFolderTableMutator",(function(e){0==Object(c.a)().size?Object(o.a)().folderTable=new p.ObservableMap(e):Object.keys(e).forEach((function(r){Object(c.a)().set(r,e[r])}))})),m=n(1193),T=n(98),E=Object(i.action)("REMOVE_FOLDERTREE_DATA",(function(e,r){return{folderTreeId:e,userIdentity:r}})),y=n(2613),S=Object(i.mutatorAction)("setFolderTreeData",(function(e,r,n,t,o,i){void 0===t&&(t=!1),void 0===o&&(o=0);var d={id:e,rootFolder:r,loadingState:n,hasMoreData:t,currentLoadedIndex:o};Object(u.a)(i).set(e,d)}));function _(e,r,n){return Object(c.a)().has(e.FolderId.Id)?Object(c.a)().get(e.FolderId.Id):Object(a.__assign)({childFolderIds:[],treeType:r,principalSMTPAddress:n},e)}Object(i.orchestrator)(g.f,(function(){var e={DistinguishedFolderId:m.d,DisplayName:Object(T.h)().SessionSettings.ArchiveDisplayName};S(m.d,e,y.a.Uninitialized)})),Object(i.mutator)(E,(function(e){Object(u.a)(e.userIdentity).delete(e.folderTreeId)}));var D=Object(i.mutatorAction)("updateFolder",(function(e,r,n,t){r&&(e.DisplayName=r),t.forEach((function(e){var r=n[e],t=n[r.ParentFolderId.Id]||Object(c.a)().get(r.ParentFolderId.Id);t&&t.childFolderIds.push(e)}))})),P=n(3910);function R(e,r,n,t,o){for(var i={},d=i[n.FolderId.Id]=o(n),u=[],a=0;a<t.length;a++){var l=t[a],c=l.FolderId.Id,f=l.DistinguishedFolderId;Object(P.a)(f)&&(i[c]=o(l),u.push(c))}D(d,r,i,u),j(i)}var x=n(5098);Object(i.orchestrator)(x.b,(function(e){var r=e.rootFolder,n=e.folders,t=e.treeType,o=e.principalSMTPAddress;R(0,null,r,n,(function(e){return _(e,t,o)}))}));var w=n(3761),A=n(11),L=(Object(i.orchestrator)(w.a,(function(e){var r=e.displayName,n=e.folders,t=e.folderTreeIdentifier,o=e.includesLastItemInRange,i=e.indexedPagingOffset,d=e.principalSMTPAddress,u=e.rootFolder,a=e.treeType,l=e.userIdentity;if(R(0,r,u,n,(function(e){return _(e,a,d)})),S(t,Object(c.a)().get(u.FolderId.Id),y.a.Loaded,!o,i,l),a===m.i){for(var f=0;f<n.length;f++){var s=n[f],b=s.FolderId.Id,v=s.DistinguishedFolderId;Object(A.f)(v)||Object(T.a)(v,b)}Object(T.a)(u.DistinguishedFolderId,u.FolderId.Id)}})),n(1190));function M(e,r,n){var t,o=Object(L.a)(n)||n;if(t=e.folderTable.get(o))for(var i=t.childFolderIds,d=r.toLowerCase(),u=0;u<i.length;u++){var a=i[u],l=e.folderTable.get(a);if(l&&l.DisplayName.toLowerCase()==d)return!0}return!1}function N(e,r){var n=[e];return r.folderTable.get(e).childFolderIds.forEach((function(e){Array.prototype.push.apply(n,N(e,r))})),n}function C(e){var r=Object(c.a)().get(e);return!!r.childFolderIds&&r.childFolderIds.map((function(e){return!!Object(c.a)().get(e)})).length>0}function U(e,r){return function e(r,n,t){var o=[];if(0===n){var i=e(r,n+1,t);o.push.apply(o,Object(a.__spread)(i))}else r.forEach((function(r){var i=Object(c.a)().get(r);if(i&&(o.push(Object(a.__assign)(Object(a.__assign)({},i),{depth:n})),C(r)&&t(r))){var d=e(i.childFolderIds,n+1,t);o.push.apply(o,Object(a.__spread)(d))}}));return o}(e,0,r)}var k,H={folderTable:new p.ObservableMap,mailboxFolderTreeData:new p.ObservableMap};var V=function(e,r){H.folderTable.set(e.FolderId.Id,e),e.ParentFolderId&&H.folderTable.get(e.ParentFolderId.Id).childFolderIds.push(e.FolderId.Id),e.DistinguishedFolderId&&(k[e.DistinguishedFolderId]=e.FolderId.Id)};V=Object(b.action)("addFolderToStore-TestMethod")(V);var G=Object(i.action)("INITIALIZE_SHARED_FOLDERS"),z=n(2101),B=n(2100),W=n(4295);function q(e){var r=Object(u.a)(),n=r&&r.get(e);return null==n?void 0:n.hasMoreData}var K=n(4653),X=n(2102),Y=n(29);function Z(e){return e?Object(Y.a)().SessionSettings.IsShadowMailbox&&e.remoteFolderDisplayName?e.remoteFolderDisplayName:e.DisplayName:""}var J=n(269);var Q=Object(i.mutatorAction)("setMailboxFolderTreeData",(function(e,r){Object(o.a)().mailboxFolderTreeData.set(e,r)})),$=new t.b(new t.c((function(){return n.e(222).then(n.bind(null,16342))})),(function(e){return e.fetchPrimaryMailFolders})),ee=n(84),re=n(2855);function ne(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,n,t;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:if(r=Object(T.b)(),Object(u.b)(r)||Q(r,function(){var e;return{folderTreeTable:new p.ObservableMap((e={},e[m.j]={id:m.j,rootFolder:{DistinguishedFolderId:m.j,DisplayName:m.j},loadingState:y.a.Uninitialized},e)),sharedFolderUserEmails:[]}}()),(n=Object(W.a)(m.j,r))==y.a.Loading||n==y.a.Loaded&&!e)return[2];Object(d.a)(m.j,y.a.Loading,r),t=!Object(ee.i)("tri-disableSDFolders")&&Object(re.f)(),o.label=1;case 1:return o.trys.push([1,5,,6]),t?[3,4]:[4,$.import()];case 2:return[4,o.sent()(r,r)];case 3:t=o.sent(),o.label=4;case 4:return[3,6];case 5:return o.sent(),Object(d.a)(m.j,y.a.ErrorLoading,r),[2];case 6:return t?(Object(w.a)(t.RootFolder,t.Folders,m.j,m.i,r,Object(Y.a)().SessionSettings.UserDisplayName,m.j,r,t.IncludesLastItemInRange,t.IndexedPagingOffset),function(){var e,r,n=null===(e=Object(c.a)().get(Object(L.a)("inbox")))||void 0===e?void 0:e.childFolderIds.length,t=null===(r=Object(c.a)().get(Object(L.a)("msgfolderroot")))||void 0===r?void 0:r.TotalCount;Object(J.p)("TnS_LoadFolders",[n,t])}(),[2]):(Object(d.a)(m.j,y.a.ErrorLoading,r),[2])}}))}))}var te=n(3762),oe=Object(b.select)({folderTable:function(){return o.b.folderTable}})((function(e,r){return Object(te.c)(e,"msgfolderroot",r)}));function ie(e){return Object(te.a)(o.b.folderTable.get(e),"msgfolderroot")}var de=n(3294),ue=n(4654);n.d(r,"K",(function(){return le})),n.d(r,"L",(function(){return ce})),n.d(r,"O",(function(){return fe})),n.d(r,"P",(function(){return se})),n.d(r,"I",(function(){return be})),n.d(r,"M",(function(){return ve})),n.d(r,"N",(function(){return Ie})),n.d(r,"J",(function(){return Oe})),n.d(r,"y",(function(){return o.a})),n.d(r,"b",(function(){return j})),n.d(r,"f",(function(){return M})),n.d(r,"g",(function(){return N})),n.d(r,"j",(function(){return U})),n.d(r,"z",(function(){return C})),n.d(r,"a",(function(){return y.a})),n.d(r,"r",(function(){return h.a})),n.d(r,"T",(function(){return l})),n.d(r,"e",(function(){return v})),n.d(r,"U",(function(){return I})),n.d(r,"Q",(function(){return F})),n.d(r,"c",(function(){return g.a})),n.d(r,"A",(function(){return g.f})),n.d(r,"m",(function(){return g.e})),n.d(r,"l",(function(){return g.d})),n.d(r,"Z",(function(){return g.k})),n.d(r,"Y",(function(){return g.i})),n.d(r,"R",(function(){return g.g})),n.d(r,"B",(function(){return G})),n.d(r,"V",(function(){return E})),n.d(r,"S",(function(){return w.a})),n.d(r,"X",(function(){return d.a})),n.d(r,"h",(function(){return z.a})),n.d(r,"v",(function(){return B.a})),n.d(r,"n",(function(){return c.a})),n.d(r,"q",(function(){return W.a})),n.d(r,"p",(function(){return q})),n.d(r,"o",(function(){return K.a})),n.d(r,"x",(function(){return X.a})),n.d(r,"i",(function(){return Z})),n.d(r,"W",(function(){return S})),n.d(r,"w",(function(){return ne})),n.d(r,"F",(function(){return oe})),n.d(r,"E",(function(){return ie})),n.d(r,"H",(function(){return te.c})),n.d(r,"D",(function(){return te.a})),n.d(r,"k",(function(){return s.a})),n.d(r,"s",(function(){return s.b})),n.d(r,"C",(function(){return s.d})),n.d(r,"u",(function(){return de.a})),n.d(r,"G",(function(){return ue.b})),n.d(r,"t",(function(){return u.b}));r.d=o.b;var ae=new t.c((function(){return n.e(222).then(n.bind(null,16342))})),le=new t.b(ae,(function(e){return e.getArchiveFolders})),ce=new t.b(ae,(function(e){return e.getFolderPermissions})),fe=new t.b(ae,(function(e){return e.updateFolderPermissions})),se=new t.b(ae,(function(e){return e.updateFolderPermissionsInStore})),be=new t.b(ae,(function(e){return e.arePermissionArraysEqual})),ve=(new t.b(ae,(function(e){return e.arePermissionsEqual})),new t.b(ae,(function(e){return e.getSharedFolders}))),Ie=new t.a(ae,(function(e){return e.updateFolder})),Oe=new t.a(ae,(function(e){return e.createNewFolder}))},1193:function(e,r,n){"use strict";n.d(r,"f",(function(){return t})),n.d(r,"d",(function(){return o})),n.d(r,"j",(function(){return i})),n.d(r,"a",(function(){return d})),n.d(r,"g",(function(){return u})),n.d(r,"b",(function(){return a})),n.d(r,"h",(function(){return l})),n.d(r,"l",(function(){return c})),n.d(r,"k",(function(){return f})),n.d(r,"i",(function(){return s})),n.d(r,"c",(function(){return b})),n.d(r,"e",(function(){return v}));var t=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",d="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",l="recoverableitemsdeletions",c="msgfolderroot",f="sharedFolderTree",s="primaryFolderTree",b="archiveFolderTree",v="favorites"},1225:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(49);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return t.a.defaultFolderIdToNameMap.get(e)||"none"}},1470:function(e,r,n){"use strict";n.d(r,"b",(function(){return d}));var t=n(3),o=n(18),i=Object(t.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),d=i();r.a=i},1585:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1470);function o(){return Object(t.a)().folderTable}},1624:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1698);function o(e,r){var n=Object(t.a)(r),o=n&&n.get(e);return null==o?void 0:o.rootFolder}},1679:function(e,r,n){"use strict";n.d(r,"a",(function(){return f})),n.d(r,"b",(function(){return s})),n.d(r,"d",(function(){return b})),n.d(r,"c",(function(){return v}));var t=n(1190),o=n(1225),i=n(1470),d=n(2100),u=n(1585),a=n(2101),l=n(2102),c=n(2061);function f(e){var r=Object(u.a)(),n=Object(t.a)(e);return r.get(n)}function s(e,r){if("sharedFolder"===e&&!r)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var n,t=[];switch(e){case"archive":n=Object(a.a)();break;case"sharedFolder":n=Object(l.a)(r);break;default:n=Object(d.a)()}var u=Object(c.a)();"primary"==e&&n.DistinguishedFolderId==Object(d.a)().DistinguishedFolderId&&n.FolderId&&u.forEach((function(e){var r=f(e);(null==r?void 0:r.ParentFolderId.Id)===n.FolderId.Id&&t.push(r.FolderId.Id)}));for(var s=function(e){var r=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var n=i.b.folderTable.get(e);r.push(n.FolderId.Id)}));return r}(n),b=0;b<s.length;b++)-1==u.indexOf(Object(o.a)(s[b]))&&t.push(s[b]);return t}function b(e,r){var n=Object(u.a)().get(e);return!(!n||n.treeType!==r)}function v(e,r){var n=null,t=r.folderTable.get(e);return t&&(n=t.treeType),n}},1698:function(e,r,n){"use strict";n.d(r,"a",(function(){return i})),n.d(r,"b",(function(){return d}));var t=n(1470),o=n(98);function i(e){return d(e).folderTreeTable}function d(e){return e||(e=Object(o.b)()),Object(t.a)().mailboxFolderTreeData.get(e)}},1803:function(e,r,n){"use strict";n.d(r,"a",(function(){return i}));var t=n(324),o=n(84);function i(){var e=Object(t.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(o.i)("notes-folder-view")&&e.push("notes"),e}},1909:function(e,r,n){"use strict";n.d(r,"b",(function(){return o})),n.d(r,"f",(function(){return i})),n.d(r,"c",(function(){return d})),n.d(r,"e",(function(){return u})),n.d(r,"d",(function(){return a})),n.d(r,"h",(function(){return l})),n.d(r,"j",(function(){return c})),n.d(r,"k",(function(){return f})),n.d(r,"i",(function(){return s})),n.d(r,"a",(function(){return b})),n.d(r,"g",(function(){return v}));var t=n(3),o=Object(t.action)("GET_ARCHIVE_FOLDERS",(function(e,r){return{source:e,isLoadingMore:r}})),i=Object(t.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),d=Object(t.action)("GET_FOLDER_PERMISSIONS",(function(e){return{folderId:e}})),u=Object(t.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),a=Object(t.action)("GET_FOLDER_PERMISSIONS_FAILED"),l=Object(t.action)("UPDATE_FOLDER_PERMISSIONS",(function(e,r,n){return{folderId:e,permissions:r,mailboxInfo:n}})),c=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(function(e,r){return{folderId:e,permissions:r}})),f=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),s=Object(t.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),b=Object(t.action)("ADD_NEW_FOLDER_TO_STORE",(function(e,r,n,t){return{folderStore:e,folder:r,parentFolderId:n,displayName:t}})),v=Object(t.action)("ON_CREATE_NEW_FOLDER_INBOX_RULES_RESPONSE",(function(e,r,n,t){return{folderStore:e,folderId:r,parentFolderId:n,displayName:t}}))},2048:function(e,r,n){"use strict";var t=function(e,r){var n,t;if(e.ExtendedProperty)for(var o=0;o<e.ExtendedProperty.length;o++){var i=e.ExtendedProperty[o];if((null===(n=null==i?void 0:i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===r||(null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyName)===r)return i.Value}},o=function(e){var r=t(e,"SourceWellKnownFolderType");return r&&parseInt(r,10)||-1},i=function(e){return t(e,"0x7018")||null},d=function(e){return"false"!==t(e,"0x10f4")},u=n(1193),a=n(52);function l(e,r,n,t,o,i){var a,l=e.RootFolder;if(!l||!l.Folders||!l.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");var f=[];null==l||l.Folders.forEach((function(e){if(e&&function(e,r,n){if(t=null==e?void 0:e.__type,"Folder:#Exchange"!=t)return!1;var t;if((null==e?void 0:e.DistinguishedFolderId)&&u.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(d(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!r;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,t,o)){var r=c(e);r&&f.push(r)}}));var s=function(e,r){return"SharedMailbox"===r?void 0:e}((null===(a=null==l?void 0:l.ParentFolder)||void 0===a?void 0:a.DistinguishedFolderId)||"none",r);l.ParentFolder.DistinguishedFolderId=s;var b=c(l.ParentFolder);return i&&function(e,r,n){if(e){var t={},o={},i=[];t[e.FolderId.Id]=e,i.push(e.FolderId.Id),r.forEach((function(e){e&&(t[e.FolderId.Id]=e,i.push(e.FolderId.Id))})),i.forEach((function(e){var r,n=t[e],i=null===(r=n.ParentFolderId)||void 0===r?void 0:r.Id;n.DistinguishedFolderId&&(o[n.DistinguishedFolderId]=e);var d=i&&t[i];d&&(d.childFolderIds||(d.childFolderIds=[]),d.childFolderIds.push(e))}));var d=[];n.forEach((function(e){var r=o[e];r&&d.push(r)}));for(var u=e.childFolderIds||[],a=0;a<u.length;a++){var l=u[a]||null;l&&-1==d.indexOf(l)&&d.push(l)}e.childFolderIds=d}}(b,f,n),{__typename:"FolderHierarchyResult",Folders:f,RootFolder:b,IndexedPagingOffset:l.IndexedPagingOffset,TotalItemsInView:l.TotalItemsInView,IncludesLastItemInRange:l.IncludesLastItemInRange}}function c(e){var r=e,n=r.FolderId,t=r.ParentFolderId,d=r.DisplayName,u=r.ArchiveTag,l=r.PolicyTag,c=r.ChildFolderCount,v=r.UnreadCount,I=r.TotalCount,O=r.FolderClass,F=r.DistinguishedFolderId;if(!n)return a.g.warn("mapOWSFolderToGql: ignoring folder with missing id"),null;var h=c||0,g=s(n);return{id:g.Id,__typename:"MailFolder",type:r.__type,FolderId:g,ParentFolderId:t&&s(t),DisplayName:d||"",DistinguishedFolderId:F||null,FolderClass:O||"IPF.Note",UnreadCount:v||0,TotalCount:I||0,ArchiveTag:u?b(u):null,PolicyTag:l?b(l):null,hasChildren:h>0,remoteFolderDisplayName:i(r),sourceWellKnownFolderType:o(r),ReplicaList:r.ReplicaList,PermissionSet:r.PermissionSet,size:f(r),childFolderIds:[]}}function f(e){var r,n;return null===(n=null===(r=e.ExtendedProperty)||void 0===r?void 0:r[0])||void 0===n?void 0:n.Value}function s(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function b(e){return{__typename:"RetentionTagType",IsExplicit:e.IsExplicit,Value:e.Value}}n.d(r,"a",(function(){return o})),n.d(r,"b",(function(){return l})),n.d(r,"c",(function(){return c}))},2061:function(e,r,n){"use strict";n.d(r,"b",(function(){return d}));var t=n(15),o=n(1803);n.d(r,"a",(function(){return o.a}));var i=new t.b((function(){return n.e(792).then(n.bind(null,3455))})),d=new t.a(i,(function(e){return e.boostrapFolderHierarchyCache}))},2100:function(e,r,n){"use strict";n.d(r,"a",(function(){return i}));var t=n(1624),o=n(1193);function i(e){return Object(t.a)(o.j,e)}},2101:function(e,r,n){"use strict";n.d(r,"a",(function(){return i}));var t=n(1624),o=n(1193);function i(e){return Object(t.a)(o.d,e)}},2102:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1624);function o(e){return Object(t.a)(e)}},2613:function(e,r,n){"use strict";var t;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(t||(t={})),r.a=t},2855:function(e,r,n){"use strict";var t,o,i,d,u,a=n(8);function l(){return d}function c(e,r){var n,a;t=u?void 0:e.findConversation,i=u?void 0:e.findMailFolderItem,d=null===(a=null===(n=e.findFolders)||void 0===n?void 0:n.Header)||void 0===a?void 0:a.ServerVersionInfo,o=r}function f(e,r){var n,o=I(t,(function(e){return e.Body}),"fcr");if(t=void 0,u=!0,o){var i=void 0;if(e!=(null===(n=o.FolderId)||void 0===n?void 0:n.Id)?i="wf":o.Conversations?"number"==typeof o.IndexedOffset&&r===o.Conversations.length-o.IndexedOffset||(i="wi"):i="ni",Object(a.b)("fcr",i||"s"),!i)return o}return null}function s(e,r,n){var t=I(i,(function(e){var r,n,t;return null===(t=null===(n=null===(r=null==e?void 0:e.Body)||void 0===r?void 0:r.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===t?void 0:t[0]}),"fir");if(i=void 0,u=!0,t){var o=void 0,d=null==t?void 0:t.RootFolder;if(e!=n?o="wf":(null==d?void 0:d.Items)?"number"==typeof d.IndexedPagingOffset&&r===d.Items.length-d.IndexedPagingOffset||(o="wi"):o="ni",Object(a.b)("fir",o||"s"),!o)return t}return null}function b(){var e=o;return o=void 0,e&&Object(a.b)("ffr","s"),e}function v(e){return I(e.findFolders,(function(e){var r,n,t;return null===(t=null===(n=null===(r=null==e?void 0:e.Body)||void 0===r?void 0:r.ResponseMessages)||void 0===n?void 0:n.Items)||void 0===t?void 0:t[0]}),"ffr")}function I(e,r,n){var t="njr";if(e){var o=r(e);if(o){if("Error"!=o.ResponseClass)return o;t="e",Object(a.b)(n+"_c",o.ResponseCode||"un")}else t="nrm"}return Object(a.b)(n,t),null}n.d(r,"b",(function(){return l})),n.d(r,"c",(function(){return c})),n.d(r,"d",(function(){return f})),n.d(r,"e",(function(){return s})),n.d(r,"f",(function(){return b})),n.d(r,"a",(function(){return v}))},3294:function(e,r,n){"use strict";var t=n(287),o=n(1585),i=n(11),d=n(4654),u=n(52);function a(e,r){if(!e||!r)return null;return i.c("{0}@{1}",e,r)}var l=n(29),c=n(324),f="X-AnchorMailbox",s="X-AuxMailbox";function b(e,r,n,t,o,i){try{var b={headers:new Headers,mailboxInfo:{userIdentity:r,type:t,mailboxSmtpAddress:n}};if(Object(c.a)())return b;var v=null,I=Object(l.a)().SessionSettings,O=I.OrganizationDomain;return"ArchiveMailbox"==t?(o||(o=I.ArchiveMailboxGuid),v=a(o,O),i&&b.headers.append(s,i)):"SharedMailbox"==t&&(v=a(function(e){try{if(!e)return null;for(var r=atob(e),n=r.length,t=new Uint8Array(new ArrayBuffer(n)),o=0;o<n;o++)t[o]=r.charCodeAt(o);return Object(d.a)(t)}catch(r){return u.d("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+r),null}}(e),O)),v&&b.headers.append(f,v),b}catch(o){return u.d(" getDefaultRequestOptions failed for folderId "+e+" with error "+o),{mailboxInfo:{userIdentity:r,type:t,mailboxSmtpAddress:n}}}}var v=n(1193);function I(e,r){var n,i,d,u,c,f=Object(o.a)(),s=null==f?void 0:f.get(e),I=Object(l.a)().SessionSettings;return(null==s?void 0:s.treeType)===v.k?(i=s.principalSMTPAddress,c="SharedMailbox"):e==v.d||e==v.b||(null==s?void 0:s.treeType)==v.c?((u=null===(n=null==s?void 0:s.ReplicaList)||void 0===n?void 0:n[0])&&r?d=u:(d=I.ArchiveMailboxGuid,u=void 0),c="ArchiveMailbox",i=a(d,I.OrganizationDomain)):(i=I.UserEmailAddress,c="UserMailbox"),{type:c,userIdentity:Object(t.d)().userIdentity,mailboxSmtpAddress:i,auxiliaryMailboxGuid:u,requestOptions:b(e,i,i,c,d,u)}}n.d(r,"a",(function(){return I}))},3760:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(3),o=Object(t.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(function(e,r,n){return{folderTreeId:e,loadingState:r,userIdentity:n}}))},3761:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(3),o=Object(t.action)("ON_QUERY_FOLDERHIERARCHY",(function(e,r,n,t,o,i,d,u,a,l){return{rootFolder:e,folders:r,distinguishedFolderId:n,treeType:t,principalSMTPAddress:o,displayName:i,folderTreeIdentifier:d,userIdentity:u,includesLastItemInRange:a,indexedPagingOffset:l}}))},3762:function(e,r,n){"use strict";n.d(r,"b",(function(){return i})),n.d(r,"c",(function(){return d}));var t=n(1470),o=n(275);function i(e){return"msgfolderroot"===e.DistinguishedFolderId}var d=Object(o.select)({folderTable:function(){return t.b.folderTable}})((function(e,r,n){var t=!!e&&e.ParentFolderId;if(!t)return!1;for(var o=n.folderTable.get(t.Id);o;){if(o.DistinguishedFolderId==r)return!0;if(!o.ParentFolderId)return!1;o=n.folderTable.get(o.ParentFolderId.Id)}return!1}));r.a=Object(o.select)({folderTable:function(){return t.b.folderTable}})((function(e,r,n){return function(e,r){return!!e&&e.DistinguishedFolderId==r}(e,r)||d(e,r,n)}))},3910:function(e,r,n){"use strict";var t=n(98),o=n(84);function i(e){var r=Object(t.h)().SegmentationSettings;return"junkemail"===e?!!(null==r?void 0:r.JunkEMail):"notes"!==e||!!(null==r?void 0:r.StickyNotes)&&Object(o.i)("cal-stickyNotesFolder")}n.d(r,"a",(function(){return i}))},4294:function(e,r,n){"use strict";n.d(r,"a",(function(){return d}));var t=n(1190),o=n(1470),i=n(532);function d(e){var r=Object(t.a)(e);return r||(r=e),Object(o.a)().folderTable.get(r)?Object(o.a)().folderTable.get(r).FolderId:Object(i.a)({Id:r,__type:"FolderId:#Exchange"})}},4295:function(e,r,n){"use strict";n.d(r,"a",(function(){return i}));var t=n(2613),o=n(1698);function i(e,r){var n=Object(o.a)(r),i=n&&n.get(e);return(null==i?void 0:i.loadingState)||t.a.Uninitialized}},4653:function(e,r,n){"use strict";n.d(r,"a",(function(){return o}));var t=n(1698);function o(e,r){var n=Object(t.a)(r),o=n&&n.get(e);return(null==o?void 0:o.currentLoadedIndex)||0}},4654:function(e,r,n){"use strict";n.d(r,"a",(function(){return o})),n.d(r,"b",(function(){return i}));var t=n(52);function o(e){if(!e)return null;var r=e,n=0;if(1==r[0]){if(!(r=d(r)))return null}else n=1;var o=r[++n]+(r[n+1]>>8);return function(e,r,n){if(r+n>e.length)return t.d("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;for(var o="",i=r;i<r+n;i++)o+=String.fromCharCode(e[i]);return o}(r,n+=2,o)}function i(e){if(!e)return!1;try{for(var r=atob(e),n=new Uint8Array(r.length),t=0;t<r.length;t++)n[t]=r.charCodeAt(t);var o=0;return 1===n[0]?n=d(n):o=1,n&&1===n[o]}catch(e){return!1}}function d(e){var r=u(e,null);if(0==r)return t.d("rleDecompress : Invalid id"),null;var n=new Uint8Array(r);return u(e,n),n}function u(e,r){for(var n=0,o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=r&&(r[n]=e[o]),n++;else{if(o==e.length-2)return t.d("decompressEx : Invalid id"),null;for(var i=e[o+2],d=0;d<i+2;d++)null!=r&&(r[n]=e[o]),n++;o+=2}return n}},5098:function(e,r,n){"use strict";n.d(r,"a",(function(){return o})),n.d(r,"c",(function(){return i})),n.d(r,"b",(function(){return d}));var t=n(3),o=Object(t.action)("FETCH_ARCHIVE_DUMPSTER_FOLDER"),i=Object(t.action)("SET_REPLICA_LIST",(function(e,r){return{folderId:e,replicaList:r}})),d=Object(t.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(function(e,r,n,t){return{rootFolder:e,folders:r,treeType:n,principalSMTPAddress:t}}))}}]);
//# sourceMappingURL=owa.MailBoot~Addins~Attachments~BulkActions~CalendarReadingPane~Editor~EventifyClient~FilesBoot~GroupEdi~e59cda82.js.map
self.scriptsLoaded['owa.MailBoot~Addins~Attachments~BulkActions~CalendarReadingPane~Editor~EventifyClient~FilesBoot~GroupEdi~e59cda82.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~Addins~Attachments~BulkActions~CalendarReadingPane~Editor~EventifyClient~FilesBoot~GroupEdi~e59cda82.js'] = (new Date()).getTime();